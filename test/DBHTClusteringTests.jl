using CSV, LinearAlgebra, PortfolioOptimiser, Test, TimeSeries

prices = TimeArray(CSV.File("./assets/stock_prices.csv"); timestamp = :date)

@testset "DBHT Clustering tests" begin
    D = reshape([0.0, 1.7425505199001374, 3.0376559406319203, 0.992560094200736,
                 0.04111684121517171, 1.2061606966895686, 0.8396443902399026,
                 3.721837823291286e-5, 0.7179752092024985, 0.3234765497958904,
                 0.002113633424401835, 0.598481163610057, 1.3158508361920667,
                 0.13992486176965543, 0.13817323337873397, 3.4945960887092404,
                 7.4381337920809765, 0.47092642183660893, 0.6770365027776871,
                 0.04518444638740131, 0.18794945980807312, 0.4368435026399025,
                 0.018615768685222717, 0.8463559700818, 2.996771130837551,
                 2.8131131409592744, 0.21014077875231008, 0.04997330964659953,
                 0.010341717030879462, 0.26216401826629726, 1.7425505199001374,
                 0.0,
                 10.232941084965152, 0.008670443986960541, 0.02518930054513682,
                 0.00035173809357654277, 1.9498823947314372,
                 0.07076858438653699,
                 1.575537229858708, 0.007680099590456979, 0.11548690416574463,
                 0.36819541287735724, 1.0167788891743799, 1.8982382969433484,
                 0.18592323861305898, 0.5467629241607482, 0.035412381441976205,
                 1.3022653233244128, 1.5607347679497048, 3.769733229603823,
                 1.7189172207813006, 7.89221727888717, 0.6600637348175101,
                 3.1750310535443464, 1.2843365324033855, 0.00019745319541229742,
                 1.3103808194586741, 0.05474177927322193, 2.5349844303580973,
                 2.490128288850292, 3.0376559406319203, 10.232941084965152, 0.0,
                 0.4788939984261556, 0.17460855259566754, 0.4731460251212151,
                 3.443442031304839, 0.007970006099635498, 5.874788178407355,
                 0.014659967507680312, 2.33168361395951, 0.009110091328545867,
                 0.7692745712813053, 0.30791885307405575, 1.3811824186464292,
                 0.06790290765785185, 0.5837955108636088, 0.3562581856560772,
                 0.5709579225696713, 0.0442066046383565, 0.07917291940742402,
                 0.13198112047148067, 1.464737331694123, 0.2589234902711638,
                 1.4762855696103465, 0.05096706002300696, 0.017822598024828225,
                 1.249458994964695, 0.07949528822402148, 3.611324260156124,
                 0.992560094200736, 0.008670443986960541, 0.4788939984261556,
                 0.0,
                 4.612593700769369, 1.3468770303397575, 0.15780002924656564,
                 0.13439175661226524, 0.025477160534704023, 1.2750703607149054,
                 0.12463001137216316, 0.6402935695437421, 0.42606761041486246,
                 0.6849305407684494, 0.05011407087772451, 1.4809855350848846,
                 4.197447430861951, 1.9603139962464715, 0.02282474429413071,
                 1.833223170030787, 2.0863716840029674, 2.5169537684311956,
                 0.3046595590596308, 0.09675353093668905, 1.9296194686588968,
                 0.4796086704123658, 1.1968758991554918, 0.018471780278382977,
                 0.015275665471885153, 0.0022812503912629386,
                 0.04111684121517171,
                 0.02518930054513682, 0.17460855259566754, 4.612593700769369,
                 0.0,
                 1.5149267253808774, 0.09720645133977328, 0.24103708941813037,
                 0.17974971440486817, 0.6157404021972565, 0.011194585579480668,
                 2.9502171007386973, 0.0084220773869791, 0.18383880971432195,
                 0.45977917728635725, 3.0628988393445122, 0.509466222714089,
                 0.9935231907734613, 0.34292525294462967, 0.31667433597321426,
                 1.1209245639746603, 0.02744205236818844, 0.07112173750471619,
                 0.30427962936071584, 4.751816512543483, 0.00985497363656113,
                 4.431552882107363, 4.033763024542474, 3.264614671269335,
                 0.040949928891378294, 1.2061606966895686,
                 0.00035173809357654277,
                 0.4731460251212151, 1.3468770303397575, 1.5149267253808774,
                 0.0,
                 0.01846640868712628, 0.08817839493366281, 0.1396283090998387,
                 0.8847566338568429, 1.6342826442002714, 3.6770496946570637,
                 0.17310496711073078, 0.051812196532901256,
                 0.0012261051879518701,
                 0.38656712945336924, 1.0483091695291635, 2.9160520843907802,
                 0.8492924540748621, 1.3927398862511255, 0.6336400804704142,
                 0.3499895393152481, 0.2587302405563811, 1.398044900492979,
                 0.0008054432615618149, 5.540385595353119, 0.013962291159639945,
                 2.809189944749873, 0.22711687728041338, 0.004567656705715261,
                 0.8396443902399026, 1.9498823947314372, 3.443442031304839,
                 0.15780002924656564, 0.09720645133977328, 0.01846640868712628,
                 0.0,
                 0.5133125649487816, 0.2010226415374907, 0.020346090378594753,
                 0.08980997593474964, 0.1348740449076788, 0.1436814139250139,
                 5.070514456780674, 0.0003493146408583148, 0.3072802823494003,
                 0.010150907353580083, 2.4160602387283046, 0.4632098694983039,
                 2.705321821800606, 1.7521950742141061, 0.015587113211376862,
                 0.6221918210053232, 0.006142896455123299, 0.007569918719767164,
                 4.8872634160168165, 3.158828828441505, 0.04308423301176345,
                 1.0223248119537691, 0.9295231363692499, 3.721837823291286e-5,
                 0.07076858438653699, 0.007970006099635498, 0.13439175661226524,
                 0.24103708941813037, 0.08817839493366281, 0.5133125649487816,
                 0.0,
                 7.315787940374968, 0.08947337675722736, 1.1772636989328833,
                 0.8469641878336357, 0.9721124542181016, 3.3626267380127954,
                 10.20463379246497, 3.2705425014879017, 0.02232055816851229,
                 0.7656341889898761, 0.010557178466967826, 0.07094897876806755,
                 2.9070049920848855, 0.17226409543266144, 0.7232068477083758,
                 0.08036519077786751, 1.5747058461966064, 0.28538052632596006,
                 2.3655114957527132, 0.6451025145730368, 0.2633770973844289,
                 1.0908646117276506, 0.7179752092024985, 1.575537229858708,
                 5.874788178407355, 0.025477160534704023, 0.17974971440486817,
                 0.1396283090998387, 0.2010226415374907, 7.315787940374968, 0.0,
                 5.367656506796053, 1.2757040411002112, 0.1955642620160933,
                 0.6009390709452864, 2.0650159469189813, 0.20161011815545493,
                 0.02450814569059551, 0.017316200234819203, 2.9123097250374688,
                 1.03927211541056, 1.436028920042926, 2.7898953220247895,
                 0.02323825680348179, 0.2889589404146145, 0.1375525210294458,
                 1.4774791297754453, 0.4662779557297854, 9.095650461968171,
                 0.006486654233164369, 2.266076641887997, 0.7105010537083735,
                 0.3234765497958904, 0.007680099590456979, 0.014659967507680312,
                 1.2750703607149054, 0.6157404021972565, 0.8847566338568429,
                 0.020346090378594753, 0.08947337675722736, 5.367656506796053,
                 0.0,
                 0.8846792791031545, 0.9066043033163117, 2.1776298640317178,
                 0.05415012744942154, 3.015320862845731, 1.0190602913190674,
                 1.6704352803450486, 0.14227341072691416, 0.011837119525584508,
                 0.40520690794530756, 0.1538469270337239, 0.1542518624609507,
                 0.18339091379244982, 0.001913314944680376, 0.6936208885583496,
                 0.22432056196299002, 3.453372626385981, 0.44691366706463903,
                 0.04347923405479036, 0.13187597384069016, 0.002113633424401835,
                 0.11548690416574463, 2.33168361395951, 0.12463001137216316,
                 0.011194585579480668, 1.6342826442002714, 0.08980997593474964,
                 1.1772636989328833, 1.2757040411002112, 0.8846792791031545,
                 0.0,
                 5.973340196556895, 1.004433408981868, 0.7440732574409432,
                 0.7849569289089404, 0.7442737675629367, 0.9383702844990435,
                 0.730722770107621, 3.578556806125404, 5.34091430641584,
                 0.001966124687652866, 0.6245364481594038, 0.013177646170664782,
                 0.005472645021343744, 3.421887010907891, 4.921442033265541,
                 0.10166295137328987, 1.0897635861613335, 2.095564529734523,
                 2.3668490040511383, 0.598481163610057, 0.36819541287735724,
                 0.009110091328545867, 0.6402935695437421, 2.9502171007386973,
                 3.6770496946570637, 0.1348740449076788, 0.8469641878336357,
                 0.1955642620160933, 0.9066043033163117, 5.973340196556895, 0.0,
                 0.777197528516672, 0.22308323619122544, 0.8099823900258628,
                 2.0612245785921597, 0.7778562078927828, 1.963918502169111,
                 0.0001935152190528547, 0.03678192840194699, 2.4126221170053435,
                 5.169364615038925, 0.7827705723946135, 0.04338931855337045,
                 0.3146276228927668, 0.2638842850044379, 0.03329446529930238,
                 0.065337276318344, 1.205551562121546, 1.1382413945544285,
                 1.3158508361920667, 1.0167788891743799, 0.7692745712813053,
                 0.42606761041486246, 0.0084220773869791, 0.17310496711073078,
                 0.1436814139250139, 0.9721124542181016, 0.6009390709452864,
                 2.1776298640317178, 1.004433408981868, 0.777197528516672, 0.0,
                 4.14900193646909, 2.6200233481142927, 0.1929783016703628,
                 7.396592295457219, 0.3504175531492498, 0.19944103126908855,
                 3.6237762126748168, 0.18930068066787753, 0.002696314521720833,
                 0.9952367628695278, 0.07154469896451926, 0.856948777803816,
                 0.01438103784434963, 0.05301038235116129, 0.0356554005288424,
                 0.13627773271192553, 0.49191277174354975, 0.13992486176965543,
                 1.8982382969433484, 0.30791885307405575, 0.6849305407684494,
                 0.18383880971432195, 0.051812196532901256, 5.070514456780674,
                 3.3626267380127954, 2.0650159469189813, 0.05415012744942154,
                 0.7440732574409432, 0.22308323619122544, 4.14900193646909, 0.0,
                 1.5569352942934072, 1.1329284258890682, 0.8634236848583765,
                 1.051058207259541, 0.0043135687596255684, 0.49612592150809703,
                 0.13281579921152767, 0.0022579378005767375, 0.9553627520510828,
                 3.33840923728006, 0.057372482705150246, 0.449054012553909,
                 0.009766849649276049, 0.05245891006300393, 0.22523503427646824,
                 0.859469194918995, 0.13817323337873397, 0.18592323861305898,
                 1.3811824186464292, 0.05011407087772451, 0.45977917728635725,
                 0.0012261051879518701, 0.0003493146408583148,
                 10.20463379246497,
                 0.20161011815545493, 3.015320862845731, 0.7849569289089404,
                 0.8099823900258628, 2.6200233481142927, 1.5569352942934072,
                 0.0,
                 1.8095843813688324, 0.35656647625171145, 0.03200356725951662,
                 0.5668931778059783, 0.009648524808506798, 1.044499573621065,
                 0.012276160858047898, 1.5957140218918884, 0.01957361450172679,
                 6.782171691371454, 1.0413665510778727, 2.102692742141516,
                 0.3805888973745829, 3.2109733463704604, 0.5075169463033513,
                 3.4945960887092404, 0.5467629241607482, 0.06790290765785185,
                 1.4809855350848846, 3.0628988393445122, 0.38656712945336924,
                 0.3072802823494003, 3.2705425014879017, 0.02450814569059551,
                 1.0190602913190674, 0.7442737675629367, 2.0612245785921597,
                 0.1929783016703628, 1.1329284258890682, 1.8095843813688324,
                 0.0,
                 0.13710165659890777, 1.1100976361369808, 0.567114285998731,
                 0.16829260179467886, 0.1418476624483403, 0.03775568189563732,
                 1.4344115530726784, 0.16287378014846912, 1.903557265135758,
                 0.9138849659329988, 0.179815072666264, 0.1803833343752332,
                 1.5113856461328519, 1.7168119039572676, 7.4381337920809765,
                 0.035412381441976205, 0.5837955108636088, 4.197447430861951,
                 0.509466222714089, 1.0483091695291635, 0.010150907353580083,
                 0.02232055816851229, 0.017316200234819203, 1.6704352803450486,
                 0.9383702844990435, 0.7778562078927828, 7.396592295457219,
                 0.8634236848583765, 0.35656647625171145, 0.13710165659890777,
                 0.0,
                 1.7298968580842586, 0.147591341297575, 0.35464093666881286,
                 0.37646535853470214, 0.06737934011429637, 1.947180899192156,
                 1.7876246627481704, 0.007313713943254057, 0.028607535390821053,
                 0.05255566845931628, 0.8005271974082916, 0.30644983469731363,
                 0.6267295680371396, 0.47092642183660893, 1.3022653233244128,
                 0.3562581856560772, 1.9603139962464715, 0.9935231907734613,
                 2.9160520843907802, 2.4160602387283046, 0.7656341889898761,
                 2.9123097250374688, 0.14227341072691416, 0.730722770107621,
                 1.963918502169111, 0.3504175531492498, 1.051058207259541,
                 0.03200356725951662, 1.1100976361369808, 1.7298968580842586,
                 0.0,
                 0.8970303628076303, 0.33774695203892197, 0.040765717452928125,
                 0.0036090059698889194, 0.04098832414437665,
                 0.12758526578377843,
                 0.24559322832969643, 0.9104775614625547, 2.1007452548225296,
                 0.025524986017782088, 2.0896258399480363, 0.011541731529899844,
                 0.6770365027776871, 1.5607347679497048, 0.5709579225696713,
                 0.02282474429413071, 0.34292525294462967, 0.8492924540748621,
                 0.4632098694983039, 0.010557178466967826, 1.03927211541056,
                 0.011837119525584508, 3.578556806125404, 0.0001935152190528547,
                 0.19944103126908855, 0.0043135687596255684, 0.5668931778059783,
                 0.567114285998731, 0.147591341297575, 0.8970303628076303, 0.0,
                 0.012334344547251538, 0.20999049232195158, 0.03706277336438766,
                 4.549921721623063, 0.544993502951206, 0.0007474084780508606,
                 0.04330292308146197, 0.05846093033060318,
                 0.0030382536236491916,
                 0.018869222386335982, 1.8222819606119114, 0.04518444638740131,
                 3.769733229603823, 0.0442066046383565, 1.833223170030787,
                 0.31667433597321426, 1.3927398862511255, 2.705321821800606,
                 0.07094897876806755, 1.436028920042926, 0.40520690794530756,
                 5.34091430641584, 0.03678192840194699, 3.6237762126748168,
                 0.49612592150809703, 0.009648524808506798, 0.16829260179467886,
                 0.35464093666881286, 0.33774695203892197, 0.012334344547251538,
                 0.0,
                 0.37434746272718805, 0.04329461672124231,
                 0.0025313037602848307,
                 0.009862591343605646, 0.2220862423164934, 0.11873239816090282,
                 0.20922998855874275, 1.1351474256409582, 5.965933412205584,
                 0.8547808998027165, 0.18794945980807312, 1.7189172207813006,
                 0.07917291940742402, 2.0863716840029674, 1.1209245639746603,
                 0.6336400804704142, 1.7521950742141061, 2.9070049920848855,
                 2.7898953220247895, 0.1538469270337239, 0.001966124687652866,
                 2.4126221170053435, 0.18930068066787753, 0.13281579921152767,
                 1.044499573621065, 0.1418476624483403, 0.37646535853470214,
                 0.040765717452928125, 0.20999049232195158, 0.37434746272718805,
                 0.0,
                 1.0005373111876572, 0.22039851695864562, 0.0410753819868166,
                 0.5267620723331236, 0.08648501119557052, 0.5972750768317227,
                 3.2395238389068635e-6, 0.032152266697742286,
                 0.0903551202483371,
                 0.4368435026399025, 7.89221727888717, 0.13198112047148067,
                 2.5169537684311956, 0.02744205236818844, 0.3499895393152481,
                 0.015587113211376862, 0.17226409543266144, 0.02323825680348179,
                 0.1542518624609507, 0.6245364481594038, 5.169364615038925,
                 0.002696314521720833, 0.0022579378005767375,
                 0.012276160858047898,
                 0.03775568189563732, 0.06737934011429637,
                 0.0036090059698889194,
                 0.03706277336438766, 0.04329461672124231, 1.0005373111876572,
                 0.0,
                 0.3592907678801238, 1.441806802885516, 0.7832888498216246,
                 0.058316472296885066, 2.5463482557037587, 8.757716515652291,
                 2.040544779118121, 0.0747386325306723, 0.018615768685222717,
                 0.6600637348175101, 1.464737331694123, 0.3046595590596308,
                 0.07112173750471619, 0.2587302405563811, 0.6221918210053232,
                 0.7232068477083758, 0.2889589404146145, 0.18339091379244982,
                 0.013177646170664782, 0.7827705723946135, 0.9952367628695278,
                 0.9553627520510828, 1.5957140218918884, 1.4344115530726784,
                 1.947180899192156, 0.04098832414437665, 4.549921721623063,
                 0.0025313037602848307, 0.22039851695864562, 0.3592907678801238,
                 0.0,
                 0.015409893675307507, 1.0077735598687634, 0.24441643756988704,
                 0.30833577653948896, 1.1597652035892054, 0.7576449978842045,
                 0.36994169281123035, 0.8463559700818, 3.1750310535443464,
                 0.2589234902711638, 0.09675353093668905, 0.30427962936071584,
                 1.398044900492979, 0.006142896455123299, 0.08036519077786751,
                 0.1375525210294458, 0.001913314944680376, 0.005472645021343744,
                 0.04338931855337045, 0.07154469896451926, 3.33840923728006,
                 0.01957361450172679, 0.16287378014846912, 1.7876246627481704,
                 0.12758526578377843, 0.544993502951206, 0.009862591343605646,
                 0.0410753819868166, 1.441806802885516, 0.015409893675307507,
                 0.0,
                 0.8643258266799899, 1.0735147002897811, 1.3474427239740756,
                 0.28472976113077, 1.373269983915639, 1.5228539382639528,
                 2.996771130837551,
                 1.2843365324033855, 1.4762855696103465, 1.9296194686588968,
                 4.751816512543483, 0.0008054432615618149, 0.007569918719767164,
                 1.5747058461966064, 1.4774791297754453, 0.6936208885583496,
                 3.421887010907891, 0.3146276228927668, 0.856948777803816,
                 0.057372482705150246, 6.782171691371454, 1.903557265135758,
                 0.007313713943254057, 0.24559322832969643,
                 0.0007474084780508606,
                 0.2220862423164934, 0.5267620723331236, 0.7832888498216246,
                 1.0077735598687634, 0.8643258266799899, 0.0,
                 0.8456505278323302,
                 0.5126917946264458, 3.0036548421448734, 0.06678122189397505,
                 0.07400835775768966, 2.8131131409592744,
                 0.00019745319541229742,
                 0.05096706002300696, 0.4796086704123658, 0.00985497363656113,
                 5.540385595353119, 4.8872634160168165, 0.28538052632596006,
                 0.4662779557297854, 0.22432056196299002, 4.921442033265541,
                 0.2638842850044379, 0.01438103784434963, 0.449054012553909,
                 1.0413665510778727, 0.9138849659329988, 0.028607535390821053,
                 0.9104775614625547, 0.04330292308146197, 0.11873239816090282,
                 0.08648501119557052, 0.058316472296885066, 0.24441643756988704,
                 1.0735147002897811, 0.8456505278323302, 0.0, 2.445749094094552,
                 0.023124248734031825, 0.08385045091446482, 3.158280659056386,
                 0.21014077875231008, 1.3103808194586741, 0.017822598024828225,
                 1.1968758991554918, 4.431552882107363, 0.013962291159639945,
                 3.158828828441505, 2.3655114957527132, 9.095650461968171,
                 3.453372626385981, 0.10166295137328987, 0.03329446529930238,
                 0.05301038235116129, 0.009766849649276049, 2.102692742141516,
                 0.179815072666264, 0.05255566845931628, 2.1007452548225296,
                 0.05846093033060318, 0.20922998855874275, 0.5972750768317227,
                 2.5463482557037587, 0.30833577653948896, 1.3474427239740756,
                 0.5126917946264458, 2.445749094094552, 0.0, 0.4864578766670091,
                 1.360212651475197, 2.101461593627673, 0.04997330964659953,
                 0.05474177927322193, 1.249458994964695, 0.018471780278382977,
                 4.033763024542474, 2.809189944749873, 0.04308423301176345,
                 0.6451025145730368, 0.006486654233164369, 0.44691366706463903,
                 1.0897635861613335, 0.065337276318344, 0.0356554005288424,
                 0.05245891006300393, 0.3805888973745829, 0.1803833343752332,
                 0.8005271974082916, 0.025524986017782088,
                 0.0030382536236491916,
                 1.1351474256409582, 3.2395238389068635e-6, 8.757716515652291,
                 1.1597652035892054, 0.28472976113077, 3.0036548421448734,
                 0.023124248734031825, 0.4864578766670091, 0.0,
                 2.1241132431405205,
                 0.12218034125103999, 0.010341717030879462, 2.5349844303580973,
                 0.07949528822402148, 0.015275665471885153, 3.264614671269335,
                 0.22711687728041338, 1.0223248119537691, 0.2633770973844289,
                 2.266076641887997, 0.04347923405479036, 2.095564529734523,
                 1.205551562121546, 0.13627773271192553, 0.22523503427646824,
                 3.2109733463704604, 1.5113856461328519, 0.30644983469731363,
                 2.0896258399480363, 0.018869222386335982, 5.965933412205584,
                 0.032152266697742286, 2.040544779118121, 0.7576449978842045,
                 1.373269983915639, 0.06678122189397505, 0.08385045091446482,
                 1.360212651475197, 2.1241132431405205, 0.0, 0.9053992835162886,
                 0.26216401826629726, 2.490128288850292, 3.611324260156124,
                 0.0022812503912629386, 0.040949928891378294,
                 0.004567656705715261,
                 0.9295231363692499, 1.0908646117276506, 0.7105010537083735,
                 0.13187597384069016, 2.3668490040511383, 1.1382413945544285,
                 0.49191277174354975, 0.859469194918995, 0.5075169463033513,
                 1.7168119039572676, 0.6267295680371396, 0.011541731529899844,
                 1.8222819606119114, 0.8547808998027165, 0.0903551202483371,
                 0.0747386325306723, 0.36994169281123035, 1.5228539382639528,
                 0.07400835775768966, 3.158280659056386, 2.101461593627673,
                 0.12218034125103999, 0.9053992835162886, 0.0], 30, 30)

    S = reshape([0.0, 0.46822730353541253, 0.045214578040503266,
                 7.557884131764847e-7,
                 0.5121709194075258, 0.11653425781137568, 0.18370875740711964,
                 0.03664910269162884, 0.0013871333916744089,
                 0.04010952372404401,
                 0.12075531726289479, 3.1237548202285583, 0.32369208601163907,
                 0.6101443455261925, 0.0291984697228723, 0.8582491769111301,
                 1.2846095581889596, 0.030371637192540126, 0.14602821557434975,
                 0.7892227322881524, 0.38936631608116856, 0.06575743031881624,
                 2.788668982125619, 0.07207472472884384, 1.6586014373515983,
                 0.2976464437342859, 0.2833384114856953, 0.6564378053415584,
                 0.4849101245892234, 0.012411304525635955, 0.46822730353541253,
                 0.0,
                 0.3293930052205924, 1.8225797176092793, 0.016483656228857304,
                 2.514784958578917, 2.3496524689235225, 0.23011134765711094,
                 2.334120085454686, 3.01679987939046, 1.1102958421491271,
                 0.062070545911011604, 0.07191857070190558,
                 0.0002650426943569609,
                 4.063130774219727, 5.752287978825114e-6, 1.1908214882990515,
                 0.05694033376435422, 1.8964594423545116, 0.48122349924627406,
                 0.20759498788829842, 2.006378609728008, 1.0584857965902634,
                 1.5735187671618214, 0.05429850130973238, 2.3772075668434614,
                 0.032789313999975436, 0.023048312175213245, 0.8718931016931785,
                 0.7017974515336335, 0.045214578040503266, 0.3293930052205924,
                 0.0,
                 0.18953957516744993, 0.5703871635483596, 0.6213860435963242,
                 0.5634778753381863, 0.5308622466859753, 1.1100038047903695,
                 0.467410925575381, 0.9628060788374175, 1.5778993783056445,
                 0.12249509468015782, 0.593779997693077, 0.3221778271099935,
                 1.5708561103870133, 0.7057768552162845, 0.35280022788124604,
                 0.7424678295325688, 0.8544603033686053, 0.2063318521135473,
                 4.945622821653228, 0.19556143834590864, 0.33010198399802,
                 2.1754472988215676, 0.028185199433093996, 0.9921414298539121,
                 1.6664581429424052, 0.06191519071965278, 0.9195167360292905,
                 7.557884131764847e-7, 1.8225797176092793, 0.18953957516744993,
                 0.0,
                 0.0005467373522641422, 0.0591361295961871, 0.00462611428028231,
                 0.31384304926268847, 0.35138204567145626, 0.794408623063953,
                 0.23390721740322426, 1.3650849327967765, 0.04092584277351269,
                 0.04545438742563648, 0.19264232424083638, 0.12178948864204565,
                 0.020892254758261442, 0.08081638409897406, 3.4324862761987376,
                 0.12013877678849505, 0.14298427644931688, 0.005505798250427345,
                 0.02912702132088396, 2.429187560402351, 0.1499300838461592,
                 1.7580451527668066, 2.159477887966793, 0.2549402472210953,
                 1.8922918703597338, 1.3663284490881236, 0.5121709194075258,
                 0.016483656228857304, 0.5703871635483596,
                 0.0005467373522641422, 0.0,
                 1.5874744168510817, 0.9062271435766135, 0.21760651163172795,
                 0.6569670225079887, 1.5521867077328588, 1.0576805169853594,
                 0.009714788785659925, 4.989285782871232, 0.38146224897938996,
                 0.49375638957535717, 0.029045568813934493, 0.14295169012397652,
                 0.046451658743568075, 0.032261469497704205, 0.1772961903509501,
                 1.0706185252022664, 0.5010444892253593, 0.19048353054571648,
                 0.4118678654028282, 0.07806627515891096, 0.0008923610672853508,
                 2.257418920139187, 0.0006759156718083686, 1.6681761768453371,
                 2.432628884336451, 0.11653425781137568, 2.514784958578917,
                 0.6213860435963242, 0.0591361295961871, 1.5874744168510817,
                 0.0,
                 0.011221495436770569, 3.2627575094574954, 0.15601092399130753,
                 0.06787352479900019, 0.5281400128171032, 0.7435600884076989,
                 0.07719699976576051, 1.5359624886623802, 0.31714550596249586,
                 0.12082062096366059, 4.906617290453711, 0.6939330666817607,
                 0.029507694091684095, 0.12816306633765098, 1.3629373605847108,
                 0.008299487989271695, 1.2203299228757685, 7.542045198365664,
                 0.0034185763084460443, 0.44449856677724137, 0.558213958577124,
                 0.003300326939254783, 0.0020876090620134857,
                 0.5353195054223019,
                 0.18370875740711964, 2.3496524689235225, 0.5634778753381863,
                 0.00462611428028231, 0.9062271435766135, 0.011221495436770569,
                 0.0,
                 0.0019077284097998414, 1.2989804685357098, 0.42984739620614093,
                 1.9636761715334992, 0.8958865977908953, 2.017984755266556,
                 0.0023753852965995377, 1.0458450436739517, 2.141531188283306,
                 3.3552023838209, 0.5214714715212694, 0.0611880552792519,
                 2.8361800472553775, 0.2201043610809148, 1.212318054970174,
                 3.199215273613063, 0.09498348160497799, 0.05841609903301837,
                 1.3249782456285824, 0.19267851322925228, 0.2676557541593779,
                 3.0299281673886074, 3.720007592983925, 0.03664910269162884,
                 0.23011134765711094, 0.5308622466859753, 0.31384304926268847,
                 0.21760651163172795, 3.2627575094574954, 0.0019077284097998414,
                 0.0,
                 1.361435090360477, 0.09074343080371083, 5.464247190787988,
                 0.05296780797580903, 2.8189787455360786, 0.1413415313427372,
                 0.6975697021965482, 0.04482829754250999, 0.0002167867257542015,
                 0.0362505783902236, 0.6183389429706339, 0.3124643879346603,
                 1.1871975727012798, 1.7887427001903309, 0.7963676042045308,
                 0.30060025853107336, 1.4258634574437228, 0.20394834648035778,
                 0.01731685787054804, 2.1859616855038553, 0.2563629621304449,
                 0.008502647018127304, 0.0013871333916744089, 2.334120085454686,
                 1.1100038047903695, 0.35138204567145626, 0.6569670225079887,
                 0.15601092399130753, 1.2989804685357098, 1.361435090360477,
                 0.0,
                 0.290760219079807, 1.4783773903639386, 0.3033492693939961,
                 0.21048317139706071, 0.5467910332585287, 0.38318114733040043,
                 0.05968734912850758, 0.6502008239115025, 0.6695881045245088,
                 2.157116094437051, 0.7787499821913257, 0.4522697027826738,
                 0.23295498956663577, 0.33688953734175764, 0.35384549580972585,
                 4.61791368136604, 1.3147297191893335, 0.7219491147831041,
                 4.0955497386062305, 1.647871699228463, 0.0053477726417181515,
                 0.04010952372404401, 3.01679987939046, 0.467410925575381,
                 0.794408623063953, 1.5521867077328588, 0.06787352479900019,
                 0.42984739620614093, 0.09074343080371083, 0.290760219079807,
                 0.0,
                 0.6535512430895021, 2.1817029339837846, 1.4548731209419727,
                 0.3130657159505757, 2.068948229971202, 0.4715921888867051,
                 0.11718753903365374, 0.49958496372089223, 0.10803142959111765,
                 1.6331963283796833, 1.0673221139898754, 3.1798765170253245,
                 0.14747084007745465, 0.12932514055254749, 0.7404918000710914,
                 0.00047728335769636954, 0.137094167025554, 0.3693905460626572,
                 1.5355881791889245, 1.7400727530884053, 0.12075531726289479,
                 1.1102958421491271, 0.9628060788374175, 0.23390721740322426,
                 1.0576805169853594, 0.5281400128171032, 1.9636761715334992,
                 5.464247190787988, 1.4783773903639386, 0.6535512430895021, 0.0,
                 0.1536744076871908, 0.040335899811496385, 0.13291694221233089,
                 0.9338329079688388, 1.1030412873930366, 1.1867438953000418,
                 2.192164773276255, 0.8618330789473323, 0.02869169526786568,
                 0.2989825057796756, 0.09433772342932, 5.433867787744401,
                 0.01101938873679886, 3.6205309542971267, 0.12753095276798232,
                 1.2293341144506849, 1.0695836003957258, 0.1025950999152348,
                 0.31616296290585816, 3.1237548202285583, 0.062070545911011604,
                 1.5778993783056445, 1.3650849327967765, 0.009714788785659925,
                 0.7435600884076989, 0.8958865977908953, 0.05296780797580903,
                 0.3033492693939961, 2.1817029339837846, 0.1536744076871908,
                 0.0,
                 0.033274204722268275, 0.24444672597851444, 0.4477964739432835,
                 0.7004151116964384, 0.17546569162143308, 0.10646166751979942,
                 0.22116844553907553, 0.4759897681813156, 0.012128070734421854,
                 0.10114449351949739, 0.2424091458499387, 1.3800804313912136,
                 0.0017819716402835647, 2.0692115901893806, 0.7044564175883371,
                 0.07956780172452275, 1.5145984368497827, 0.40240038818254764,
                 0.32369208601163907, 0.07191857070190558, 0.12249509468015782,
                 0.04092584277351269, 4.989285782871232, 0.07719699976576051,
                 2.017984755266556, 2.8189787455360786, 0.21048317139706071,
                 1.4548731209419727, 0.040335899811496385, 0.033274204722268275,
                 0.0,
                 0.0030516437923026243, 0.010289969723263405, 3.702352581663735,
                 1.183695243084329, 6.309036373688541, 0.18194416116535558,
                 0.031887613405335226, 1.5166163507034305, 3.0863180940971855,
                 0.4015025391884362, 0.01275177892660832, 0.8219577359833635,
                 0.8701832923505695, 0.8690937435161105, 1.079109769649606,
                 0.15780773318499952, 0.27495316356928684, 0.6101443455261925,
                 0.0002650426943569609, 0.593779997693077, 0.04545438742563648,
                 0.38146224897938996, 1.5359624886623802, 0.0023753852965995377,
                 0.1413415313427372, 0.5467910332585287, 0.3130657159505757,
                 0.13291694221233089, 0.24444672597851444,
                 0.0030516437923026243, 0.0,
                 1.3033695776643943, 2.0223300844411054, 5.111118253236609,
                 0.11937765018687378, 0.023123169993379388, 0.3071913353227605,
                 0.6443369589274582, 0.7750379851744245, 0.35343494465565134,
                 2.04475904668195, 0.7650789703903166, 0.02722253262492247,
                 0.16342711228118886, 0.043024085416604727, 0.03061330757764622,
                 0.3220041484762761, 0.0291984697228723, 4.063130774219727,
                 0.3221778271099935, 0.19264232424083638, 0.49375638957535717,
                 0.31714550596249586, 1.0458450436739517, 0.6975697021965482,
                 0.38318114733040043, 2.068948229971202, 0.9338329079688388,
                 0.4477964739432835, 0.010289969723263405, 1.3033695776643943,
                 0.0,
                 0.04909979889517398, 2.794063768366705, 3.14925123258644,
                 0.494651615025789, 0.03422290727654274, 0.04536009828801173,
                 0.6935155589661047, 0.6649911710825187, 0.518493700686671,
                 0.0010375522528203885, 0.017446806950829365, 2.628203786261297,
                 6.9209834624003985, 0.14173006578747044, 1.0671620991389406,
                 0.8582491769111301, 5.752287978825114e-6, 1.5708561103870133,
                 0.12178948864204565, 0.029045568813934493, 0.12082062096366059,
                 2.141531188283306, 0.04482829754250999, 0.05968734912850758,
                 0.4715921888867051, 1.1030412873930366, 0.7004151116964384,
                 3.702352581663735, 2.0223300844411054, 0.04909979889517398,
                 0.0,
                 2.036775848509525, 0.375571611163011, 1.3183990834776016,
                 0.058879591090078294, 0.15287662779741432, 3.052075737921202,
                 0.782027101587524, 0.44405365637769156, 0.14666964821244158,
                 1.8202723156305198, 0.9873436554402706, 0.03663368303024215,
                 0.8431390745260664, 1.2614274687878952, 1.2846095581889596,
                 1.1908214882990515, 0.7057768552162845, 0.020892254758261442,
                 0.14295169012397652, 4.906617290453711, 3.3552023838209,
                 0.0002167867257542015, 0.6502008239115025, 0.11718753903365374,
                 1.1867438953000418, 0.17546569162143308, 1.183695243084329,
                 5.111118253236609, 2.794063768366705, 2.036775848509525, 0.0,
                 0.7859358202070007, 4.7960081955618366, 0.21859231653445074,
                 0.00581552279407904, 0.4380879244264815,
                 0.00038285368126332847,
                 0.525267893215164, 0.7485831511286357, 0.6558696798489804,
                 0.7864679439382976, 1.276271234048148, 1.036831672312871,
                 0.6076111855290259, 0.030371637192540126, 0.05694033376435422,
                 0.35280022788124604, 0.08081638409897406, 0.046451658743568075,
                 0.6939330666817607, 0.5214714715212694, 0.0362505783902236,
                 0.6695881045245088, 0.49958496372089223, 2.192164773276255,
                 0.10646166751979942, 6.309036373688541, 0.11937765018687378,
                 3.14925123258644, 0.375571611163011, 0.7859358202070007, 0.0,
                 0.04450887727876058, 1.2025282695075632, 0.11299236510192588,
                 1.5428709274636385, 1.175423237347167, 0.0061313301390827765,
                 1.877952718440136, 0.5222984239437606, 1.745107934096041,
                 2.316937912957817, 0.9362692611357123, 1.5603585292582196,
                 0.14602821557434975, 1.8964594423545116, 0.7424678295325688,
                 3.4324862761987376, 0.032261469497704205, 0.029507694091684095,
                 0.0611880552792519, 0.6183389429706339, 2.157116094437051,
                 0.10803142959111765, 0.8618330789473323, 0.22116844553907553,
                 0.18194416116535558, 0.023123169993379388, 0.494651615025789,
                 1.3183990834776016, 4.7960081955618366, 0.04450887727876058,
                 0.0,
                 0.6495698378629522, 0.12016735470795564, 2.921086565538518,
                 0.11714810494635661, 0.8263036523798609, 1.3539947382157111,
                 3.412675199167332, 0.0294418551449802, 0.44126781133041515,
                 0.30226972390467693, 0.05087530963972921, 0.7892227322881524,
                 0.48122349924627406, 0.8544603033686053, 0.12013877678849505,
                 0.1772961903509501, 0.12816306633765098, 2.8361800472553775,
                 0.3124643879346603, 0.7787499821913257, 1.6331963283796833,
                 0.02869169526786568, 0.4759897681813156, 0.031887613405335226,
                 0.3071913353227605, 0.03422290727654274, 0.058879591090078294,
                 0.21859231653445074, 1.2025282695075632, 0.6495698378629522,
                 0.0,
                 0.1032506317591683, 0.0014549091645264908, 0.8903236254042561,
                 0.15106849096338323, 0.20044641653078313, 0.003240653389362032,
                 0.01744799770378245, 2.099705888933947, 0.6440027632790813,
                 2.6939157773001576, 0.38936631608116856, 0.20759498788829842,
                 0.2063318521135473, 0.14298427644931688, 1.0706185252022664,
                 1.3629373605847108, 0.2201043610809148, 1.1871975727012798,
                 0.4522697027826738, 1.0673221139898754, 0.2989825057796756,
                 0.012128070734421854, 1.5166163507034305, 0.6443369589274582,
                 0.04536009828801173, 0.15287662779741432, 0.00581552279407904,
                 0.11299236510192588, 0.12016735470795564, 0.1032506317591683,
                 0.0,
                 0.0054632385259518555, 4.096078223644778, 1.9373328000066656,
                 0.5127827640717069, 1.7887980270231276, 0.007234025264081495,
                 0.6408495347400698, 0.3487646163537603, 0.3891444505287961,
                 0.06575743031881624, 2.006378609728008, 4.945622821653228,
                 0.005505798250427345, 0.5010444892253593, 0.008299487989271695,
                 1.212318054970174, 1.7887427001903309, 0.23295498956663577,
                 3.1798765170253245, 0.09433772342932, 0.10114449351949739,
                 3.0863180940971855, 0.7750379851744245, 0.6935155589661047,
                 3.052075737921202, 0.4380879244264815, 1.5428709274636385,
                 2.921086565538518, 0.0014549091645264908,
                 0.0054632385259518555, 0.0,
                 0.0015885646789907133, 1.4966388153444417, 0.39028534206373183,
                 0.13476317264725543, 0.5630666662463909, 0.2255881235433471,
                 1.1418097117119637, 0.6668360940216679, 2.788668982125619,
                 1.0584857965902634, 0.19556143834590864, 0.02912702132088396,
                 0.19048353054571648, 1.2203299228757685, 3.199215273613063,
                 0.7963676042045308, 0.33688953734175764, 0.14747084007745465,
                 5.433867787744401, 0.2424091458499387, 0.4015025391884362,
                 0.35343494465565134, 0.6649911710825187, 0.782027101587524,
                 0.00038285368126332847, 1.175423237347167, 0.11714810494635661,
                 0.8903236254042561, 4.096078223644778, 0.0015885646789907133,
                 0.0,
                 0.01374975722435979, 0.42809279384591564, 0.5673844564213398,
                 1.931698694591947, 0.30937069730044814, 0.25162568499492577,
                 1.6146467978756103, 0.07207472472884384, 1.5735187671618214,
                 0.33010198399802, 2.429187560402351, 0.4118678654028282,
                 7.542045198365664,
                 0.09498348160497799, 0.30060025853107336, 0.35384549580972585,
                 0.12932514055254749, 0.01101938873679886, 1.3800804313912136,
                 0.01275177892660832, 2.04475904668195, 0.518493700686671,
                 0.44405365637769156, 0.525267893215164, 0.0061313301390827765,
                 0.8263036523798609, 0.15106849096338323, 1.9373328000066656,
                 1.4966388153444417, 0.01374975722435979, 0.0,
                 0.39166095946924107,
                 1.015050712192662, 0.00032453177027668757, 0.3815731394559155,
                 1.0089461890875322, 0.013946467652945759, 1.6586014373515983,
                 0.05429850130973238, 2.1754472988215676, 0.1499300838461592,
                 0.07806627515891096, 0.0034185763084460443,
                 0.05841609903301837,
                 1.4258634574437228, 4.61791368136604, 0.7404918000710914,
                 3.6205309542971267, 0.0017819716402835647, 0.8219577359833635,
                 0.7650789703903166, 0.0010375522528203885, 0.14666964821244158,
                 0.7485831511286357, 1.877952718440136, 1.3539947382157111,
                 0.20044641653078313, 0.5127827640717069, 0.39028534206373183,
                 0.42809279384591564, 0.39166095946924107, 0.0,
                 1.9077632495088066,
                 0.02563760930276746, 1.189611062315694, 4.221173966144547,
                 0.4622328771156284, 0.2976464437342859, 2.3772075668434614,
                 0.028185199433093996, 1.7580451527668066,
                 0.0008923610672853508,
                 0.44449856677724137, 1.3249782456285824, 0.20394834648035778,
                 1.3147297191893335, 0.00047728335769636954,
                 0.12753095276798232,
                 2.0692115901893806, 0.8701832923505695, 0.02722253262492247,
                 0.017446806950829365, 1.8202723156305198, 0.6558696798489804,
                 0.5222984239437606, 3.412675199167332, 0.003240653389362032,
                 1.7887980270231276, 0.13476317264725543, 0.5673844564213398,
                 1.015050712192662, 1.9077632495088066, 0.0,
                 0.015884399803282045,
                 0.11697462398292152, 0.7544496472592831, 0.11295396327069153,
                 0.2833384114856953, 0.032789313999975436, 0.9921414298539121,
                 2.159477887966793, 2.257418920139187, 0.558213958577124,
                 0.19267851322925228, 0.01731685787054804, 0.7219491147831041,
                 0.137094167025554, 1.2293341144506849, 0.7044564175883371,
                 0.8690937435161105, 0.16342711228118886, 2.628203786261297,
                 0.9873436554402706, 0.7864679439382976, 1.745107934096041,
                 0.0294418551449802, 0.01744799770378245, 0.007234025264081495,
                 0.5630666662463909, 1.931698694591947, 0.00032453177027668757,
                 0.02563760930276746, 0.015884399803282045, 0.0,
                 4.626701797855792,
                 0.0541978720554515, 0.0002291258456969368, 0.6564378053415584,
                 0.023048312175213245, 1.6664581429424052, 0.2549402472210953,
                 0.0006759156718083686, 0.003300326939254783,
                 0.2676557541593779,
                 2.1859616855038553, 4.0955497386062305, 0.3693905460626572,
                 1.0695836003957258, 0.07956780172452275, 1.079109769649606,
                 0.043024085416604727, 6.9209834624003985, 0.03663368303024215,
                 1.276271234048148, 2.316937912957817, 0.44126781133041515,
                 2.099705888933947, 0.6408495347400698, 0.2255881235433471,
                 0.30937069730044814, 0.3815731394559155, 1.189611062315694,
                 0.11697462398292152, 4.626701797855792, 0.0,
                 0.5531822031848852,
                 0.26093187377091565, 0.4849101245892234, 0.8718931016931785,
                 0.06191519071965278, 1.8922918703597338, 1.6681761768453371,
                 0.0020876090620134857, 3.0299281673886074, 0.2563629621304449,
                 1.647871699228463, 1.5355881791889245, 0.1025950999152348,
                 1.5145984368497827, 0.15780773318499952, 0.03061330757764622,
                 0.14173006578747044, 0.8431390745260664, 1.036831672312871,
                 0.9362692611357123, 0.30226972390467693, 0.6440027632790813,
                 0.3487646163537603, 1.1418097117119637, 0.25162568499492577,
                 1.0089461890875322, 4.221173966144547, 0.7544496472592831,
                 0.0541978720554515, 0.5531822031848852, 0.0,
                 2.9062204542318835,
                 0.012411304525635955, 0.7017974515336335, 0.9195167360292905,
                 1.3663284490881236, 2.432628884336451, 0.5353195054223019,
                 3.720007592983925, 0.008502647018127304, 0.0053477726417181515,
                 1.7400727530884053, 0.31616296290585816, 0.40240038818254764,
                 0.27495316356928684, 0.3220041484762761, 1.0671620991389406,
                 1.2614274687878952, 0.6076111855290259, 1.5603585292582196,
                 0.05087530963972921, 2.6939157773001576, 0.3891444505287961,
                 0.6668360940216679, 1.6146467978756103, 0.013946467652945759,
                 0.4622328771156284, 0.11295396327069153, 0.0002291258456969368,
                 0.26093187377091565, 2.9062204542318835, 0.0], 30, 30)
    T8, Rpm, Adjv, Dpm, Mv, Z1, dbht = DBHTs(D, S; branchorder = :default)
    m1 = Z1[:, 1] .< 0
    m2 = Z1[:, 2] .< 0
    Z1[.!m1, 1] .+= size(Z1, 1) + 1
    Z1[.!m2, 2] .+= size(Z1, 1) + 1
    Z1[m1, 1] .= -Z1[m1, 1]
    Z1[m2, 2] .= -Z1[m2, 2]
    Z1[:, 1:2] .-= 1
    Zt1 = reshape([17.0, 2.0, 4.0, 6.0, 1.0, 9.0, 16.0, 31.0, 11.0, 15.0, 30.0,
                   39.0, 24.0,
                   8.0, 20.0, 19.0, 10.0, 0.0, 44.0, 29.0, 7.0, 49.0, 5.0, 3.0,
                   18.0, 13.0,
                   52.0, 41.0, 51.0, 26.0, 21.0, 12.0, 14.0, 33.0, 34.0, 35.0,
                   36.0, 37.0,
                   38.0, 32.0, 40.0, 28.0, 42.0, 27.0, 22.0, 45.0, 46.0, 47.0,
                   48.0, 43.0,
                   50.0, 23.0, 25.0, 53.0, 54.0, 55.0, 56.0, 57.0,
                   0.08333333333333333,
                   0.09090909090909091, 0.1, 0.1111111111111111, 0.125,
                   0.14285714285714285,
                   0.16666666666666666, 0.2, 0.25, 0.3333333333333333, 0.5, 1.0,
                   0.1,
                   0.1111111111111111, 0.125, 0.14285714285714285,
                   0.16666666666666666, 0.2,
                   0.25, 0.3333333333333333, 0.5, 1.0, 0.2, 0.25,
                   0.3333333333333333, 0.5,
                   1.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 3.0, 4.0, 5.0, 7.0, 8.0,
                   9.0, 4.0,
                   13.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 6.0, 7.0, 4.0, 11.0, 2.0,
                   2.0, 3.0,
                   4.0, 6.0, 19.0, 30.0], :, 4)
    T8, Rpm, Adjv, Dpm, Mv, Z2, dbht = DBHTs(D, S; branchorder = :optimal)
    m1 = Z2[:, 1] .< 0
    m2 = Z2[:, 2] .< 0
    Z2[.!m1, 1] .+= size(Z2, 1) + 1
    Z2[.!m2, 2] .+= size(Z2, 1) + 1
    Z2[m1, 1] .= -Z2[m1, 1]
    Z2[m2, 2] .= -Z2[m2, 2]
    Z2[:, 1:2] .-= 1
    Zt2 = reshape([17.0, 2.0, 4.0, 6.0, 1.0, 9.0, 16.0, 31.0, 11.0, 15.0, 30.0,
                   39.0, 24.0,
                   8.0, 20.0, 19.0, 10.0, 0.0, 44.0, 29.0, 7.0, 49.0, 5.0, 3.0,
                   18.0, 13.0,
                   52.0, 41.0, 51.0, 26.0, 21.0, 12.0, 14.0, 33.0, 34.0, 35.0,
                   36.0, 37.0,
                   38.0, 32.0, 40.0, 28.0, 42.0, 27.0, 22.0, 45.0, 46.0, 47.0,
                   48.0, 43.0,
                   50.0, 23.0, 25.0, 53.0, 54.0, 55.0, 56.0, 57.0,
                   0.08333333333333333,
                   0.09090909090909091, 0.1, 0.1111111111111111, 0.125,
                   0.14285714285714285,
                   0.16666666666666666, 0.2, 0.25, 0.3333333333333333, 0.5, 1.0,
                   0.1,
                   0.1111111111111111, 0.125, 0.14285714285714285,
                   0.16666666666666666, 0.2,
                   0.25, 0.3333333333333333, 0.5, 1.0, 0.2, 0.25,
                   0.3333333333333333, 0.5,
                   1.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 3.0, 4.0, 5.0, 7.0, 8.0,
                   9.0, 4.0,
                   13.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 6.0, 7.0, 4.0, 11.0, 2.0,
                   2.0, 3.0,
                   4.0, 6.0, 19.0, 30.0], :, 4)
    T8, Rpm, Adjv, Dpm, Mv, Z3, dbht = DBHTs(D, S; branchorder = :r)
    m1 = Z3[:, 1] .< 0
    m2 = Z3[:, 2] .< 0
    Z3[.!m1, 1] .+= size(Z3, 1) + 1
    Z3[.!m2, 2] .+= size(Z3, 1) + 1
    Z3[m1, 1] .= -Z3[m1, 1]
    Z3[m2, 2] .= -Z3[m2, 2]
    Z3[:, 1:2] .-= 1
    Zt3 = reshape([17.0, 2.0, 4.0, 6.0, 1.0, 9.0, 16.0, 31.0, 11.0, 15.0, 30.0,
                   39.0, 24.0,
                   8.0, 20.0, 19.0, 10.0, 0.0, 44.0, 29.0, 7.0, 49.0, 5.0, 3.0,
                   18.0, 13.0,
                   52.0, 41.0, 51.0, 26.0, 21.0, 12.0, 14.0, 33.0, 34.0, 35.0,
                   36.0, 37.0,
                   38.0, 32.0, 40.0, 28.0, 42.0, 27.0, 22.0, 45.0, 46.0, 47.0,
                   48.0, 43.0,
                   50.0, 23.0, 25.0, 53.0, 54.0, 55.0, 56.0, 57.0,
                   0.08333333333333333,
                   0.09090909090909091, 0.1, 0.1111111111111111, 0.125,
                   0.14285714285714285,
                   0.16666666666666666, 0.2, 0.25, 0.3333333333333333, 0.5, 1.0,
                   0.1,
                   0.1111111111111111, 0.125, 0.14285714285714285,
                   0.16666666666666666, 0.2,
                   0.25, 0.3333333333333333, 0.5, 1.0, 0.2, 0.25,
                   0.3333333333333333, 0.5,
                   1.0, 2.0, 3.0, 2.0, 2.0, 2.0, 2.0, 3.0, 4.0, 5.0, 7.0, 8.0,
                   9.0, 4.0,
                   13.0, 2.0, 3.0, 2.0, 2.0, 3.0, 4.0, 6.0, 7.0, 4.0, 11.0, 2.0,
                   2.0, 3.0,
                   4.0, 6.0, 19.0, 30.0], :, 4)

    portfolio = HCPortfolio(; prices = prices)
    asset_statistics!(portfolio)

    A, tri, separators, cliques, cliqueTree = PMFG_T2s(portfolio.cor, 5)
    At = reshape([0.0, 0.0, 0.6057125142402467, 0.4076280119894202,
                  0.6007283292568196, 0.0,
                  0.0, 0.0, 0.3760931622396989, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  0.5334873896372299, 0.0, 0.4005150923184834,
                  0.4563060621197611, 0.0, 0.0,
                  0.4679234223759629, 0.0, 0.0, 0.0, 0.2205719200535026, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.4994744800902311, 0.0,
                  0.4333140506300874, 0.0,
                  0.6057125142402467, 0.4679234223759629, 0.0,
                  0.3717423793913424,
                  0.5254251455186676, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.49736750570642574, 0.0, 0.3729496594786427, 0.0,
                  0.4076280119894202,
                  0.0, 0.3717423793913424, 0.0, 0.36406487945095894, 0.0, 0.0,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.6007283292568196,
                  0.0, 0.5254251455186676, 0.36406487945095894, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.45055331750810784, 0.0,
                  0.0,
                  0.4367958927859385, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.44793384817140425, 0.41582030499268713, 0.38420695219653084,
                  0.0, 0.0,
                  0.43312263234089843, 0.23867490474241282, 0.0, 0.0, 0.0,
                  0.5016688137311586, 0.0, 0.0, 0.2205719200535026, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.2523761474376582, 0.0,
                  0.2282846633550536, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2823197933938333,
                  0.3150172062198656,
                  0.2716602732179379, 0.0, 0.3760931622396989, 0.0, 0.0, 0.0,
                  0.0,
                  0.44793384817140425, 0.0, 0.0, 0.0, 0.4854199983366873, 0.0,
                  0.32081806164025833, 0.20259378780073073, 0.45891057801057944,
                  0.25837860559141596, 0.31700042772492043, 0.5186283919577863,
                  0.0,
                  0.8902291777036465, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.41582030499268713,
                  0.0, 0.0, 0.4854199983366873, 0.0, 0.0, 0.3091154580235185,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.5100035829557182, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  0.38420695219653084, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.3945298895880364, 0.0, 0.0, 0.0, 0.0, 0.36834849257726154,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.32081806164025833,
                  0.3091154580235185, 0.0, 0.0, 0.19639947507631086, 0.0, 0.0,
                  0.23012958915724335, 0.0, 0.0, 0.33702846144014853, 0.0, 0.0,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.20259378780073073, 0.0, 0.0,
                  0.19639947507631086, 0.0, 0.0, 0.0, 0.2359281539117052, 0.0,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.43312263234089843, 0.0, 0.0,
                  0.45891057801057944, 0.0, 0.3945298895880364, 0.0, 0.0, 0.0,
                  0.4090481800686867, 0.0, 0.42187414285181213,
                  0.3870971450813409,
                  0.538401680544894, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.23867490474241282, 0.0,
                  0.0, 0.25837860559141596, 0.0, 0.0, 0.0, 0.0,
                  0.4090481800686867, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  0.31700042772492043, 0.0, 0.0, 0.23012958915724335,
                  0.2359281539117052,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.302800983974698, 0.0,
                  0.5334873896372299,
                  0.4994744800902311, 0.49736750570642574, 0.0,
                  0.45055331750810784, 0.0,
                  0.2523761474376582, 0.2823197933938333, 0.5186283919577863,
                  0.0, 0.0, 0.0,
                  0.0, 0.42187414285181213, 0.0, 0.0, 0.0, 0.43524783596887867,
                  0.5676693242628297, 0.4830421898500845, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.3150172062198656, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.3870971450813409, 0.0, 0.0,
                  0.43524783596887867, 0.0, 0.4817030186332232, 0.0,
                  0.4005150923184834,
                  0.4333140506300874, 0.3729496594786427, 0.0, 0.0,
                  0.5016688137311586,
                  0.2282846633550536, 0.2716602732179379, 0.8902291777036465,
                  0.5100035829557182, 0.36834849257726154, 0.33702846144014853,
                  0.0,
                  0.538401680544894, 0.0, 0.302800983974698, 0.5676693242628297,
                  0.4817030186332232, 0.0, 0.0, 0.4563060621197611, 0.0, 0.0,
                  0.0,
                  0.4367958927859385, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.4830421898500845, 0.0, 0.0, 0.0], 20, 20)
    trit = reshape([16.0, 18.0, 16.0, 16.0, 16.0, 18.0, 16.0, 0.0, 16.0, 18.0,
                    16.0, 18.0,
                    18.0, 8.0, 18.0, 8.0, 16.0, 0.0, 16.0, 18.0, 18.0, 13.0,
                    0.0, 2.0, 18.0,
                    8.0, 8.0, 13.0, 16.0, 18.0, 18.0, 8.0, 16.0, 18.0, 8.0,
                    11.0, 18.0, 8.0,
                    18.0, 8.0, 0.0, 0.0, 2.0, 2.0, 8.0, 8.0, 2.0, 2.0, 13.0,
                    13.0, 5.0, 5.0,
                    4.0, 4.0, 13.0, 13.0, 5.0, 5.0, 4.0, 4.0, 9.0, 9.0, 5.0,
                    5.0, 17.0,
                    17.0, 11.0, 11.0, 1.0, 1.0, 15.0, 15.0, 7.0, 0.0, 6.0, 0.0,
                    19.0, 2.0,
                    4.0, 3.0, 13.0, 15.0, 1.0, 1.0, 10.0, 14.0, 9.0, 9.0, 19.0,
                    19.0, 17.0,
                    17.0, 10.0, 10.0, 3.0, 3.0, 11.0, 11.0, 14.0, 14.0, 7.0,
                    7.0, 15.0,
                    12.0, 6.0, 6.0, 12.0, 12.0], :, 3)
    separatorst = reshape([16.0, 16.0, 16.0, 16.0, 18.0, 18.0, 16.0, 16.0, 18.0,
                           0.0, 18.0,
                           8.0, 16.0, 18.0, 16.0, 8.0, 18.0, 0.0, 18.0, 18.0,
                           8.0, 8.0, 0.0,
                           18.0, 13.0, 2.0, 8.0, 13.0, 18.0, 8.0, 18.0, 11.0,
                           0.0, 2.0, 8.0,
                           2.0, 13.0, 5.0, 4.0, 13.0, 5.0, 4.0, 9.0, 5.0, 17.0,
                           11.0, 1.0,
                           15.0], :, 3)
    cliquest = reshape([16.0, 16.0, 16.0, 16.0, 16.0, 18.0, 18.0, 16.0, 16.0,
                        18.0, 0.0,
                        18.0, 8.0, 16.0, 18.0, 16.0, 8.0, 18.0, 18.0, 0.0, 18.0,
                        18.0, 8.0,
                        8.0, 0.0, 18.0, 13.0, 2.0, 8.0, 13.0, 18.0, 8.0, 18.0,
                        11.0, 8.0,
                        0.0, 2.0, 8.0, 2.0, 13.0, 5.0, 4.0, 13.0, 5.0, 4.0, 9.0,
                        5.0, 17.0,
                        11.0, 1.0, 15.0, 0.0, 2.0, 4.0, 13.0, 1.0, 5.0, 9.0,
                        19.0, 17.0,
                        10.0, 3.0, 11.0, 14.0, 7.0, 15.0, 6.0, 12.0], :, 4)
    cliqueTreet = reshape([0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1,
                           0, 0, 1, 0,
                           0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0,
                           1, 1, 1, 1,
                           1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0,
                           0, 1, 0, 0,
                           1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1,
                           0, 1, 0, 0,
                           0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
                           0, 1, 0, 0,
                           0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0,
                           0, 1, 0, 0,
                           0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
                           1, 0, 0, 0,
                           0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0,
                           0, 0, 0, 0,
                           0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0,
                           1, 0, 0, 1,
                           0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1,
                           0, 0, 0, 1,
                           0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           1, 0, 0], 17, 17)

    A, tri, separators, cliques, cliqueTree = PMFG_T2s(D + I, 5)
    At = reshape([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.3158508361920667, 0.0, 0.13817323337873397,
                  3.4945960887092404,
                  7.4381337920809765, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  2.996771130837551,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.232941084965152, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 1.575537229858708, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.18592323861305898, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 7.89221727888717, 0.0, 0.0, 0.0, 0.0,
                  1.3103808194586741, 0.05474177927322193, 0.0,
                  2.490128288850292, 0.0,
                  10.232941084965152, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  5.874788178407355, 0.0,
                  0.0, 0.0, 0.0, 0.0, 1.3811824186464292, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.611324260156124, 0.0,
                  0.0, 0.0, 0.0,
                  4.612593700769369, 1.3468770303397575, 0.15780002924656564,
                  0.0, 0.0, 0.0,
                  0.0, 0.6402935695437421, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.9603139962464715, 0.0,
                  0.0, 0.0, 2.5169537684311956, 0.0, 0.0, 0.0,
                  0.4796086704123658,
                  1.1968758991554918, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  4.612593700769369, 0.0,
                  1.5149267253808774, 0.0, 0.0, 0.0, 0.0, 0.0,
                  2.9502171007386973, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.31667433597321426, 0.0,
                  0.02744205236818844,
                  0.0, 0.0, 0.0, 0.0, 4.431552882107363, 4.033763024542474,
                  3.264614671269335, 0.0, 0.0, 0.0, 0.0, 1.3468770303397575,
                  1.5149267253808774, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  3.6770496946570637, 0.0,
                  0.0, 0.0, 0.0, 0.0, 2.9160520843907802, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  5.540385595353119, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.15780002924656564,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  2.4160602387283046, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  4.8872634160168165,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  7.315787940374968, 0.0, 0.0, 0.0, 0.0, 0.0, 10.20463379246497,
                  3.2705425014879017, 0.0, 0.0, 0.0, 0.0, 2.9070049920848855,
                  0.0, 0.0, 0.0,
                  1.5747058461966064, 0.0, 2.3655114957527132, 0.0, 0.0, 0.0,
                  0.0,
                  1.575537229858708, 5.874788178407355, 0.0, 0.0, 0.0, 0.0,
                  7.315787940374968, 0.0, 5.367656506796053, 0.0, 0.0, 0.0, 0.0,
                  0.20161011815545493, 0.0, 0.0, 0.0, 0.0, 0.0,
                  2.7898953220247895,
                  0.02323825680348179, 0.0, 0.0, 1.4774791297754453, 0.0,
                  9.095650461968171,
                  0.0, 0.0, 0.7105010537083735, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  5.367656506796053, 0.0, 0.0, 0.0, 0.0, 0.0, 3.015320862845731,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6936208885583496, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 5.34091430641584, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  0.0, 1.0897635861613335, 2.095564529734523, 0.0, 0.0, 0.0,
                  0.0,
                  0.6402935695437421, 2.9502171007386973, 3.6770496946570637,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.963918502169111,
                  0.0, 0.0, 0.0,
                  5.169364615038925, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.3158508361920667, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 4.14900193646909, 2.6200233481142927, 0.0,
                  7.396592295457219, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.07154469896451926, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  4.14900193646909, 0.0, 1.5569352942934072, 0.0,
                  0.8634236848583765, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 3.33840923728006, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  0.13817323337873397, 0.18592323861305898, 1.3811824186464292,
                  0.0, 0.0,
                  0.0, 0.0, 10.20463379246497, 0.20161011815545493,
                  3.015320862845731, 0.0,
                  0.0, 2.6200233481142927, 1.5569352942934072, 0.0,
                  1.8095843813688324,
                  0.35656647625171145, 0.0, 0.5668931778059783, 0.0, 0.0, 0.0,
                  1.5957140218918884, 0.0, 6.782171691371454, 0.0,
                  2.102692742141516, 0.0,
                  0.0, 0.0, 3.4945960887092404, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  3.2705425014879017, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.8095843813688324, 0.0,
                  0.13710165659890777, 0.0, 0.567114285998731, 0.0, 0.0, 0.0,
                  1.4344115530726784, 0.0, 1.903557265135758, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  7.4381337920809765, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  7.396592295457219, 0.8634236848583765, 0.35656647625171145,
                  0.13710165659890777, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.947180899192156,
                  1.7876246627481704, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  1.9603139962464715, 0.0, 2.9160520843907802,
                  2.4160602387283046, 0.0, 0.0,
                  0.0, 0.0, 1.963918502169111, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.9104775614625547, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.5668931778059783,
                  0.567114285998731, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  4.549921721623063, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.31667433597321426,
                  0.0, 0.0, 0.0, 0.0, 0.0, 5.34091430641584, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.1351474256409582,
                  5.965933412205584, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  2.9070049920848855, 2.7898953220247895, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.5972750768317227, 0.0,
                  0.0, 0.0, 0.0, 7.89221727888717, 0.0, 2.5169537684311956,
                  0.02744205236818844, 0.0, 0.0, 0.0, 0.02323825680348179, 0.0,
                  0.0,
                  5.169364615038925, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 2.5463482557037587, 8.757716515652291,
                  2.040544779118121,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  1.5957140218918884, 1.4344115530726784, 1.947180899192156,
                  0.0,
                  4.549921721623063, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.07154469896451926, 3.33840923728006, 0.0, 0.0,
                  1.7876246627481704, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  2.996771130837551, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.5747058461966064,
                  1.4774791297754453, 0.6936208885583496, 0.0, 0.0, 0.0, 0.0,
                  6.782171691371454, 1.903557265135758, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.4796086704123658, 0.0,
                  5.540385595353119, 4.8872634160168165, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.9104775614625547, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 1.3103808194586741, 0.0,
                  1.1968758991554918,
                  4.431552882107363, 0.0, 0.0, 2.3655114957527132,
                  9.095650461968171, 0.0,
                  0.0, 0.0, 0.0, 0.0, 2.102692742141516, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  0.5972750768317227, 2.5463482557037587, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  0.4864578766670091, 0.0, 0.0, 0.0, 0.05474177927322193, 0.0,
                  0.0,
                  4.033763024542474, 0.0, 0.0, 0.0, 0.0, 0.0,
                  1.0897635861613335, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1351474256409582, 0.0,
                  8.757716515652291,
                  0.0, 0.0, 0.0, 0.0, 0.4864578766670091, 0.0,
                  2.1241132431405205, 0.0, 0.0,
                  0.0, 0.0, 0.0, 3.264614671269335, 0.0, 0.0, 0.0, 0.0, 0.0,
                  2.095564529734523, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  5.965933412205584, 0.0, 2.040544779118121, 0.0, 0.0, 0.0, 0.0,
                  0.0,
                  2.1241132431405205, 0.0, 0.0, 0.0, 2.490128288850292,
                  3.611324260156124,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.7105010537083735, 0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0,
                  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                  0.0, 0.0,
                  0.0], size(A))
    trit = reshape([2, 9, 2, 2, 9, 27, 2, 9, 2, 9, 9, 15, 2, 27, 9, 15, 27, 22,
                    27, 22, 22,
                    5, 22, 28, 28, 5, 28, 29, 15, 8, 2, 9, 15, 25, 15, 16, 15,
                    1, 15, 17, 5,
                    4, 4, 12, 4, 6, 4, 18, 9, 27, 17, 13, 15, 16, 15, 16, 9, 27,
                    9, 27, 15,
                    15, 15, 15, 27, 27, 8, 8, 22, 22, 25, 25, 28, 28, 5, 5, 4,
                    4, 5, 5, 29,
                    29, 20, 20, 25, 25, 3, 3, 16, 16, 1, 1, 17, 17, 13, 13, 12,
                    12, 6, 6,
                    18, 18, 26, 26, 8, 8, 14, 14, 17, 17, 23, 23, 22, 21, 30,
                    15, 10, 8, 3,
                    3, 28, 22, 25, 16, 28, 4, 10, 10, 5, 29, 4, 12, 12, 6, 29,
                    20, 11, 20,
                    11, 11, 1, 16, 30, 30, 19, 1, 13, 17, 14, 13, 14, 24, 6, 18,
                    26, 18, 7,
                    26, 7, 7, 21, 21, 24, 24, 23, 23, 19, 19], :, 3)
    separatorst = reshape([9, 2, 2, 9, 2, 9, 27, 27, 22, 22, 28, 28, 15, 2, 15,
                           15, 15, 15,
                           5, 4, 4, 4, 9, 17, 15, 15, 27, 9, 9, 15, 27, 15, 22,
                           22, 5, 28,
                           5, 29, 8, 9, 25, 16, 1, 17, 4, 12, 6, 18, 27, 13, 16,
                           16, 15, 15,
                           27, 8, 22, 25, 28, 5, 4, 5, 29, 20, 25, 3, 16, 1, 17,
                           13, 12, 6,
                           18, 26, 8, 14, 17, 23], :, 3)
    cliquest = reshape([2, 9, 2, 2, 9, 2, 9, 27, 27, 22, 22, 28, 28, 15, 2, 15,
                        15, 15, 15,
                        5, 4, 4, 4, 9, 17, 15, 15, 9, 27, 9, 9, 15, 27, 15, 22,
                        22, 5, 28,
                        5, 29, 8, 9, 25, 16, 1, 17, 4, 12, 6, 18, 27, 13, 16,
                        16, 27, 15,
                        15, 27, 8, 22, 25, 28, 5, 4, 5, 29, 20, 25, 3, 16, 1,
                        17, 13, 12, 6,
                        18, 26, 8, 14, 17, 23, 15, 8, 3, 22, 25, 28, 10, 5, 4,
                        12, 29, 20,
                        11, 16, 30, 1, 17, 13, 14, 6, 18, 26, 7, 21, 24, 23,
                        19], :, 4)
    cliqueTreet = reshape([0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0,
                           1, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,
                           0, 0, 0, 0,
                           1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
                           0, 0, 0, 1,
                           1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
                           0, 0, 0, 1,
                           0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0,
                           0, 0, 0, 1,
                           0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           1, 0, 0, 0,
                           1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 1,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0,
                           1, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 1,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
                           0, 0, 0, 0,
                           1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
                           1, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
                           0, 0, 0, 1,
                           1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 1, 0, 0,
                           0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 1,
                           0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0,
                           0, 0, 0, 0,
                           0, 1, 0], size(A) .- 3)

    @test isapprox(Z1, Zt1)
    @test isapprox(Z2, Zt2)
    @test isapprox(Z3, Zt3)
    @test isapprox(A, At)
    @test isapprox(tri, trit)
    @test isapprox(separators, separatorst)
    @test isapprox(cliques, cliquest)
    @test isapprox(cliqueTree, cliqueTreet)
end
