using Test
using PortfolioOptimiser, CSV, DataFrames, Statistics

@testset "Risk models" begin
    df = CSV.read("./assets/stock_prices.csv", DataFrame)
    dropmissing!(df)
    returns = returns_from_prices(df[!, 2:end])
    cov_mtx = risk_matrix(
        SCov(),
        Matrix(returns),
        1.02^(1 / 252) - 1,
        SFix(),
        252,
        Int(ceil(252 / 1.4)),
    )
    testcov = reshape(
        [
            0.022525453904467,
            0.014702519870182,
            0.019053982917046,
            0.018696916900512,
            0.018409284534755,
            0.012529128830922,
            0.025945495387098,
            0.00906252641551,
            0.016002832942479,
            0.014837626429073,
            0.008289326315192,
            0.016565859447689,
            0.020363864553773,
            0.0106456062799,
            0.018202853128116,
            0.013186329325946,
            0.014352437901067,
            0.010168834926307,
            0.013642351807908,
            0.012663735203131,
            0.014702519870182,
            0.024877719319234,
            0.016870717350807,
            0.017722225672765,
            0.015812096439494,
            0.011678614245765,
            0.027343097346851,
            0.008513232865114,
            0.015709056305636,
            0.014241616539979,
            0.007973271889648,
            0.017286173384212,
            0.023361014259085,
            0.010741372923038,
            0.020726861755274,
            0.014769673119315,
            0.013711441290225,
            0.00833181521624,
            0.013006276915931,
            0.01114284463531,
            0.019053982917046,
            0.016870717350807,
            0.029504687179255,
            0.022036183656905,
            0.020499385981739,
            0.013801364374561,
            0.029751079162577,
            0.008985313368779,
            0.017402321317274,
            0.016112974285734,
            0.00854913841589,
            0.019936495988079,
            0.024214251349298,
            0.009980421638581,
            0.019849836881366,
            0.015303103580172,
            0.015967297259296,
            0.010850821740143,
            0.01418955073874,
            0.014044230051494,
            0.018696916900512,
            0.017722225672765,
            0.022036183656905,
            0.04492421976902,
            0.021583535546375,
            0.015968076421437,
            0.040335092738185,
            0.010597967619348,
            0.020717405376339,
            0.019522089125673,
            0.010356447924047,
            0.022982694239327,
            0.033494500806262,
            0.013259809899829,
            0.031519029969913,
            0.017840237818766,
            0.01711297092672,
            0.011471372004329,
            0.017110588888627,
            0.014039178633428,
            0.018409284534755,
            0.015812096439494,
            0.020499385981739,
            0.021583535546375,
            0.030720052288252,
            0.012473036680992,
            0.030353854237477,
            0.009351268305371,
            0.017476523182104,
            0.015297753200559,
            0.00823423753673,
            0.019132257038425,
            0.023504172143148,
            0.010334316949157,
            0.022182175733993,
            0.014285336585942,
            0.015802398362235,
            0.009753449058108,
            0.014165665150165,
            0.014562406771882,
            0.012529128830922,
            0.011678614245765,
            0.013801364374561,
            0.015968076421437,
            0.012473036680992,
            0.02440228436048,
            0.024270353503385,
            0.008929498787609,
            0.016590855691834,
            0.015246302436768,
            0.009357190994096,
            0.020838468107746,
            0.031461352497691,
            0.0111529534843,
            0.022433204353138,
            0.012770419417478,
            0.011607514518822,
            0.009310312741978,
            0.013864426966984,
            0.010271579915927,
            0.025945495387098,
            0.027343097346851,
            0.029751079162577,
            0.040335092738185,
            0.030353854237477,
            0.024270353503385,
            0.155039128410935,
            0.015774747228493,
            0.03520296177244,
            0.032434455241135,
            0.018291992172521,
            0.036086319478679,
            0.061043316460493,
            0.020962191067428,
            0.052738849401468,
            0.032510076463945,
            0.026615333851302,
            0.018577521292829,
            0.027791112301525,
            0.02004136380838,
            0.00906252641551,
            0.008513232865114,
            0.008985313368779,
            0.010597967619348,
            0.009351268305371,
            0.008929498787609,
            0.015774747228493,
            0.021040043228967,
            0.010153058123292,
            0.00994413171462,
            0.007118337336687,
            0.013703951963209,
            0.025712628094029,
            0.007965166258197,
            0.013724736058423,
            0.013552473863293,
            0.007872045391554,
            0.007553860717186,
            0.009533706229943,
            0.008250553261039,
            0.016002832942479,
            0.015709056305636,
            0.017402321317274,
            0.020717405376339,
            0.017476523182104,
            0.016590855691834,
            0.03520296177244,
            0.010153058123292,
            0.033703059151725,
            0.01999679985416,
            0.009601367101102,
            0.022904778615797,
            0.032114247249851,
            0.014805757364219,
            0.028375007677103,
            0.018982645552864,
            0.016853429564492,
            0.011901752277136,
            0.024550299661909,
            0.012844360207056,
            0.014837626429073,
            0.014241616539979,
            0.016112974285734,
            0.019522089125673,
            0.015297753200559,
            0.015246302436768,
            0.032434455241135,
            0.00994413171462,
            0.01999679985416,
            0.030013916039327,
            0.010146921400224,
            0.022977718154282,
            0.034760579005305,
            0.012746949467944,
            0.026693425701261,
            0.018036547351302,
            0.013293845137808,
            0.010717987931216,
            0.016439844471517,
            0.012170455458605,
            0.008289326315192,
            0.007973271889648,
            0.00854913841589,
            0.010356447924047,
            0.00823423753673,
            0.009357190994096,
            0.018291992172521,
            0.007118337336687,
            0.009601367101102,
            0.010146921400224,
            0.013322768453092,
            0.011365383230523,
            0.019233470534308,
            0.007930364671191,
            0.015464001707986,
            0.008828942689305,
            0.007422085347014,
            0.006545773475848,
            0.008396896606228,
            0.006707225996955,
            0.016565859447689,
            0.017286173384212,
            0.019936495988079,
            0.022982694239327,
            0.019132257038425,
            0.020838468107746,
            0.036086319478679,
            0.013703951963209,
            0.022904778615797,
            0.022977718154282,
            0.011365383230523,
            0.098323500223113,
            0.049266391473751,
            0.014767159777128,
            0.036819645459222,
            0.025548150829406,
            0.016805891212801,
            0.013044893686802,
            0.018942284744052,
            0.016948695207603,
            0.020363864553773,
            0.023361014259085,
            0.024214251349298,
            0.033494500806262,
            0.023504172143148,
            0.031461352497691,
            0.061043316460493,
            0.025712628094029,
            0.032114247249851,
            0.034760579005305,
            0.019233470534308,
            0.049266391473751,
            0.217250051013063,
            0.022891842887802,
            0.0712810230896,
            0.042122318236915,
            0.020267249870451,
            0.017713825770789,
            0.023354170633112,
            0.022831361630414,
            0.0106456062799,
            0.010741372923038,
            0.009980421638581,
            0.013259809899829,
            0.010334316949157,
            0.0111529534843,
            0.020962191067428,
            0.007965166258197,
            0.014805757364219,
            0.012746949467944,
            0.007930364671191,
            0.014767159777128,
            0.022891842887802,
            0.018268949158542,
            0.025453850018682,
            0.011543173328894,
            0.01044740392348,
            0.008305838702664,
            0.012562806535381,
            0.008419459935667,
            0.018202853128116,
            0.020726861755274,
            0.019849836881366,
            0.031519029969913,
            0.022182175733993,
            0.022433204353138,
            0.052738849401468,
            0.013724736058423,
            0.028375007677103,
            0.026693425701261,
            0.015464001707986,
            0.036819645459222,
            0.0712810230896,
            0.025453850018682,
            0.12537329786879,
            0.02861913492648,
            0.018888305321645,
            0.014190840162381,
            0.022219019674271,
            0.016300305338172,
            0.013186329325946,
            0.014769673119315,
            0.015303103580172,
            0.017840237818766,
            0.014285336585942,
            0.012770419417478,
            0.032510076463945,
            0.013552473863293,
            0.018982645552864,
            0.018036547351302,
            0.008828942689305,
            0.025548150829406,
            0.042122318236915,
            0.011543173328894,
            0.02861913492648,
            0.053688934136254,
            0.012850578683661,
            0.010285493010373,
            0.014886458492273,
            0.012393441822333,
            0.014352437901067,
            0.013711441290225,
            0.015967297259296,
            0.01711297092672,
            0.015802398362235,
            0.011607514518822,
            0.026615333851302,
            0.007872045391554,
            0.016853429564492,
            0.013293845137808,
            0.007422085347014,
            0.016805891212801,
            0.020267249870451,
            0.01044740392348,
            0.018888305321645,
            0.012850578683661,
            0.018888968545482,
            0.009215066292241,
            0.013890907862614,
            0.011030687476662,
            0.010168834926307,
            0.00833181521624,
            0.010850821740143,
            0.011471372004329,
            0.009753449058108,
            0.009310312741978,
            0.018577521292829,
            0.007553860717186,
            0.011901752277136,
            0.010717987931216,
            0.006545773475848,
            0.013044893686802,
            0.017713825770789,
            0.008305838702664,
            0.014190840162381,
            0.010285493010373,
            0.009215066292241,
            0.013588093093942,
            0.01013169888453,
            0.008114476181133,
            0.013642351807908,
            0.013006276915931,
            0.01418955073874,
            0.017110588888627,
            0.014165665150165,
            0.013864426966984,
            0.027791112301525,
            0.009533706229943,
            0.024550299661909,
            0.016439844471517,
            0.008396896606228,
            0.018942284744052,
            0.023354170633112,
            0.012562806535381,
            0.022219019674271,
            0.014886458492273,
            0.013890907862614,
            0.01013169888453,
            0.021570979370674,
            0.010773216311524,
            0.012663735203131,
            0.01114284463531,
            0.014044230051494,
            0.014039178633428,
            0.014562406771882,
            0.010271579915927,
            0.02004136380838,
            0.008250553261039,
            0.012844360207056,
            0.012170455458605,
            0.006707225996955,
            0.016948695207603,
            0.022831361630414,
            0.008419459935667,
            0.016300305338172,
            0.012393441822333,
            0.011030687476662,
            0.008114476181133,
            0.010773216311524,
            0.020237813558209,
        ],
        20,
        :,
    )
    @test isapprox(cov_mtx, testcov, rtol = 1e-4)

    cov_mtx = risk_matrix(
        ESCov(),
        Matrix(returns),
        1.02^(1 / 252) - 1,
        SFix(),
        252,
        Int(ceil(252 / 1.4)),
    )
    testcov = reshape(
        [0.03900084445226888 0.02374258088471931 0.035869417622279645 0.03640742649057418 0.028186004966870952 0.027240440548595438 0.04026661312611741 0.0191731384957373 0.02818455631006372 0.028000113283300914 0.017626714412831493 0.022437046504583197 0.031121564573307763 0.02014972137405705 0.03241396792252521 0.02079315932751833 0.024927854004288732 0.018751295520966653 0.025262612711423604 0.014426759595958854 0.02374258088471931 0.02327494227017931 0.022956880172756204 0.024941914379434854 0.019355183380401382 0.01887419883223524 0.03122690192576201 0.012470777830288101 0.01841442909919217 0.018520585572330918 0.01293080903897608 0.018295297099522895 0.03238238463082841 0.014583339503145139 0.027782792063716557 0.016713464235307462 0.017796258078622344 0.011804652050756679 0.016098371263525268 0.010406188430738846 0.035869417622279645 0.022956880172756204 0.05005312642447694 0.0385167550521469 0.03021106687053133 0.029343832605535695 0.04220061285648465 0.021117500926600936 0.02613027586944575 0.029006297542945834 0.01731813629947294 0.023279271685409657 0.0357935896522795 0.017975195294675946 0.03942532201802745 0.021209973453588334 0.025016518054020373 0.018500147232217625 0.022847270389948843 0.015246051405915478 0.03640742649057418 0.024941914379434854 0.0385167550521469 0.05661794399499479 0.035624665781281026 0.0313532851022564 0.051160549485834914 0.01998286255916682 0.028665450585703245 0.02996257532967651 0.019328514288973822 0.03041497497369548 0.03913850317111943 0.019807350849157714 0.044333428438182616 0.023465250862139717 0.027524327210544368 0.018010882985740766 0.026134963257091443 0.01636912812780202 0.028186004966870952 0.019355183380401382 0.03021106687053133 0.035624665781281026 0.03905409950660545 0.022414759478299223 0.041018877367648206 0.01805296347373808 0.02462064241601972 0.020531501385830174 0.013590244712487107 0.019517538178452556 0.03049713660263585 0.013965603213361679 0.03392745726308473 0.016641500616100705 0.02422498639647871 0.0152281956638418 0.020344188452962424 0.015597624891021749 0.027240440548595438 0.01887419883223524 0.029343832605535695 0.0313532851022564 0.022414759478299223 0.06116878239154157 0.04145860144242304 0.022159497319487687 0.026640485466983343 0.025884923514425253 0.021219401548214303 0.03901433850134988 0.06968465612676489 0.020564660411202005 0.04391838454223453 0.022738368113496225 0.019796529648499962 0.019318188309949625 0.02425324727007459 0.014754165842570409 0.04026661312611741 0.03122690192576201 0.04220061285648465 0.051160549485834914 0.041018877367648206 0.04145860144242304 0.1286675794180281 0.028464815708040776 0.03762634439964831 0.03899364092979199 0.029321663551167148 0.04531682206046382 0.07705739272036252 0.02785530576924673 0.06243910933412938 0.03229192142345256 0.033695061673749895 0.02617043957917601 0.032943424226975056 0.01949257551110657 0.0191731384957373 0.012470777830288101 0.021117500926600936 0.01998286255916682 0.01805296347373808 0.022159497319487687 0.028464815708040776 0.04030024827873196 0.017451513041391822 0.019083874824329827 0.014909353660265579 0.019905466812838148 0.05250231813167481 0.016264059254567913 0.026826667619076355 0.020964991158943954 0.015578936943864922 0.015830596436245955 0.015647685114910603 0.01184098370382105 0.02818455631006372 0.01841442909919217 0.02613027586944575 0.028665450585703245 0.02462064241601972 0.026640485466983343 0.03762634439964831 0.017451513041391822 0.033276816662583544 0.02436868793147879 0.017897852589770336 0.023271174776337316 0.035361987289644146 0.016319552560780434 0.028633624519339734 0.01997441607572644 0.022090970319827128 0.018928129761107745 0.027458957840935938 0.012942719383273033 0.028000113283300914 0.018520585572330918 0.029006297542945834 0.02996257532967651 0.020531501385830174 0.025884923514425253 0.03899364092979199 0.019083874824329827 0.02436868793147879 0.035151120365633115 0.01892418295485163 0.027202989304215396 0.04161280681503957 0.01761802214509021 0.035637124370474296 0.020285835550748678 0.019071300050307882 0.01720100975249153 0.022283279935779637 0.012602146173577373 0.017626714412831493 0.01293080903897608 0.01731813629947294 0.019328514288973822 0.013590244712487107 0.021219401548214303 0.029321663551167148 0.014909353660265579 0.017897852589770336 0.01892418295485163 0.022963931568992648 0.01803312268427431 0.032309010925483585 0.014126572282556905 0.02371198004027108 0.016296010422792606 0.013944725368054694 0.013375620084307994 0.016562070185158297 0.009214356456215251 0.022437046504583197 0.018295297099522895 0.023279271685409657 0.03041497497369548 0.019517538178452556 0.03901433850134988 0.04531682206046382 0.019905466812838148 0.023271174776337316 0.027202989304215396 0.01803312268427431 0.13279231919878043 0.06947900898459157 0.020449895817267912 0.04773069173273337 0.029009348773535257 0.016534131366384444 0.017510693061620033 0.022571412515189015 0.014167554885994752 0.031121564573307763 0.03238238463082841 0.0357935896522795 0.03913850317111943 0.03049713660263585 0.06968465612676489 0.07705739272036252 0.05250231813167481 0.035361987289644146 0.04161280681503957 0.032309010925483585 0.06947900898459157 0.29401151056041896 0.030432377210891298 0.0931883397659145 0.05158256719247313 0.024902758676110186 0.028750244403287613 0.030840782861172318 0.0315898977595021 0.02014972137405705 0.014583339503145139 0.017975195294675946 0.019807350849157714 0.013965603213361679 0.020564660411202005 0.02785530576924673 0.016264059254567913 0.016319552560780434 0.01761802214509021 0.014126572282556905 0.020449895817267912 0.030432377210891298 0.02186711936186108 0.02477835186436577 0.017204173676101633 0.013487061890850824 0.013294173072279897 0.016285987597671987 0.009224145577920985 0.03241396792252521 0.027782792063716557 0.03942532201802745 0.044333428438182616 0.03392745726308473 0.04391838454223453 0.06243910933412938 0.026826667619076355 0.028633624519339734 0.035637124370474296 0.02371198004027108 0.04773069173273337 0.0931883397659145 0.02477835186436577 0.11551312455151863 0.03255140938504359 0.02399876199245975 0.02068065927712369 0.025605068984379458 0.020851150065248056 0.02079315932751833 0.016713464235307462 0.021209973453588334 0.023465250862139717 0.016641500616100705 0.022738368113496225 0.03229192142345256 0.020964991158943954 0.01997441607572644 0.020285835550748678 0.016296010422792606 0.029009348773535257 0.05158256719247313 0.017204173676101633 0.03255140938504359 0.050421423681374526 0.016864111093478896 0.015204835869136991 0.01847173671569178 0.010402043967278458 0.024927854004288732 0.017796258078622344 0.025016518054020373 0.027524327210544368 0.02422498639647871 0.019796529648499962 0.033695061673749895 0.015578936943864922 0.022090970319827128 0.019071300050307882 0.013944725368054694 0.016534131366384444 0.024902758676110186 0.013487061890850824 0.02399876199245975 0.016864111093478896 0.024695716660106816 0.01521978322787175 0.019452391679403075 0.01071761421458703 0.018751295520966653 0.011804652050756679 0.018500147232217625 0.018010882985740766 0.0152281956638418 0.019318188309949625 0.02617043957917601 0.015830596436245955 0.018928129761107745 0.01720100975249153 0.013375620084307994 0.017510693061620033 0.028750244403287613 0.013294173072279897 0.02068065927712369 0.015204835869136991 0.01521978322787175 0.01931203418106597 0.017022633262181338 0.00948134108482751 0.025262612711423604 0.016098371263525268 0.022847270389948843 0.026134963257091443 0.020344188452962424 0.02425324727007459 0.032943424226975056 0.015647685114910603 0.027458957840935938 0.022283279935779637 0.016562070185158297 0.022571412515189015 0.030840782861172318 0.016285987597671987 0.025605068984379458 0.01847173671569178 0.019452391679403075 0.017022633262181338 0.025122040099215915 0.010951651986171332 0.014426759595958854 0.010406188430738846 0.015246051405915478 0.01636912812780202 0.015597624891021749 0.014754165842570409 0.01949257551110657 0.01184098370382105 0.012942719383273033 0.012602146173577373 0.009214356456215251 0.014167554885994752 0.0315898977595021 0.009224145577920985 0.020851150065248056 0.010402043967278458 0.01071761421458703 0.00948134108482751 0.010951651986171332 0.01946608891959149],
        20,
        :,
    )
    @test testcov ≈ cov_mtx

    corr = cov2cor(cov_mtx)
    testcorr = reshape(
        [1.0 0.7880370103378278 0.8118423738397118 0.7747755888771443 0.7222095128793865 0.5577148442008776 0.5684254724707756 0.4836178736651935 0.7823540050325126 0.7562287727997502 0.5889945020062183 0.3117756583012488 0.29063121009801907 0.6899796025512063 0.4829248204751438 0.46889534799901644 0.8032247282972168 0.683250978585417 0.8070748362260224 0.5235913198639335 0.7880370103378278 1.0 0.6725939497132537 0.6870817775935776 0.6419772970798221 0.5002179842733188 0.57062399192518 0.4071883792308268 0.6616724704905059 0.6475015639050216 0.559317322386344 0.3290854509219013 0.39145545914565044 0.6464231368641967 0.5358162944590256 0.48788180072620496 0.7422899354678594 0.5567944190945463 0.665748475282032 0.4888864809355612 0.8118423738397118 0.6725939497132537 1.0 0.7235308271375829 0.6833090034450882 0.530317933753682 0.5258581241056541 0.4701896404838719 0.6402616698999543 0.6915237605062178 0.5108135706585807 0.2855402307396717 0.2950580605439317 0.5433281730380624 0.5184942908702888 0.4221987742397929 0.7115418362708285 0.5950391891353299 0.6443046480828952 0.4884301040402025 0.7747755888771443 0.6870817775935776 0.7235308271375829 1.0 0.7576008218966399 0.5327716249403196 0.5994094529735697 0.41833749664270453 0.6604057387346127 0.6716337410455928 0.536041363792235 0.350771207897804 0.30335069785035823 0.562928918146957 0.548199461971616 0.4391780258991724 0.7360864919712798 0.5446831579286184 0.6929747243297233 0.4930706471445408 0.7222095128793865 0.6419772970798221 0.6833090034450882 0.7576008218966399 1.0 0.4586019013506314 0.5786499107807346 0.4550523152613802 0.6829598599794166 0.5541378413970237 0.4538066343257688 0.2710224365720845 0.28460569368296407 0.477892920371326 0.5051290344693149 0.37501757322082124 0.7800445569351906 0.5544994546859855 0.6495006703990495 0.5656995145637783 0.5577148442008776 0.5002179842733188 0.530317933753682 0.5327716249403196 0.4586019013506314 1.0 0.4673208569072034 0.4463146326825705 0.5904815466394996 0.5582289845856291 0.5661677030527795 0.4328853137283263 0.5196250469484923 0.5622906173252058 0.5224753114035746 0.40943675181474465 0.5093465044074202 0.5620661960809631 0.6186963081159329 0.42757311673914256 0.5684254724707756 0.57062399192518 0.5258581241056541 0.5994094529735697 0.5786499107807346 0.4673208569072034 1.0 0.39529375214746487 0.5750247978210401 0.5798152542190169 0.539424811844449 0.3466876755222492 0.39618458911698745 0.5251429952595528 0.5121609570322493 0.4009145053464104 0.5977517735470183 0.5250037933290096 0.5794376638957516 0.3894891001523857 0.4836178736651935 0.4071883792308268 0.4701896404838719 0.41833749664270453 0.4550523152613802 0.4463146326825705 0.39529375214746487 1.0 0.4765498512105587 0.5070410398551982 0.490096762633423 0.27210218430665745 0.4823279749355802 0.5478722443132951 0.3931852360313254 0.46508600438409436 0.49382507887417354 0.567452359469588 0.4917776473106598 0.42276066378519034 0.7823540050325126 0.6616724704905059 0.6402616698999543 0.6604057387346127 0.6829598599794166 0.5904815466394996 0.5750247978210401 0.4765498512105587 1.0 0.7125111639857031 0.6474510176448908 0.350074875463064 0.35750622645086655 0.6049807731583691 0.4618381161019484 0.48763587982473167 0.7706072459010869 0.7466598640213862 0.9496984103271222 0.5085284990098963 0.7562287727997502 0.6475015639050216 0.6915237605062178 0.6716337410455928 0.5541378413970237 0.5582289845856291 0.5798152542190169 0.5070410398551982 0.7125111639857031 1.0 0.6660769887573716 0.3981626946696996 0.40933158552360205 0.6354652082204137 0.5592646909728172 0.4818543262464657 0.6472914883513033 0.6601921339331994 0.7498632642238646 0.4817653659558023 0.5889945020062183 0.559317322386344 0.5108135706585807 0.536041363792235 0.4538066343257688 0.5661677030527795 0.539424811844449 0.490096762633423 0.6474510176448908 0.6660769887573716 1.0 0.32655875931912626 0.3932044049638235 0.630402441122833 0.46039334050493097 0.47890637662513413 0.585566235326388 0.6351507160237317 0.689547274888211 0.4358153628530099 0.3117756583012488 0.3290854509219013 0.2855402307396717 0.350771207897804 0.2710224365720845 0.4328853137283263 0.3466876755222492 0.27210218430665745 0.350074875463064 0.3981626946696996 0.32655875931912626 1.0 0.351629230794864 0.3794974255986497 0.3853856901845631 0.3545226194665939 0.2887247999104022 0.3457823701818523 0.3907912290635113 0.27865643358002923 0.29063121009801907 0.39145545914565044 0.2950580605439317 0.30335069785035823 0.28460569368296407 0.5196250469484923 0.39618458911698745 0.4823279749355802 0.35750622645086655 0.40933158552360205 0.3932044049638235 0.351629230794864 1.0 0.3795403239310118 0.5056659866951355 0.4236558755007261 0.29224997080049936 0.38154464583114583 0.3588523335344297 0.41756751227673716 0.6899796025512063 0.6464231368641967 0.5433281730380624 0.562928918146957 0.477892920371326 0.5622906173252058 0.5251429952595528 0.5478722443132951 0.6049807731583691 0.6354652082204137 0.630402441122833 0.3794974255986497 0.3795403239310118 1.0 0.4930159416195486 0.5181201448630268 0.5803777383806147 0.6469214181468704 0.6948496765777495 0.4470859368404759 0.4829248204751438 0.5358162944590256 0.5184942908702888 0.548199461971616 0.5051290344693149 0.5224753114035746 0.5121609570322493 0.3931852360313254 0.4618381161019484 0.5592646909728172 0.46039334050493097 0.3853856901845631 0.5056659866951355 0.4930159416195486 1.0 0.42652705032056765 0.44932683446647737 0.43785942567407055 0.4753164362695061 0.4397187622064721 0.46889534799901644 0.48788180072620496 0.4221987742397929 0.4391780258991724 0.37501757322082124 0.40943675181474465 0.4009145053464104 0.46508600438409436 0.48763587982473167 0.4818543262464657 0.47890637662513413 0.3545226194665939 0.4236558755007261 0.5181201448630268 0.42652705032056765 1.0 0.47790886390032605 0.48725934120100245 0.5190064146136529 0.33202576165886044 0.8032247282972168 0.7422899354678594 0.7115418362708285 0.7360864919712798 0.7800445569351906 0.5093465044074202 0.5977517735470183 0.49382507887417354 0.7706072459010869 0.6472914883513033 0.585566235326388 0.2887247999104022 0.29224997080049936 0.5803777383806147 0.44932683446647737 0.47790886390032605 1.0 0.6969211415673917 0.7809706926931986 0.4888188579782026 0.683250978585417 0.5567944190945463 0.5950391891353299 0.5446831579286184 0.5544994546859855 0.5620661960809631 0.5250037933290096 0.567452359469588 0.7466598640213862 0.6601921339331994 0.6351507160237317 0.3457823701818523 0.38154464583114583 0.6469214181468704 0.43785942567407055 0.48725934120100245 0.6969211415673917 1.0 0.7728323266301629 0.48900850001764096 0.8070748362260224 0.665748475282032 0.6443046480828952 0.6929747243297233 0.6495006703990495 0.6186963081159329 0.5794376638957516 0.4917776473106598 0.9496984103271222 0.7498632642238646 0.689547274888211 0.3907912290635113 0.3588523335344297 0.6948496765777495 0.4753164362695061 0.5190064146136529 0.7809706926931986 0.7728323266301629 1.0 0.49523671133983144 0.5235913198639335 0.4888864809355612 0.4884301040402025 0.4930706471445408 0.5656995145637783 0.42757311673914256 0.3894891001523857 0.42276066378519034 0.5085284990098963 0.4817653659558023 0.4358153628530099 0.27865643358002923 0.41756751227673716 0.4470859368404759 0.4397187622064721 0.33202576165886044 0.4888188579782026 0.48900850001764096 0.49523671133983144 1.0],
        20,
        :,
    )
    @test corr ≈ testcorr
end