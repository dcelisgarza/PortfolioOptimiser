using Test
using PortfolioOptimiser, CSV, DataFrames, Statistics, CovarianceEstimation

@testset "Risk models" begin
    df = CSV.read("./assets/stock_prices.csv", DataFrame)
    dropmissing!(df)
    returns = returns_from_prices(df[!, 2:end])
    cov_mtx = cov(SCov(), Matrix(returns), 1.02^(1 / 252) - 1, SFix())
    testcov = reshape(
        [
            8.938293461392911e-5,
            5.834036619169025e-5,
            7.560774485124341e-5,
            7.419056745809204e-5,
            7.304934435387438e-5,
            4.9716040480557006e-5,
            0.00010295380452296688,
            3.5960029472418234e-5,
            6.350027317253728e-5,
            5.8876605064979846e-5,
            3.289189380408828e-5,
            6.573375900616749e-5,
            8.080462326798134e-5,
            4.224200607318063e-5,
            7.222987338672815e-5,
            5.2323955258683726e-5,
            5.695126649741179e-5,
            4.034999226297612e-5,
            5.413360609410971e-5,
            5.025019598580901e-5,
            5.834036619169025e-5,
            9.871707362686769e-5,
            6.694421220208475e-5,
            7.032289514673311e-5,
            6.274340481715558e-5,
            4.634092737851972e-5,
            0.00010849953355066505,
            3.3780342772746065e-5,
            6.233444439480359e-5,
            5.651138607660492e-5,
            3.163761673011498e-5,
            6.859229128288664e-5,
            9.269752605186652e-5,
            4.2621890518386866e-5,
            8.224511090030269e-5,
            5.860688361668086e-5,
            5.4407743488151e-5,
            3.306035851976872e-5,
            5.16094538117173e-5,
            4.421511396801251e-5,
            7.560774485124341e-5,
            6.694421220208475e-5,
            0.00011707786343944736,
            8.744156285590028e-5,
            8.134342021304265e-5,
            5.476454995030711e-5,
            0.00011805522527743009,
            3.565368628748391e-5,
            6.905376226857181e-5,
            6.393739662016029e-5,
            3.392296959412259e-5,
            7.910932019700649e-5,
            9.60835622724119e-5,
            3.960244934189242e-5,
            7.876546696379315e-5,
            6.072374822314479e-5,
            6.335936021304054e-5,
            4.30563470749534e-5,
            5.6304983818096205e-5,
            5.5728256896583866e-5,
            7.419056745809204e-5,
            7.032289514673311e-5,
            8.744156285590028e-5,
            0.00017826502887821627,
            8.564537254653163e-5,
            6.336219540605627e-5,
            0.0001600545581406182,
            4.205281488291933e-5,
            8.22083433137135e-5,
            7.74652111687155e-5,
            4.109437959092572e-5,
            9.11971008695968e-5,
            0.00013290933864380547,
            5.26152001402516e-5,
            0.00012507057960124636,
            7.079128351721759e-5,
            6.790543237455977e-5,
            4.551845246251183e-5,
            6.789595841593379e-5,
            5.570799988512786e-5,
            7.304934435387438e-5,
            6.274340481715558e-5,
            8.134342021304265e-5,
            8.564537254653163e-5,
            0.00012190071717755785,
            4.949347996087392e-5,
            0.00012044706656976353,
            3.710584905979232e-5,
            6.934823338572008e-5,
            6.070250335286634e-5,
            3.26733288281859e-5,
            7.59177765828025e-5,
            9.326602536250105e-5,
            4.100675324920494e-5,
            8.802062240754717e-5,
            5.66850174421935e-5,
            6.270494062415815e-5,
            3.87017108869403e-5,
            5.621018220474174e-5,
            5.7784469084140605e-5,
            4.9716040480557006e-5,
            4.634092737851972e-5,
            5.476454995030711e-5,
            6.336219540605627e-5,
            4.949347996087392e-5,
            9.68303632287385e-5,
            9.630652376512479e-5,
            3.5432104265057446e-5,
            6.583325659161057e-5,
            6.049793190777282e-5,
            3.71291582219555e-5,
            8.268815173402417e-5,
            0.00012484073767193697,
            4.425486215312168e-5,
            8.901605103558052e-5,
            5.067313567562532e-5,
            4.605897317717845e-5,
            3.6943158850101166e-5,
            5.501458633799524e-5,
            4.07575654605741e-5,
            0.00010295380452296688,
            0.00010849953355066505,
            0.00011805522527743009,
            0.0001600545581406182,
            0.00012044706656976353,
            9.630652376512479e-5,
            0.0006152244991154611,
            6.259463810693614e-5,
            0.00013968930387911645,
            0.00012870346049240493,
            7.258328441624116e-5,
            0.00014319437874541673,
            0.00024222838366824492,
            8.317880443338634e-5,
            0.00020927455748093616,
            0.00012900356118113738,
            0.00010561213627048462,
            7.371600442074941e-5,
            0.00011027758070165732,
            7.952507583057352e-5,
            3.5960029472418234e-5,
            3.3780342772746065e-5,
            3.565368628748391e-5,
            4.205281488291933e-5,
            3.710584905979232e-5,
            3.5432104265057446e-5,
            6.259463810693614e-5,
            8.348886485890103e-5,
            4.0287376319106535e-5,
            3.945835356056557e-5,
            2.824523451123439e-5,
            5.4377660454897225e-5,
            0.00010202931765537859,
            3.160559468302328e-5,
            5.445994077459855e-5,
            5.37767864191542e-5,
            3.1236089209298135e-5,
            2.9973386314138728e-5,
            3.782987739762134e-5,
            3.273804291984804e-5,
            6.350027317253728e-5,
            6.233444439480359e-5,
            6.905376226857181e-5,
            8.22083433137135e-5,
            6.934823338572008e-5,
            6.583325659161057e-5,
            0.00013968930387911645,
            4.0287376319106535e-5,
            0.0001337376088270702,
            7.934881808948368e-5,
            3.8098111841026844e-5,
            9.088776582216165e-5,
            0.000127431850148924,
            5.874989308866122e-5,
            0.00011259436639484648,
            7.532454896720675e-5,
            6.687564052696563e-5,
            4.7226341950022834e-5,
            9.741791438842224e-5,
            5.096687217096947e-5,
            5.8876605064979846e-5,
            5.651138607660492e-5,
            6.393739662016029e-5,
            7.74652111687155e-5,
            6.070250335286634e-5,
            6.049793190777282e-5,
            0.00012870346049240493,
            3.945835356056557e-5,
            7.934881808948368e-5,
            0.00011909824010899873,
            4.0262969613519224e-5,
            9.117728564691512e-5,
            0.00013793322375182948,
            5.05801604236561e-5,
            0.00010592170496263212,
            7.157015010164592e-5,
            5.275062328522496e-5,
            4.2529016299705494e-5,
            6.523433621661175e-5,
            4.829271705607037e-5,
            3.289189380408828e-5,
            3.163761673011498e-5,
            3.392296959412259e-5,
            4.109437959092572e-5,
            3.26733288281859e-5,
            3.71291582219555e-5,
            7.258328441624116e-5,
            2.824523451123439e-5,
            3.8098111841026844e-5,
            4.0262969613519224e-5,
            5.286507182023506e-5,
            4.5097555121596604e-5,
            7.631855126277907e-5,
            3.146733470739157e-5,
            6.136100181177391e-5,
            3.503286384033954e-5,
            2.9450678937094354e-5,
            2.597318012709545e-5,
            3.3318718035086415e-5,
            2.661394402948001e-5,
            6.573375900616749e-5,
            6.859229128288664e-5,
            7.910932019700649e-5,
            9.11971008695968e-5,
            7.59177765828025e-5,
            8.268815173402417e-5,
            0.00014319437874541673,
            5.4377660454897225e-5,
            9.088776582216165e-5,
            9.117728564691512e-5,
            4.5097555121596604e-5,
            0.00039016536486317184,
            0.00019549457699697886,
            5.8596325571475256e-5,
            0.0001461040004731565,
            0.0001013773588448339,
            6.668660691655363e-5,
            5.176206214582958e-5,
            7.516387885579693e-5,
            6.725291160163905e-5,
            8.080462326798134e-5,
            9.269752605186652e-5,
            9.60835622724119e-5,
            0.00013290933864380547,
            9.326602536250105e-5,
            0.00012484073767193697,
            0.00024222838366824492,
            0.00010202931765537859,
            0.000127431850148924,
            0.00013793322375182948,
            7.631855126277907e-5,
            0.00019549457699697886,
            0.0008620896197660137,
            9.083546549647e-5,
            0.00028285332401110534,
            0.00016714592737052258,
            8.042122762388026e-5,
            7.028840906993243e-5,
            9.267060955337942e-5,
            9.059563002448284e-5,
            4.224200607318063e-5,
            4.2621890518386866e-5,
            3.960244934189242e-5,
            5.26152001402516e-5,
            4.100675324920494e-5,
            4.425486215312168e-5,
            8.317880443338634e-5,
            3.160559468302328e-5,
            5.874989308866122e-5,
            5.05801604236561e-5,
            3.146733470739157e-5,
            5.8596325571475256e-5,
            9.083546549647e-5,
            7.249224369444301e-5,
            0.00010100224599188877,
            4.580337359679602e-5,
            4.1455522873168e-5,
            3.295734822464298e-5,
            4.9849557944303365e-5,
            3.34083276212786e-5,
            7.222987338672815e-5,
            8.224511090030269e-5,
            7.876546696379315e-5,
            0.00012507057960124636,
            8.802062240754717e-5,
            8.901605103558052e-5,
            0.00020927455748093616,
            5.445994077459855e-5,
            0.00011259436639484648,
            0.00010592170496263212,
            6.136100181177391e-5,
            0.0001461040004731565,
            0.00028285332401110534,
            0.00010100224599188877,
            0.0004975026974406349,
            0.00011356313643219997,
            7.494996737769502e-5,
            5.6308944490006194e-5,
            8.816634195558426e-5,
            6.467997028496017e-5,
            5.2323955258683726e-5,
            5.860688361668086e-5,
            6.072374822314479e-5,
            7.079128351721759e-5,
            5.66850174421935e-5,
            5.067313567562532e-5,
            0.00012900356118113738,
            5.37767864191542e-5,
            7.532454896720675e-5,
            7.157015010164592e-5,
            3.503286384033954e-5,
            0.0001013773588448339,
            0.00016714592737052258,
            4.580337359679602e-5,
            0.00011356313643219997,
            0.00021304569961177216,
            5.099164856431981e-5,
            4.081273555503288e-5,
            5.9070179888390833e-5,
            4.9177391866550534e-5,
            5.695126649741179e-5,
            5.4407743488151e-5,
            6.335936021304054e-5,
            6.790543237455977e-5,
            6.270494062415815e-5,
            4.605897317717845e-5,
            0.00010561213627048462,
            3.1236089209298135e-5,
            6.687564052696563e-5,
            5.275062328522496e-5,
            2.9450678937094354e-5,
            6.668660691655363e-5,
            8.042122762388026e-5,
            4.1455522873168e-5,
            7.494996737769502e-5,
            5.099164856431981e-5,
            7.495281248005087e-5,
            3.656535557930585e-5,
            5.5119875515835644e-5,
            4.3770078554339014e-5,
            4.034999226297612e-5,
            3.306035851976872e-5,
            4.30563470749534e-5,
            4.551845246251183e-5,
            3.87017108869403e-5,
            3.6943158850101166e-5,
            7.371600442074941e-5,
            2.9973386314138728e-5,
            4.7226341950022834e-5,
            4.2529016299705494e-5,
            2.597318012709545e-5,
            5.176206214582958e-5,
            7.028840906993243e-5,
            3.295734822464298e-5,
            5.6308944490006194e-5,
            4.081273555503288e-5,
            3.656535557930585e-5,
            5.3917893730639495e-5,
            4.020265391290217e-5,
            3.219810189807098e-5,
            5.413360609410971e-5,
            5.16094538117173e-5,
            5.6304983818096205e-5,
            6.789595841593379e-5,
            5.621018220474174e-5,
            5.501458633799524e-5,
            0.00011027758070165732,
            3.782987739762134e-5,
            9.741791438842224e-5,
            6.523433621661175e-5,
            3.3318718035086415e-5,
            7.516387885579693e-5,
            9.267060955337942e-5,
            4.9849557944303365e-5,
            8.816634195558426e-5,
            5.9070179888390833e-5,
            5.5119875515835644e-5,
            4.020265391290217e-5,
            8.559544880637651e-5,
            4.2748331317586605e-5,
            5.025019598580901e-5,
            4.421511396801251e-5,
            5.5728256896583866e-5,
            5.570799988512786e-5,
            5.7784469084140605e-5,
            4.07575654605741e-5,
            7.952507583057352e-5,
            3.273804291984804e-5,
            5.096687217096947e-5,
            4.829271705607037e-5,
            2.661394402948001e-5,
            6.725291160163905e-5,
            9.059563002448284e-5,
            3.34083276212786e-5,
            6.467997028496017e-5,
            4.9177391866550534e-5,
            4.3770078554339014e-5,
            3.219810189807098e-5,
            4.2748331317586605e-5,
            8.030527880717426e-5,
        ],
        20,
        :,
    )
    @test isapprox(cov_mtx, testcov, rtol = 1e-4)

    cov_mtx = cov(ESCov(), Matrix(returns), 1.02^(1 / 252) - 1, SFix())
    testcov = reshape(
        [
            0.00010101383661595715,
            6.429198583461777e-5,
            8.961245756188741e-5,
            8.932536890262258e-5,
            7.579197199157088e-5,
            6.39562597270892e-5,
            0.00011747161096829434,
            4.3911672645936685e-5,
            7.079739408596379e-5,
            6.772699618738404e-5,
            4.189131790403565e-5,
            6.681352727249308e-5,
            8.912632948844919e-5,
            4.812867166039485e-5,
            8.052285573500826e-5,
            5.4015524408478654e-5,
            6.321710410586443e-5,
            4.614228708526764e-5,
            6.075641562322635e-5,
            4.2878040225320936e-5,
            6.429198583461777e-5,
            8.207848436717696e-5,
            6.679604050178869e-5,
            7.16522646455195e-5,
            5.9284655067675075e-5,
            5.0725936808603855e-5,
            0.00010817227659736403,
            3.355168123850768e-5,
            5.574329831069388e-5,
            5.2954769379561574e-5,
            3.496005496838915e-5,
            6.283060925329851e-5,
            0.00010095279188329199,
            4.0092116259959906e-5,
            8.087400646071449e-5,
            5.0275431171335115e-5,
            5.1906200556558266e-5,
            3.228993589168327e-5,
            4.6395055047176045e-5,
            3.5408226456321554e-5,
            8.961245756188741e-5,
            6.679604050178869e-5,
            0.00013059453467568393,
            0.00010073725610336648,
            8.350792669515086e-5,
            7.006377981011334e-5,
            0.0001281633070302593,
            4.666953685707449e-5,
            6.975237661327514e-5,
            7.166811393131378e-5,
            4.2700245244953686e-5,
            7.481508263967575e-5,
            0.00010494263891909826,
            4.3705884821814724e-5,
            9.598311107781988e-5,
            5.6961057382983e-5,
            6.782568277078416e-5,
            4.793288555621469e-5,
            5.805610687781285e-5,
            4.6303339466955163e-5,
            8.932536890262258e-5,
            7.16522646455195e-5,
            0.00010073725610336648,
            0.0001679633903779107,
            9.348170062824605e-5,
            7.85908748445234e-5,
            0.0001627688536378956,
            4.815933017728145e-5,
            7.9847760627704e-5,
            8.102313794487074e-5,
            5.061287069698376e-5,
            9.32936886224308e-5,
            0.0001334869108939619,
            5.129310966547176e-5,
            0.00012556214034461366,
            6.644372636489664e-5,
            7.329578973958264e-5,
            4.787528277271923e-5,
            6.80729503410221e-5,
            4.876817453187844e-5,
            7.579197199157088e-5,
            5.9284655067675075e-5,
            8.350792669515086e-5,
            9.348170062824605e-5,
            0.0001137152590571876,
            5.660427980282316e-5,
            0.00012708103797204158,
            4.2224147860820444e-5,
            6.736991367176792e-5,
            5.594278757990323e-5,
            3.5967014557183024e-5,
            6.697598679480063e-5,
            9.502907598495623e-5,
            3.790182443163952e-5,
            9.05105823681579e-5,
            4.7601978114469905e-5,
            6.495890132529573e-5,
            3.984795294925971e-5,
            5.345255459714989e-5,
            4.9253232882965087e-5,
            6.39562597270892e-5,
            5.0725936808603855e-5,
            7.006377981011334e-5,
            7.85908748445234e-5,
            5.660427980282316e-5,
            0.0001583902022270541,
            0.00011462103296962462,
            4.9925457266125566e-5,
            7.336235512150907e-5,
            7.078421224113945e-5,
            5.4318622957326793e-5,
            0.00011477542082522301,
            0.0001951350381989124,
            5.164230232083673e-5,
            0.00012020936541252882,
            6.0479214084173425e-5,
            4.925610897949824e-5,
            4.707542341487368e-5,
            6.231830347591766e-5,
            4.324183502743575e-5,
            0.00011747161096829434,
            0.00010817227659736403,
            0.0001281633070302593,
            0.0001627688536378956,
            0.00012708103797204158,
            0.00011462103296962462,
            0.0005922999772533054,
            7.392568119177272e-5,
            0.00013217551602086186,
            0.0001311019489172879,
            9.024581984064588e-5,
            0.00015331833095933616,
            0.00025895945191770374,
            8.170244172236787e-5,
            0.0002061161386877181,
            0.00011344980939853587,
            0.00010498952227848169,
            8.019995135999202e-5,
            0.0001067424456130325,
            7.023911187735341e-5,
            4.3911672645936685e-5,
            3.355168123850768e-5,
            4.666953685707449e-5,
            4.815933017728145e-5,
            4.2224147860820444e-5,
            4.9925457266125566e-5,
            7.392568119177272e-5,
            0.00010168435607250449,
            4.280583073125867e-5,
            4.708595087488691e-5,
            3.588914417413659e-5,
            5.881665735941754e-5,
            0.00014077160857490408,
            3.843949405934105e-5,
            6.526232977859153e-5,
            5.830344576397734e-5,
            3.655342358704099e-5,
            3.783165146828459e-5,
            3.8133496662767414e-5,
            3.188256420690292e-5,
            7.079739408596379e-5,
            5.574329831069388e-5,
            6.975237661327514e-5,
            7.9847760627704e-5,
            6.736991367176792e-5,
            7.336235512150907e-5,
            0.00013217551602086186,
            4.280583073125867e-5,
            0.00011919846916963818,
            7.473438154727859e-5,
            4.653373357898765e-5,
            8.659299928616076e-5,
            0.00012694386051179276,
            5.038267261339041e-5,
            9.703704109820622e-5,
            6.501178622230568e-5,
            6.225358104298421e-5,
            4.991070503388798e-5,
            8.948504985125962e-5,
            4.152830230696007e-5,
            6.772699618738404e-5,
            5.2954769379561574e-5,
            7.166811393131378e-5,
            8.102313794487074e-5,
            5.594278757990323e-5,
            7.078421224113945e-5,
            0.0001311019489172879,
            4.708595087488691e-5,
            7.473438154727859e-5,
            0.00011585806958006191,
            5.0734518734613274e-5,
            9.633439390975582e-5,
            0.00014820374748853314,
            4.9262673073368616e-5,
            0.00010798647649302473,
            6.429503728745362e-5,
            5.090704265204292e-5,
            4.53987478818974e-5,
            6.294093432374995e-5,
            4.065062167293832e-5,
            4.189131790403565e-5,
            3.496005496838915e-5,
            4.2700245244953686e-5,
            5.061287069698376e-5,
            3.5967014557183024e-5,
            5.4318622957326793e-5,
            9.024581984064588e-5,
            3.588914417413659e-5,
            4.653373357898765e-5,
            5.0734518734613274e-5,
            7.033191750326774e-5,
            5.558277286007398e-5,
            9.888373669792536e-5,
            3.680739886491993e-5,
            7.284990889024187e-5,
            4.3618243194675106e-5,
            3.3909687831515266e-5,
            3.312185936549931e-5,
            4.1079840189241935e-5,
            2.7554796479000078e-5,
            6.681352727249308e-5,
            6.283060925329851e-5,
            7.481508263967575e-5,
            9.32936886224308e-5,
            6.697598679480063e-5,
            0.00011477542082522301,
            0.00015331833095933616,
            5.881665735941754e-5,
            8.659299928616076e-5,
            9.633439390975582e-5,
            5.558277286007398e-5,
            0.0005191011066843337,
            0.00024361057219155047,
            6.2316793157918e-5,
            0.0001607401793628412,
            0.00010182746143208739,
            5.9552348276615184e-5,
            5.4206185933082396e-5,
            7.510580670898087e-5,
            5.688672682708879e-5,
            8.912632948844919e-5,
            0.00010095279188329199,
            0.00010494263891909826,
            0.0001334869108939619,
            9.502907598495623e-5,
            0.0001951350381989124,
            0.00025895945191770374,
            0.00014077160857490408,
            0.00012694386051179276,
            0.00014820374748853314,
            9.888373669792536e-5,
            0.00024361057219155047,
            0.0010647583942091185,
            9.66861126981156e-5,
            0.0003244830012501045,
            0.00018469606435867657,
            7.767511429690978e-5,
            8.208897876484977e-5,
            9.63317437950153e-5,
            0.00010257255265604836,
            4.812867166039485e-5,
            4.0092116259959906e-5,
            4.3705884821814724e-5,
            5.129310966547176e-5,
            3.790182443163952e-5,
            5.164230232083673e-5,
            8.170244172236787e-5,
            3.843949405934105e-5,
            5.038267261339041e-5,
            4.9262673073368616e-5,
            3.680739886491993e-5,
            6.2316793157918e-5,
            9.66861126981156e-5,
            6.643929557477995e-5,
            8.526830625977066e-5,
            4.660689612129364e-5,
            3.680662141213087e-5,
            3.488431974079059e-5,
            4.568663809952696e-5,
            2.9662885027727348e-5,
            8.052285573500826e-5,
            8.087400646071449e-5,
            9.598311107781988e-5,
            0.00012556214034461366,
            9.05105823681579e-5,
            0.00012020936541252882,
            0.0002061161386877181,
            6.526232977859153e-5,
            9.703704109820622e-5,
            0.00010798647649302473,
            7.284990889024187e-5,
            0.0001607401793628412,
            0.0003244830012501045,
            8.526830625977066e-5,
            0.0004588492862129546,
            0.0001056512888831645,
            6.888312191040896e-5,
            5.855457698521925e-5,
            7.931035105361452e-5,
            6.43301487989116e-5,
            5.4015524408478654e-5,
            5.0275431171335115e-5,
            5.6961057382983e-5,
            6.644372636489664e-5,
            4.7601978114469905e-5,
            6.0479214084173425e-5,
            0.00011344980939853587,
            5.830344576397734e-5,
            6.501178622230568e-5,
            6.429503728745362e-5,
            4.3618243194675106e-5,
            0.00010182746143208739,
            0.00018469606435867657,
            4.660689612129364e-5,
            0.0001056512888831645,
            0.00020069635226754382,
            4.611310872904992e-5,
            4.212493533917928e-5,
            5.365431455776553e-5,
            3.759041669908273e-5,
            6.321710410586443e-5,
            5.1906200556558266e-5,
            6.782568277078416e-5,
            7.329578973958264e-5,
            6.495890132529573e-5,
            4.925610897949824e-5,
            0.00010498952227848169,
            3.655342358704099e-5,
            6.225358104298421e-5,
            5.090704265204292e-5,
            3.3909687831515266e-5,
            5.9552348276615184e-5,
            7.767511429690978e-5,
            3.680662141213087e-5,
            6.888312191040896e-5,
            4.611310872904992e-5,
            7.314486038574258e-5,
            3.884269652419891e-5,
            5.188621703471672e-5,
            3.488304092622789e-5,
            4.614228708526764e-5,
            3.228993589168327e-5,
            4.793288555621469e-5,
            4.787528277271923e-5,
            3.984795294925971e-5,
            4.707542341487368e-5,
            8.019995135999202e-5,
            3.783165146828459e-5,
            4.991070503388798e-5,
            4.53987478818974e-5,
            3.312185936549931e-5,
            5.4206185933082396e-5,
            8.208897876484977e-5,
            3.488431974079059e-5,
            5.855457698521925e-5,
            4.212493533917928e-5,
            3.884269652419891e-5,
            5.5968667166301876e-5,
            4.332546995976646e-5,
            2.785187942159925e-5,
            6.075641562322635e-5,
            4.6395055047176045e-5,
            5.805610687781285e-5,
            6.80729503410221e-5,
            5.345255459714989e-5,
            6.231830347591766e-5,
            0.0001067424456130325,
            3.8133496662767414e-5,
            8.948504985125962e-5,
            6.294093432374995e-5,
            4.1079840189241935e-5,
            7.510580670898087e-5,
            9.63317437950153e-5,
            4.568663809952696e-5,
            7.931035105361452e-5,
            5.365431455776553e-5,
            5.188621703471672e-5,
            4.332546995976646e-5,
            7.829125510202765e-5,
            3.376001706696376e-5,
            4.2878040225320936e-5,
            3.5408226456321554e-5,
            4.6303339466955163e-5,
            4.876817453187844e-5,
            4.9253232882965087e-5,
            4.324183502743575e-5,
            7.023911187735341e-5,
            3.188256420690292e-5,
            4.152830230696007e-5,
            4.065062167293832e-5,
            2.7554796479000078e-5,
            5.688672682708879e-5,
            0.00010257255265604836,
            2.9662885027727348e-5,
            6.43301487989116e-5,
            3.759041669908273e-5,
            3.488304092622789e-5,
            2.785187942159925e-5,
            3.376001706696376e-5,
            7.687785486897382e-5,
        ],
        20,
        :,
    )
    @test testcov ≈ cov_mtx

    corr = cov2cor(cov_mtx)
    testcorr = reshape(
        [
            1.0,
            0.7060764766986498,
            0.7802170800210225,
            0.6857677683624881,
            0.7071693041682604,
            0.5056249170088101,
            0.48025471064060943,
            0.4332738473964804,
            0.6451957534520906,
            0.6260488715697323,
            0.49700111299657324,
            0.29177494065196796,
            0.27176282707743143,
            0.5874906141423389,
            0.37401903491820027,
            0.3793660162559332,
            0.7354484832576732,
            0.613671849018051,
            0.6831956358497162,
            0.48656836125060293,
            0.7060764766986498,
            1.0,
            0.6451690927856881,
            0.6102502147772959,
            0.613646498833498,
            0.44488857765149803,
            0.4906032804793118,
            0.3672590881071707,
            0.5635632423175913,
            0.5430343134729416,
            0.4601307034050314,
            0.30439017439018967,
            0.34149011242832805,
            0.5429149581637716,
            0.41673431608381967,
            0.3917160803694453,
            0.6699041506533909,
            0.47640908659563475,
            0.5787625247405408,
            0.4457474646752909,
            0.7802170800210225,
            0.6451690927856881,
            1.0,
            0.6801744278511367,
            0.6852607032801276,
            0.487154709287827,
            0.46081896691375457,
            0.40498964446409863,
            0.559063539088796,
            0.5826400446923826,
            0.44554506660629145,
            0.2873430395458071,
            0.2814258221236632,
            0.4692074575918505,
            0.39210040523286727,
            0.3518404779193765,
            0.6939685123370977,
            0.5606587323478708,
            0.5741545102421428,
            0.46211406250108866,
            0.6857677683624881,
            0.6102502147772959,
            0.6801744278511367,
            1.0,
            0.6764098383919299,
            0.4818375593790509,
            0.5160516020568128,
            0.3685072616875882,
            0.5643130393808047,
            0.5808160363641892,
            0.4656691049796633,
            0.31595044462615096,
            0.31565002670069925,
            0.48555586394190225,
            0.4522893521982937,
            0.3618902855899792,
            0.661271498800123,
            0.49377779223161006,
            0.5936228775835727,
            0.4291692083700568,
            0.7071693041682604,
            0.613646498833498,
            0.6852607032801276,
            0.6764098383919299,
            1.0,
            0.4217700526762243,
            0.48966664615829075,
            0.39266704102844957,
            0.5786570908776911,
            0.4873843575582997,
            0.40217844364871996,
            0.2756663596284061,
            0.2730999355128651,
            0.4360519504540299,
            0.3962369358223998,
            0.31509817531646706,
            0.7122580899386203,
            0.49948696727983255,
            0.5665033280387561,
            0.5267744970430387,
            0.5056249170088101,
            0.44488857765149803,
            0.487154709287827,
            0.4818375593790509,
            0.4217700526762243,
            1.0,
            0.3742219895696067,
            0.3933968002737563,
            0.533917024795208,
            0.5225274406845273,
            0.5146457205969963,
            0.40027527056437767,
            0.4751662267104065,
            0.5034182197720928,
            0.44590168925445517,
            0.33921280860256464,
            0.45761898885713226,
            0.49998571444732354,
            0.5596220750081287,
            0.39186757610257245,
            0.48025471064060943,
            0.4906032804793118,
            0.46081896691375457,
            0.5160516020568128,
            0.48966664615829075,
            0.3742219895696067,
            1.0,
            0.3012294339389864,
            0.49744471098461746,
            0.5004666539945809,
            0.4421605661609421,
            0.27650134452849157,
            0.3260884173403665,
            0.41186194707125706,
            0.39537218219129006,
            0.3290509682386413,
            0.5044094262943892,
            0.4404846355946707,
            0.49568943570971974,
            0.3291603574564033,
            0.4332738473964804,
            0.3672590881071707,
            0.40498964446409863,
            0.3685072616875882,
            0.39266704102844957,
            0.3933968002737563,
            0.3012294339389864,
            1.0,
            0.3888127692794371,
            0.433811569075678,
            0.4243847815752191,
            0.25600431795108025,
            0.427821361591014,
            0.4676684602299536,
            0.3021346062540574,
            0.4081289591585959,
            0.42384696736465455,
            0.501482458414641,
            0.4273885970691184,
            0.3605998512662999,
            0.6451957534520906,
            0.5635632423175913,
            0.559063539088796,
            0.5643130393808047,
            0.5786570908776911,
            0.533917024795208,
            0.49744471098461746,
            0.3888127692794371,
            1.0,
            0.6359485214635682,
            0.5082253587051817,
            0.3481139811699353,
            0.35632871880338385,
            0.5661524003095018,
            0.4149226817125767,
            0.4203267405998086,
            0.6667101885802056,
            0.6110628529291705,
            0.9263146182006387,
            0.43381864152536165,
            0.6260488715697323,
            0.5430343134729416,
            0.5826400446923826,
            0.5808160363641892,
            0.4873843575582997,
            0.5225274406845273,
            0.5004666539945809,
            0.433811569075678,
            0.6359485214635682,
            1.0,
            0.5620360488556739,
            0.3928187849365144,
            0.4219592435186319,
            0.561490380206681,
            0.4683507246255645,
            0.4216426837606845,
            0.5529970526163556,
            0.5637781609026902,
            0.6608660072521264,
            0.4307283122194625,
            0.49700111299657324,
            0.4601307034050314,
            0.44554506660629145,
            0.4656691049796633,
            0.40217844364871996,
            0.5146457205969963,
            0.4421605661609421,
            0.4243847815752191,
            0.5082253587051817,
            0.5620360488556739,
            1.0,
            0.2908961693204603,
            0.36134587740435137,
            0.5384512492021234,
            0.4055251127545145,
            0.3671319669042538,
            0.472776253830234,
            0.5279174255096107,
            0.5535997543230845,
            0.37473162840039764,
            0.29177494065196796,
            0.30439017439018967,
            0.2873430395458071,
            0.31595044462615096,
            0.2756663596284061,
            0.40027527056437767,
            0.27650134452849157,
            0.25600431795108025,
            0.3481139811699353,
            0.3928187849365144,
            0.2908961693204603,
            1.0,
            0.32767598844525153,
            0.3355572366949198,
            0.32935437818550345,
            0.3154780879388195,
            0.30561946158894837,
            0.31801703976509227,
            0.37255544074412783,
            0.28476351179102655,
            0.27176282707743143,
            0.34149011242832805,
            0.2814258221236632,
            0.31565002670069925,
            0.2730999355128651,
            0.4751662267104065,
            0.3260884173403665,
            0.427821361591014,
            0.35632871880338385,
            0.4219592435186319,
            0.36134587740435137,
            0.32767598844525153,
            1.0,
            0.36351811167387094,
            0.46422805588421545,
            0.39954193208837746,
            0.2783328438709974,
            0.3362690013621876,
            0.33364702591348355,
            0.3585130749810868,
            0.5874906141423389,
            0.5429149581637716,
            0.4692074575918505,
            0.48555586394190225,
            0.4360519504540299,
            0.5034182197720928,
            0.41186194707125706,
            0.4676684602299536,
            0.5661524003095018,
            0.561490380206681,
            0.5384512492021234,
            0.3355572366949198,
            0.36351811167387094,
            1.0,
            0.4883600129486198,
            0.4036155892283997,
            0.5279849421636698,
            0.5720648536001866,
            0.6334612653045898,
            0.41504983976636695,
            0.37401903491820027,
            0.41673431608381967,
            0.39210040523286727,
            0.4522893521982937,
            0.3962369358223998,
            0.44590168925445517,
            0.39537218219129006,
            0.3021346062540574,
            0.4149226817125767,
            0.4683507246255645,
            0.4055251127545145,
            0.32935437818550345,
            0.46422805588421545,
            0.4883600129486198,
            1.0,
            0.34815291020227607,
            0.3759983023290646,
            0.365387204944269,
            0.4184448376078186,
            0.3425144493359845,
            0.3793660162559332,
            0.3917160803694453,
            0.3518404779193765,
            0.3618902855899792,
            0.31509817531646706,
            0.33921280860256464,
            0.3290509682386413,
            0.4081289591585959,
            0.4203267405998086,
            0.4216426837606845,
            0.3671319669042538,
            0.3154780879388195,
            0.39954193208837746,
            0.4036155892283997,
            0.34815291020227607,
            1.0,
            0.380594715698566,
            0.3974632920373744,
            0.4280340159206031,
            0.30262637251140656,
            0.7354484832576732,
            0.6699041506533909,
            0.6939685123370977,
            0.661271498800123,
            0.7122580899386203,
            0.45761898885713226,
            0.5044094262943892,
            0.42384696736465455,
            0.6667101885802056,
            0.5529970526163556,
            0.472776253830234,
            0.30561946158894837,
            0.2783328438709974,
            0.5279849421636698,
            0.3759983023290646,
            0.380594715698566,
            1.0,
            0.6070786807546993,
            0.6856515665335942,
            0.4651808217235312,
            0.613671849018051,
            0.47640908659563475,
            0.5606587323478708,
            0.49377779223161006,
            0.49948696727983255,
            0.49998571444732354,
            0.4404846355946707,
            0.501482458414641,
            0.6110628529291705,
            0.5637781609026902,
            0.5279174255096107,
            0.31801703976509227,
            0.3362690013621876,
            0.5720648536001866,
            0.365387204944269,
            0.3974632920373744,
            0.6070786807546993,
            1.0,
            0.6545068138625633,
            0.42460137440133766,
            0.6831956358497162,
            0.5787625247405408,
            0.5741545102421428,
            0.5936228775835727,
            0.5665033280387561,
            0.5596220750081287,
            0.49568943570971974,
            0.4273885970691184,
            0.9263146182006387,
            0.6608660072521264,
            0.5535997543230845,
            0.37255544074412783,
            0.33364702591348355,
            0.6334612653045898,
            0.4184448376078186,
            0.4280340159206031,
            0.6856515665335942,
            0.6545068138625633,
            1.0,
            0.43515642630818,
            0.48656836125060293,
            0.4457474646752909,
            0.46211406250108866,
            0.4291692083700568,
            0.5267744970430387,
            0.39186757610257245,
            0.3291603574564033,
            0.3605998512662999,
            0.43381864152536165,
            0.4307283122194625,
            0.37473162840039764,
            0.28476351179102655,
            0.3585130749810868,
            0.41504983976636695,
            0.3425144493359845,
            0.30262637251140656,
            0.4651808217235312,
            0.42460137440133766,
            0.43515642630818,
            1.0,
        ],
        20,
        :,
    )
    @test corr ≈ testcorr

    target = DiagonalUnequalVariance()
    shrinkage = :lw
    method = LinearShrinkage(target, shrinkage)

    S = cov(CustomCov(), Matrix(returns), estimator = method)
    @test S ≈ reshape(
        [
            0.00020974121242454973,
            9.49008624680715e-5,
            0.00013627083908001957,
            0.0001144459547397155,
            0.0001533297916973707,
            6.004389201327861e-5,
            7.961546367020424e-5,
            4.0442259746852624e-5,
            8.767444632653712e-5,
            6.936488480148472e-5,
            3.901767715385311e-5,
            9.902948471459637e-5,
            3.4697483118863474e-5,
            5.1614741135447295e-5,
            2.3708248933296083e-5,
            4.848282867690341e-5,
            9.537506846211535e-5,
            5.704974283283712e-5,
            7.639318238397722e-5,
            8.042702778684457e-5,
            9.49008624680715e-5,
            0.00021128710779431077,
            0.00010565882591881539,
            9.157370104574008e-5,
            0.00010384591220711557,
            5.632434038768978e-5,
            0.00012607059772931867,
            4.404376034146089e-5,
            9.13075030181906e-5,
            7.345225768503703e-5,
            4.045340435016579e-5,
            8.842180681807285e-5,
            6.916329902458289e-5,
            5.704136443834894e-5,
            5.2407798446956977e-5,
            7.19538019030919e-5,
            8.962282312169892e-5,
            4.933169661435874e-5,
            8.295319160446617e-5,
            6.933679954682294e-5,
            0.00013627083908001957,
            0.00010565882591881539,
            0.00025695402208570267,
            0.00011552189995091371,
            0.00014843800500914878,
            6.49059538712931e-5,
            0.00011333669525723465,
            3.7409158394579354e-5,
            9.144575183749768e-5,
            7.368953211094036e-5,
            3.775027845529568e-5,
            0.0001335160664834638,
            5.6486519836896674e-5,
            5.079768913754806e-5,
            4.200300265088935e-5,
            5.4650867481938984e-5,
            9.841786413799734e-5,
            5.251140126071027e-5,
            7.873571110786375e-5,
            8.521347256388682e-5,
            0.0001144459547397155,
            9.157370104574008e-5,
            0.00011552189995091371,
            0.00040018011445070676,
            0.0001283550863420235,
            6.303275874494474e-5,
            0.00019425155008270372,
            3.3542960288176314e-5,
            9.474093184249297e-5,
            7.895546665187315e-5,
            2.7671895800209916e-5,
            0.00010737944686883479,
            9.72432887970993e-5,
            5.452327837798487e-5,
            9.330647822482713e-5,
            7.541564040096912e-5,
            9.770739350226442e-5,
            5.056000087263938e-5,
            8.177558684652749e-5,
            6.694289577621923e-5,
            0.0001533297916973707,
            0.00010384591220711557,
            0.00014843800500914878,
            0.0001283550863420235,
            0.00033073451389470566,
            4.9995123854767376e-5,
            0.00011690564009658017,
            3.563142441407921e-5,
            8.532862818846711e-5,
            6.385203881581612e-5,
            3.6096282011548155e-5,
            0.0001153699321019999,
            1.8824086305519566e-5,
            4.957384283732209e-5,
            7.502022727023815e-5,
            5.528202772990175e-5,
            0.00010114741040580599,
            4.496496646957196e-5,
            7.283196479315237e-5,
            9.667678490392272e-5,
            6.004389201327861e-5,
            5.632434038768978e-5,
            6.49059538712931e-5,
            6.303275874494474e-5,
            4.9995123854767376e-5,
            0.00017888762723415692,
            9.154124774155937e-5,
            3.7062681541743254e-5,
            9.643612257656866e-5,
            8.402541421043027e-5,
            5.108533353282806e-5,
            0.00010331176445944505,
            0.00011148655303785889,
            6.724430755733523e-5,
            9.746508511337509e-5,
            4.618243811492365e-5,
            6.264119578688972e-5,
            5.43721900204529e-5,
            8.836923287870663e-5,
            5.945205241805555e-5,
            7.961546367020424e-5,
            0.00012607059772931867,
            0.00011333669525723465,
            0.00019425155008270372,
            0.00011690564009658017,
            9.154124774155937e-5,
            0.0016463440752944537,
            4.372840616878824e-5,
            0.00016235742285935177,
            0.00013414664999679478,
            6.241061504616288e-5,
            0.00010243810242790471,
            0.00013553281028729072,
            8.681568799122882e-5,
            0.00023311588527425995,
            0.00011617212585528833,
            0.00012640883431507194,
            7.177917209104049e-5,
            0.00012199186404940184,
            5.184131606994349e-5,
            4.0442259746852624e-5,
            4.404376034146089e-5,
            3.7409158394579354e-5,
            3.3542960288176314e-5,
            3.563142441407921e-5,
            3.7062681541743254e-5,
            4.372840616878824e-5,
            0.00016335269313907323,
            4.0082107804884025e-5,
            4.823133687332912e-5,
            4.10359085389425e-5,
            6.201599033515617e-5,
            0.00010813001045739069,
            3.340472380312064e-5,
            2.01925622514143e-5,
            5.59090146708832e-5,
            4.454236725911218e-5,
            4.3077149810314024e-5,
            4.5728095260189236e-5,
            4.720710226853981e-5,
            8.767444632653712e-5,
            9.13075030181906e-5,
            9.144575183749768e-5,
            9.474093184249297e-5,
            8.532862818846711e-5,
            9.643612257656866e-5,
            0.00016235742285935177,
            4.0082107804884025e-5,
            0.0002758911957869663,
            0.00012181517762307684,
            4.525127964248753e-5,
            0.00013720366006737543,
            0.0001437022613663156,
            8.84812980613113e-5,
            0.00013103207773697344,
            0.00011465568009137958,
            0.00010633935614169838,
            7.508811686696417e-5,
            0.00019474421896521134,
            7.539272290702069e-5,
            6.936488480148472e-5,
            7.345225768503703e-5,
            7.368953211094036e-5,
            7.895546665187315e-5,
            6.385203881581612e-5,
            8.402541421043027e-5,
            0.00013414664999679478,
            4.823133687332912e-5,
            0.00012181517762307684,
            0.00024305024441962947,
            4.612908083611098e-5,
            0.0001240814100509709,
            0.00014108243178014539,
            6.355293716502739e-5,
            0.00010076062369463408,
            9.685789365375437e-5,
            7.445377850636692e-5,
            5.8290930095034146e-5,
            0.00010471649261408032,
            6.767056033674793e-5,
            3.901767715385311e-5,
            4.045340435016579e-5,
            3.775027845529568e-5,
            2.7671895800209916e-5,
            3.6096282011548155e-5,
            5.108533353282806e-5,
            6.241061504616288e-5,
            4.10359085389425e-5,
            4.525127964248753e-5,
            4.612908083611098e-5,
            0.00010523207922672086,
            4.731358656921942e-5,
            5.701123230766518e-5,
            4.697951000804454e-5,
            6.0556746895336595e-5,
            3.901929627154954e-5,
            4.1285411292385114e-5,
            3.608151628552984e-5,
            4.9765320097742016e-5,
            3.492850745006677e-5,
            9.902948471459637e-5,
            8.842180681807285e-5,
            0.0001335160664834638,
            0.00010737944686883479,
            0.0001153699321019999,
            0.00010331176445944505,
            0.00010243810242790471,
            6.201599033515617e-5,
            0.00013720366006737543,
            0.0001240814100509709,
            4.731358656921942e-5,
            0.0007058986609157662,
            0.00022283328315699695,
            7.327999383409479e-5,
            0.00012635433132773306,
            0.0001331405807292034,
            9.002829634053937e-5,
            6.61123739197003e-5,
            0.00011793197889290184,
            0.00010465762246698121,
            3.4697483118863474e-5,
            6.916329902458289e-5,
            5.6486519836896674e-5,
            9.72432887970993e-5,
            1.8824086305519566e-5,
            0.00011148655303785889,
            0.00013553281028729072,
            0.00010813001045739069,
            0.0001437022613663156,
            0.00014108243178014539,
            5.701123230766518e-5,
            0.00022283328315699695,
            0.0019417957296906068,
            7.581686187085495e-5,
            0.0002145636857368257,
            0.0002263853640615547,
            5.7734148886710245e-5,
            5.407877773195144e-5,
            9.705731056801937e-5,
            9.166588050837616e-5,
            5.1614741135447295e-5,
            5.704136443834894e-5,
            5.079768913754806e-5,
            5.452327837798487e-5,
            4.957384283732209e-5,
            6.724430755733523e-5,
            8.681568799122882e-5,
            3.340472380312064e-5,
            8.84812980613113e-5,
            6.355293716502739e-5,
            4.697951000804454e-5,
            7.327999383409479e-5,
            7.581686187085495e-5,
            0.0001434747310088838,
            0.0001495940537538927,
            4.5784397359999926e-5,
            6.237914744437197e-5,
            4.96086276930652e-5,
            8.493524534319953e-5,
            3.887601366868808e-5,
            2.3708248933296083e-5,
            5.2407798446956977e-5,
            4.200300265088935e-5,
            9.330647822482713e-5,
            7.502022727023815e-5,
            9.746508511337509e-5,
            0.00023311588527425995,
            2.01925622514143e-5,
            0.00013103207773697344,
            0.00010076062369463408,
            6.0556746895336595e-5,
            0.00012635433132773306,
            0.0002145636857368257,
            0.0001495940537538927,
            0.0009925919307124014,
            0.00011083776734381046,
            6.489243684886534e-5,
            3.643156313591144e-5,
            0.00011264104838001386,
            3.401732319536111e-5,
            4.848282867690341e-5,
            7.19538019030919e-5,
            5.4650867481938984e-5,
            7.541564040096912e-5,
            5.528202772990175e-5,
            4.618243811492365e-5,
            0.00011617212585528833,
            5.59090146708832e-5,
            0.00011465568009137958,
            9.685789365375437e-5,
            3.901929627154954e-5,
            0.0001331405807292034,
            0.0002263853640615547,
            4.5784397359999926e-5,
            0.00011083776734381046,
            0.0005048938009079832,
            7.240045222813512e-5,
            4.7730279259747514e-5,
            8.960889678249462e-5,
            7.393006141949372e-5,
            9.537506846211535e-5,
            8.962282312169892e-5,
            9.841786413799734e-5,
            9.770739350226442e-5,
            0.00010114741040580599,
            6.264119578688972e-5,
            0.00012640883431507194,
            4.454236725911218e-5,
            0.00010633935614169838,
            7.445377850636692e-5,
            4.1285411292385114e-5,
            9.002829634053937e-5,
            5.7734148886710245e-5,
            6.237914744437197e-5,
            6.489243684886534e-5,
            7.240045222813512e-5,
            0.00016225723157954709,
            5.93182304556114e-5,
            9.523383788220371e-5,
            7.488433704942905e-5,
            5.704974283283712e-5,
            4.933169661435874e-5,
            5.251140126071027e-5,
            5.056000087263938e-5,
            4.496496646957196e-5,
            5.43721900204529e-5,
            7.177917209104049e-5,
            4.3077149810314024e-5,
            7.508811686696417e-5,
            5.8290930095034146e-5,
            3.608151628552984e-5,
            6.61123739197003e-5,
            5.407877773195144e-5,
            4.96086276930652e-5,
            3.643156313591144e-5,
            4.7730279259747514e-5,
            5.93182304556114e-5,
            0.00012188927616787187,
            7.004158189487723e-5,
            4.315404894110594e-5,
            7.639318238397722e-5,
            8.295319160446617e-5,
            7.873571110786375e-5,
            8.177558684652749e-5,
            7.283196479315237e-5,
            8.836923287870663e-5,
            0.00012199186404940184,
            4.5728095260189236e-5,
            0.00019474421896521134,
            0.00010471649261408032,
            4.9765320097742016e-5,
            0.00011793197889290184,
            9.705731056801937e-5,
            8.493524534319953e-5,
            0.00011264104838001386,
            8.960889678249462e-5,
            9.523383788220371e-5,
            7.004158189487723e-5,
            0.00018469455212296522,
            6.863084912268206e-5,
            8.042702778684457e-5,
            6.933679954682294e-5,
            8.521347256388682e-5,
            6.694289577621923e-5,
            9.667678490392272e-5,
            5.945205241805555e-5,
            5.184131606994349e-5,
            4.720710226853981e-5,
            7.539272290702069e-5,
            6.767056033674793e-5,
            3.492850745006677e-5,
            0.00010465762246698121,
            9.166588050837616e-5,
            3.887601366868808e-5,
            3.401732319536111e-5,
            7.393006141949372e-5,
            7.488433704942905e-5,
            4.315404894110594e-5,
            6.863084912268206e-5,
            0.000157715441028482,
        ],
        20,
        :,
    )

    S = cov(CustomCov(), Matrix(returns))
    @test S ≈ cov(Matrix(returns))

    target = DiagonalCommonVariance()
    shrinkage = :oas
    method = LinearShrinkage(target, shrinkage)

    S = Matrix(cov(CustomSCov(), Matrix(returns), estimator = method))

    @test S ≈ reshape(
        [
            9.01474993935186e-5,
            5.794370050912216e-5,
            7.509367543967492e-5,
            7.368613366718673e-5,
            7.255266992533079e-5,
            4.937801299771594e-5,
            0.00010225380478333718,
            3.571553135615723e-5,
            6.30685244392763e-5,
            5.847629340669069e-5,
            3.2668256443570405e-5,
            6.528682443777148e-5,
            8.025521943088618e-5,
            4.1954795771534454e-5,
            7.173877067519195e-5,
            5.196819613713223e-5,
            5.656404553064434e-5,
            4.0075646072381065e-5,
            5.376554286083074e-5,
            4.990853669240659e-5,
            5.794370050912216e-5,
            9.94181740701075e-5,
            6.648904756462134e-5,
            6.984475829185138e-5,
            6.23168021555153e-5,
            4.602584784115376e-5,
            0.00010776182749320249,
            3.35506647025175e-5,
            6.191062232189913e-5,
            5.612715592869511e-5,
            3.142250740437224e-5,
            6.812592108645632e-5,
            9.206726042544037e-5,
            4.2332097320324516e-5,
            8.168591295241933e-5,
            5.8208405838591244e-5,
            5.403781634993583e-5,
            3.2835575740121756e-5,
            5.125855270225345e-5,
            4.3914488183383035e-5,
            7.509367543967492e-5,
            6.648904756462134e-5,
            0.00011765412587259369,
            8.684703338206923e-5,
            8.079035300747846e-5,
            5.439219682665347e-5,
            0.00011725254851051477,
            3.541127104859383e-5,
            6.858425445550534e-5,
            6.350267581315282e-5,
            3.369232178083023e-5,
            7.857144300250384e-5,
            9.543027443244306e-5,
            3.933318581776652e-5,
            7.822992768360883e-5,
            6.031087753669961e-5,
            6.292856957001637e-5,
            4.276359993577265e-5,
            5.592215703286818e-5,
            5.534935137193253e-5,
            7.368613366718673e-5,
            6.984475829185138e-5,
            8.684703338206923e-5,
            0.00017842526977554588,
            8.506305566411193e-5,
            6.293138548609152e-5,
            0.0001589663210468643,
            4.176689092308963e-5,
            8.16493953546592e-5,
            7.693851254014404e-5,
            4.081497218925485e-5,
            9.057703687915476e-5,
            0.00013200566633294624,
            5.2257460797160836e-5,
            0.00012422020429397272,
            7.030996201327016e-5,
            6.744373224408009e-5,
            4.520896506649241e-5,
            6.743432270044684e-5,
            5.5329232091207416e-5,
            7.255266992533079e-5,
            6.23168021555153e-5,
            8.079035300747846e-5,
            8.506305566411193e-5,
            0.00012244418824008322,
            4.9156965703372624e-5,
            0.00011962812728307415,
            3.6853560328929544e-5,
            6.887672341541146e-5,
            6.0289777113765595e-5,
            3.245117752665276e-5,
            7.540159921483187e-5,
            9.263189441636896e-5,
            4.072794163334961e-5,
            8.7422155813206e-5,
            5.6299606746257645e-5,
            6.227859948685113e-5,
            3.843857163075051e-5,
            5.582799999117352e-5,
            5.739158303684047e-5,
            4.937801299771594e-5,
            4.602584784115376e-5,
            5.439219682665347e-5,
            6.293138548609152e-5,
            4.9156965703372624e-5,
            9.754429172426417e-5,
            9.565171997353504e-5,
            3.51911955985444e-5,
            6.53856455228732e-5,
            6.008659658335429e-5,
            3.6876711008290456e-5,
            8.212594147911935e-5,
            0.00012399192509749692,
            4.3953966114086786e-5,
            8.841081635934406e-5,
            5.032860074616338e-5,
            4.574581069249879e-5,
            3.66919762765577e-5,
            5.46405331760857e-5,
            4.048044811321101e-5,
            0.00010225380478333718,
            0.00010776182749320249,
            0.00011725254851051477,
            0.0001589663210468643,
            0.00011962812728307415,
            9.565171997353504e-5,
            0.0006124137811753583,
            6.216904693446717e-5,
            0.00013873953347677429,
            0.00012782838463433864,
            7.208977880536786e-5,
            0.00014222077676632845,
            0.00024058143330750453,
            8.261325815060578e-5,
            0.00020785166556910693,
            0.00012812644488945186,
            0.00010489406209893145,
            7.321479726147871e-5,
            0.0001095277854110818,
            7.898437184558368e-5,
            3.571553135615723e-5,
            3.35506647025175e-5,
            3.541127104859383e-5,
            4.176689092308963e-5,
            3.6853560328929544e-5,
            3.51911955985444e-5,
            6.216904693446717e-5,
            8.429350438184747e-5,
            4.0013455864545315e-5,
            3.91900697672022e-5,
            2.805319054651395e-5,
            5.400793785614072e-5,
            0.00010133560365302301,
            3.139070308041113e-5,
            5.408965873850377e-5,
            5.3411149261149685e-5,
            3.1023709934779134e-5,
            2.9769592362929893e-5,
            3.757266587978325e-5,
            3.251545161663139e-5,
            6.30685244392763e-5,
            6.191062232189913e-5,
            6.858425445550534e-5,
            8.16493953546592e-5,
            6.887672341541146e-5,
            6.53856455228732e-5,
            0.00013873953347677429,
            4.0013455864545315e-5,
            0.00013420059892911942,
            7.880931250967607e-5,
            3.7839076553378465e-5,
            9.026980505125255e-5,
            0.00012656542017736448,
            5.8350442965803824e-5,
            0.0001118288188997796,
            7.48124050507281e-5,
            6.642094211952598e-5,
            4.6905242334308245e-5,
            9.675555407038318e-5,
            5.0620340079079074e-5,
            5.847629340669069e-5,
            5.612715592869511e-5,
            6.350267581315282e-5,
            7.693851254014404e-5,
            6.0289777113765595e-5,
            6.008659658335429e-5,
            0.00012782838463433864,
            3.91900697672022e-5,
            7.880931250967607e-5,
            0.00011966076567103871,
            3.998921510413735e-5,
            9.05573563834099e-5,
            0.00013699539322521668,
            5.0236257648124486e-5,
            0.00010520152598295745,
            7.108353295652396e-5,
            5.239196317804335e-5,
            4.223985456863163e-5,
            6.479079730536775e-5,
            4.79643669817638e-5,
            3.2668256443570405e-5,
            3.142250740437224e-5,
            3.369232178083023e-5,
            4.081497218925485e-5,
            3.245117752665276e-5,
            3.6876711008290456e-5,
            7.208977880536786e-5,
            2.805319054651395e-5,
            3.7839076553378465e-5,
            3.998921510413735e-5,
            5.387792751598702e-5,
            4.4790929475372804e-5,
            7.57996489622726e-5,
            3.125338315694546e-5,
            6.0943798334052236e-5,
            3.4794669674710134e-5,
            2.9250438958752562e-5,
            2.579658423138704e-5,
            3.309217862687879e-5,
            2.64329914752983e-5,
            6.528682443777148e-5,
            6.812592108645632e-5,
            7.857144300250384e-5,
            9.057703687915476e-5,
            7.540159921483187e-5,
            8.212594147911935e-5,
            0.00014222077676632845,
            5.400793785614072e-5,
            9.026980505125255e-5,
            9.05573563834099e-5,
            4.4790929475372804e-5,
            0.00038888486075157054,
            0.0001941653774241124,
            5.819791957926018e-5,
            0.00014511061550050836,
            0.00010068807761696145,
            6.623319377951931e-5,
            5.1410123427365866e-5,
            7.46528273616593e-5,
            6.679564806651651e-5,
            8.025521943088618e-5,
            9.206726042544037e-5,
            9.543027443244306e-5,
            0.00013200566633294624,
            9.263189441636896e-5,
            0.00012399192509749692,
            0.00024058143330750453,
            0.00010133560365302301,
            0.00012656542017736448,
            0.00013699539322521668,
            7.57996489622726e-5,
            0.0001941653774241124,
            0.0008576004255327837,
            9.021786032402116e-5,
            0.0002809301580428482,
            0.000166009474898643,
            7.987443055641629e-5,
            6.98105066915219e-5,
            9.204052693662463e-5,
            8.997965553259721e-5,
            4.1954795771534454e-5,
            4.2332097320324516e-5,
            3.933318581776652e-5,
            5.2257460797160836e-5,
            4.072794163334961e-5,
            4.3953966114086786e-5,
            8.261325815060578e-5,
            3.139070308041113e-5,
            5.8350442965803824e-5,
            5.0236257648124486e-5,
            3.125338315694546e-5,
            5.819791957926018e-5,
            9.021786032402116e-5,
            7.337165104153732e-5,
            0.00010031551521759704,
            4.549194897542842e-5,
            4.117365999931027e-5,
            3.273326582882448e-5,
            4.95106226544095e-5,
            3.318117894285223e-5,
            7.173877067519195e-5,
            8.168591295241933e-5,
            7.822992768360883e-5,
            0.00012422020429397272,
            8.7422155813206e-5,
            8.841081635934406e-5,
            0.00020785166556910693,
            5.408965873850377e-5,
            0.0001118288188997796,
            0.00010520152598295745,
            6.0943798334052236e-5,
            0.00014511061550050836,
            0.0002809301580428482,
            0.00010031551521759704,
            0.0004954923892658918,
            0.00011279100211135184,
            7.444037030265018e-5,
            5.592609077552268e-5,
            8.756688459022536e-5,
            6.4240200598269e-5,
            5.196819613713223e-5,
            5.8208405838591244e-5,
            6.031087753669961e-5,
            7.030996201327016e-5,
            5.6299606746257645e-5,
            5.032860074616338e-5,
            0.00012812644488945186,
            5.3411149261149685e-5,
            7.48124050507281e-5,
            7.108353295652396e-5,
            3.4794669674710134e-5,
            0.00010068807761696145,
            0.000166009474898643,
            4.549194897542842e-5,
            0.00011279100211135184,
            0.00021296946104561382,
            5.0644948013682555e-5,
            4.053524309718276e-5,
            5.866855208324713e-5,
            4.884302674365142e-5,
            5.656404553064434e-5,
            5.403781634993583e-5,
            6.292856957001637e-5,
            6.744373224408009e-5,
            6.227859948685113e-5,
            4.574581069249879e-5,
            0.00010489406209893145,
            3.1023709934779134e-5,
            6.642094211952598e-5,
            5.239196317804335e-5,
            2.9250438958752562e-5,
            6.623319377951931e-5,
            7.987443055641629e-5,
            4.117365999931027e-5,
            7.444037030265018e-5,
            5.0644948013682555e-5,
            7.581549001791426e-5,
            3.6316741751933675e-5,
            5.474510647560169e-5,
            4.347247863820601e-5,
            4.0075646072381065e-5,
            3.2835575740121756e-5,
            4.276359993577265e-5,
            4.520896506649241e-5,
            3.843857163075051e-5,
            3.66919762765577e-5,
            7.321479726147871e-5,
            2.9769592362929893e-5,
            4.6905242334308245e-5,
            4.223985456863163e-5,
            2.579658423138704e-5,
            5.1410123427365866e-5,
            6.98105066915219e-5,
            3.273326582882448e-5,
            5.592609077552268e-5,
            4.053524309718276e-5,
            3.6316741751933675e-5,
            5.492359111819125e-5,
            3.992930949982439e-5,
            3.197918174208789e-5,
            5.376554286083074e-5,
            5.125855270225345e-5,
            5.592215703286818e-5,
            6.743432270044684e-5,
            5.582799999117352e-5,
            5.46405331760857e-5,
            0.0001095277854110818,
            3.757266587978325e-5,
            9.675555407038318e-5,
            6.479079730536775e-5,
            3.309217862687879e-5,
            7.46528273616593e-5,
            9.204052693662463e-5,
            4.95106226544095e-5,
            8.756688459022536e-5,
            5.866855208324713e-5,
            5.474510647560169e-5,
            3.992930949982439e-5,
            8.63857653208477e-5,
            4.245767842787004e-5,
            4.990853669240659e-5,
            4.3914488183383035e-5,
            5.534935137193253e-5,
            5.5329232091207416e-5,
            5.739158303684047e-5,
            4.048044811321101e-5,
            7.898437184558368e-5,
            3.251545161663139e-5,
            5.0620340079079074e-5,
            4.79643669817638e-5,
            2.64329914752983e-5,
            6.679564806651651e-5,
            8.997965553259721e-5,
            3.318117894285223e-5,
            6.4240200598269e-5,
            4.884302674365142e-5,
            4.347247863820601e-5,
            3.197918174208789e-5,
            4.245767842787004e-5,
            8.113156405188516e-5,
        ],
        20,
        :,
    )
end