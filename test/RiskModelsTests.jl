using Test
using PortfolioOptimiser, CSV, DataFrames, Statistics, CovarianceEstimation

@testset "Risk models" begin
    df = CSV.read("./assets/stock_prices.csv", DataFrame)
    dropmissing!(df)
    returns = returns_from_prices(df[!, 2:end])
    cov_mtx =
        cov(SCov(), Matrix(returns), 1.02^(1 / 252) - 1, SFix(), 252, Int(ceil(252 / 1.4)))
    testcov = reshape(
        [
            0.022525453904467,
            0.014702519870182,
            0.019053982917046,
            0.018696916900512,
            0.018409284534755,
            0.012529128830922,
            0.025945495387098,
            0.00906252641551,
            0.016002832942479,
            0.014837626429073,
            0.008289326315192,
            0.016565859447689,
            0.020363864553773,
            0.0106456062799,
            0.018202853128116,
            0.013186329325946,
            0.014352437901067,
            0.010168834926307,
            0.013642351807908,
            0.012663735203131,
            0.014702519870182,
            0.024877719319234,
            0.016870717350807,
            0.017722225672765,
            0.015812096439494,
            0.011678614245765,
            0.027343097346851,
            0.008513232865114,
            0.015709056305636,
            0.014241616539979,
            0.007973271889648,
            0.017286173384212,
            0.023361014259085,
            0.010741372923038,
            0.020726861755274,
            0.014769673119315,
            0.013711441290225,
            0.00833181521624,
            0.013006276915931,
            0.01114284463531,
            0.019053982917046,
            0.016870717350807,
            0.029504687179255,
            0.022036183656905,
            0.020499385981739,
            0.013801364374561,
            0.029751079162577,
            0.008985313368779,
            0.017402321317274,
            0.016112974285734,
            0.00854913841589,
            0.019936495988079,
            0.024214251349298,
            0.009980421638581,
            0.019849836881366,
            0.015303103580172,
            0.015967297259296,
            0.010850821740143,
            0.01418955073874,
            0.014044230051494,
            0.018696916900512,
            0.017722225672765,
            0.022036183656905,
            0.04492421976902,
            0.021583535546375,
            0.015968076421437,
            0.040335092738185,
            0.010597967619348,
            0.020717405376339,
            0.019522089125673,
            0.010356447924047,
            0.022982694239327,
            0.033494500806262,
            0.013259809899829,
            0.031519029969913,
            0.017840237818766,
            0.01711297092672,
            0.011471372004329,
            0.017110588888627,
            0.014039178633428,
            0.018409284534755,
            0.015812096439494,
            0.020499385981739,
            0.021583535546375,
            0.030720052288252,
            0.012473036680992,
            0.030353854237477,
            0.009351268305371,
            0.017476523182104,
            0.015297753200559,
            0.00823423753673,
            0.019132257038425,
            0.023504172143148,
            0.010334316949157,
            0.022182175733993,
            0.014285336585942,
            0.015802398362235,
            0.009753449058108,
            0.014165665150165,
            0.014562406771882,
            0.012529128830922,
            0.011678614245765,
            0.013801364374561,
            0.015968076421437,
            0.012473036680992,
            0.02440228436048,
            0.024270353503385,
            0.008929498787609,
            0.016590855691834,
            0.015246302436768,
            0.009357190994096,
            0.020838468107746,
            0.031461352497691,
            0.0111529534843,
            0.022433204353138,
            0.012770419417478,
            0.011607514518822,
            0.009310312741978,
            0.013864426966984,
            0.010271579915927,
            0.025945495387098,
            0.027343097346851,
            0.029751079162577,
            0.040335092738185,
            0.030353854237477,
            0.024270353503385,
            0.155039128410935,
            0.015774747228493,
            0.03520296177244,
            0.032434455241135,
            0.018291992172521,
            0.036086319478679,
            0.061043316460493,
            0.020962191067428,
            0.052738849401468,
            0.032510076463945,
            0.026615333851302,
            0.018577521292829,
            0.027791112301525,
            0.02004136380838,
            0.00906252641551,
            0.008513232865114,
            0.008985313368779,
            0.010597967619348,
            0.009351268305371,
            0.008929498787609,
            0.015774747228493,
            0.021040043228967,
            0.010153058123292,
            0.00994413171462,
            0.007118337336687,
            0.013703951963209,
            0.025712628094029,
            0.007965166258197,
            0.013724736058423,
            0.013552473863293,
            0.007872045391554,
            0.007553860717186,
            0.009533706229943,
            0.008250553261039,
            0.016002832942479,
            0.015709056305636,
            0.017402321317274,
            0.020717405376339,
            0.017476523182104,
            0.016590855691834,
            0.03520296177244,
            0.010153058123292,
            0.033703059151725,
            0.01999679985416,
            0.009601367101102,
            0.022904778615797,
            0.032114247249851,
            0.014805757364219,
            0.028375007677103,
            0.018982645552864,
            0.016853429564492,
            0.011901752277136,
            0.024550299661909,
            0.012844360207056,
            0.014837626429073,
            0.014241616539979,
            0.016112974285734,
            0.019522089125673,
            0.015297753200559,
            0.015246302436768,
            0.032434455241135,
            0.00994413171462,
            0.01999679985416,
            0.030013916039327,
            0.010146921400224,
            0.022977718154282,
            0.034760579005305,
            0.012746949467944,
            0.026693425701261,
            0.018036547351302,
            0.013293845137808,
            0.010717987931216,
            0.016439844471517,
            0.012170455458605,
            0.008289326315192,
            0.007973271889648,
            0.00854913841589,
            0.010356447924047,
            0.00823423753673,
            0.009357190994096,
            0.018291992172521,
            0.007118337336687,
            0.009601367101102,
            0.010146921400224,
            0.013322768453092,
            0.011365383230523,
            0.019233470534308,
            0.007930364671191,
            0.015464001707986,
            0.008828942689305,
            0.007422085347014,
            0.006545773475848,
            0.008396896606228,
            0.006707225996955,
            0.016565859447689,
            0.017286173384212,
            0.019936495988079,
            0.022982694239327,
            0.019132257038425,
            0.020838468107746,
            0.036086319478679,
            0.013703951963209,
            0.022904778615797,
            0.022977718154282,
            0.011365383230523,
            0.098323500223113,
            0.049266391473751,
            0.014767159777128,
            0.036819645459222,
            0.025548150829406,
            0.016805891212801,
            0.013044893686802,
            0.018942284744052,
            0.016948695207603,
            0.020363864553773,
            0.023361014259085,
            0.024214251349298,
            0.033494500806262,
            0.023504172143148,
            0.031461352497691,
            0.061043316460493,
            0.025712628094029,
            0.032114247249851,
            0.034760579005305,
            0.019233470534308,
            0.049266391473751,
            0.217250051013063,
            0.022891842887802,
            0.0712810230896,
            0.042122318236915,
            0.020267249870451,
            0.017713825770789,
            0.023354170633112,
            0.022831361630414,
            0.0106456062799,
            0.010741372923038,
            0.009980421638581,
            0.013259809899829,
            0.010334316949157,
            0.0111529534843,
            0.020962191067428,
            0.007965166258197,
            0.014805757364219,
            0.012746949467944,
            0.007930364671191,
            0.014767159777128,
            0.022891842887802,
            0.018268949158542,
            0.025453850018682,
            0.011543173328894,
            0.01044740392348,
            0.008305838702664,
            0.012562806535381,
            0.008419459935667,
            0.018202853128116,
            0.020726861755274,
            0.019849836881366,
            0.031519029969913,
            0.022182175733993,
            0.022433204353138,
            0.052738849401468,
            0.013724736058423,
            0.028375007677103,
            0.026693425701261,
            0.015464001707986,
            0.036819645459222,
            0.0712810230896,
            0.025453850018682,
            0.12537329786879,
            0.02861913492648,
            0.018888305321645,
            0.014190840162381,
            0.022219019674271,
            0.016300305338172,
            0.013186329325946,
            0.014769673119315,
            0.015303103580172,
            0.017840237818766,
            0.014285336585942,
            0.012770419417478,
            0.032510076463945,
            0.013552473863293,
            0.018982645552864,
            0.018036547351302,
            0.008828942689305,
            0.025548150829406,
            0.042122318236915,
            0.011543173328894,
            0.02861913492648,
            0.053688934136254,
            0.012850578683661,
            0.010285493010373,
            0.014886458492273,
            0.012393441822333,
            0.014352437901067,
            0.013711441290225,
            0.015967297259296,
            0.01711297092672,
            0.015802398362235,
            0.011607514518822,
            0.026615333851302,
            0.007872045391554,
            0.016853429564492,
            0.013293845137808,
            0.007422085347014,
            0.016805891212801,
            0.020267249870451,
            0.01044740392348,
            0.018888305321645,
            0.012850578683661,
            0.018888968545482,
            0.009215066292241,
            0.013890907862614,
            0.011030687476662,
            0.010168834926307,
            0.00833181521624,
            0.010850821740143,
            0.011471372004329,
            0.009753449058108,
            0.009310312741978,
            0.018577521292829,
            0.007553860717186,
            0.011901752277136,
            0.010717987931216,
            0.006545773475848,
            0.013044893686802,
            0.017713825770789,
            0.008305838702664,
            0.014190840162381,
            0.010285493010373,
            0.009215066292241,
            0.013588093093942,
            0.01013169888453,
            0.008114476181133,
            0.013642351807908,
            0.013006276915931,
            0.01418955073874,
            0.017110588888627,
            0.014165665150165,
            0.013864426966984,
            0.027791112301525,
            0.009533706229943,
            0.024550299661909,
            0.016439844471517,
            0.008396896606228,
            0.018942284744052,
            0.023354170633112,
            0.012562806535381,
            0.022219019674271,
            0.014886458492273,
            0.013890907862614,
            0.01013169888453,
            0.021570979370674,
            0.010773216311524,
            0.012663735203131,
            0.01114284463531,
            0.014044230051494,
            0.014039178633428,
            0.014562406771882,
            0.010271579915927,
            0.02004136380838,
            0.008250553261039,
            0.012844360207056,
            0.012170455458605,
            0.006707225996955,
            0.016948695207603,
            0.022831361630414,
            0.008419459935667,
            0.016300305338172,
            0.012393441822333,
            0.011030687476662,
            0.008114476181133,
            0.010773216311524,
            0.020237813558209,
        ],
        20,
        :,
    )
    @test isapprox(cov_mtx, testcov, rtol = 1e-4)

    cov_mtx =
        cov(ESCov(), Matrix(returns), 1.02^(1 / 252) - 1, SFix(), 252, Int(ceil(252 / 1.4)))
    testcov = reshape(
        [0.03900084445226888 0.02374258088471931 0.035869417622279645 0.03640742649057418 0.028186004966870952 0.027240440548595438 0.04026661312611741 0.0191731384957373 0.02818455631006372 0.028000113283300914 0.017626714412831493 0.022437046504583197 0.031121564573307763 0.02014972137405705 0.03241396792252521 0.02079315932751833 0.024927854004288732 0.018751295520966653 0.025262612711423604 0.014426759595958854 0.02374258088471931 0.02327494227017931 0.022956880172756204 0.024941914379434854 0.019355183380401382 0.01887419883223524 0.03122690192576201 0.012470777830288101 0.01841442909919217 0.018520585572330918 0.01293080903897608 0.018295297099522895 0.03238238463082841 0.014583339503145139 0.027782792063716557 0.016713464235307462 0.017796258078622344 0.011804652050756679 0.016098371263525268 0.010406188430738846 0.035869417622279645 0.022956880172756204 0.05005312642447694 0.0385167550521469 0.03021106687053133 0.029343832605535695 0.04220061285648465 0.021117500926600936 0.02613027586944575 0.029006297542945834 0.01731813629947294 0.023279271685409657 0.0357935896522795 0.017975195294675946 0.03942532201802745 0.021209973453588334 0.025016518054020373 0.018500147232217625 0.022847270389948843 0.015246051405915478 0.03640742649057418 0.024941914379434854 0.0385167550521469 0.05661794399499479 0.035624665781281026 0.0313532851022564 0.051160549485834914 0.01998286255916682 0.028665450585703245 0.02996257532967651 0.019328514288973822 0.03041497497369548 0.03913850317111943 0.019807350849157714 0.044333428438182616 0.023465250862139717 0.027524327210544368 0.018010882985740766 0.026134963257091443 0.01636912812780202 0.028186004966870952 0.019355183380401382 0.03021106687053133 0.035624665781281026 0.03905409950660545 0.022414759478299223 0.041018877367648206 0.01805296347373808 0.02462064241601972 0.020531501385830174 0.013590244712487107 0.019517538178452556 0.03049713660263585 0.013965603213361679 0.03392745726308473 0.016641500616100705 0.02422498639647871 0.0152281956638418 0.020344188452962424 0.015597624891021749 0.027240440548595438 0.01887419883223524 0.029343832605535695 0.0313532851022564 0.022414759478299223 0.06116878239154157 0.04145860144242304 0.022159497319487687 0.026640485466983343 0.025884923514425253 0.021219401548214303 0.03901433850134988 0.06968465612676489 0.020564660411202005 0.04391838454223453 0.022738368113496225 0.019796529648499962 0.019318188309949625 0.02425324727007459 0.014754165842570409 0.04026661312611741 0.03122690192576201 0.04220061285648465 0.051160549485834914 0.041018877367648206 0.04145860144242304 0.1286675794180281 0.028464815708040776 0.03762634439964831 0.03899364092979199 0.029321663551167148 0.04531682206046382 0.07705739272036252 0.02785530576924673 0.06243910933412938 0.03229192142345256 0.033695061673749895 0.02617043957917601 0.032943424226975056 0.01949257551110657 0.0191731384957373 0.012470777830288101 0.021117500926600936 0.01998286255916682 0.01805296347373808 0.022159497319487687 0.028464815708040776 0.04030024827873196 0.017451513041391822 0.019083874824329827 0.014909353660265579 0.019905466812838148 0.05250231813167481 0.016264059254567913 0.026826667619076355 0.020964991158943954 0.015578936943864922 0.015830596436245955 0.015647685114910603 0.01184098370382105 0.02818455631006372 0.01841442909919217 0.02613027586944575 0.028665450585703245 0.02462064241601972 0.026640485466983343 0.03762634439964831 0.017451513041391822 0.033276816662583544 0.02436868793147879 0.017897852589770336 0.023271174776337316 0.035361987289644146 0.016319552560780434 0.028633624519339734 0.01997441607572644 0.022090970319827128 0.018928129761107745 0.027458957840935938 0.012942719383273033 0.028000113283300914 0.018520585572330918 0.029006297542945834 0.02996257532967651 0.020531501385830174 0.025884923514425253 0.03899364092979199 0.019083874824329827 0.02436868793147879 0.035151120365633115 0.01892418295485163 0.027202989304215396 0.04161280681503957 0.01761802214509021 0.035637124370474296 0.020285835550748678 0.019071300050307882 0.01720100975249153 0.022283279935779637 0.012602146173577373 0.017626714412831493 0.01293080903897608 0.01731813629947294 0.019328514288973822 0.013590244712487107 0.021219401548214303 0.029321663551167148 0.014909353660265579 0.017897852589770336 0.01892418295485163 0.022963931568992648 0.01803312268427431 0.032309010925483585 0.014126572282556905 0.02371198004027108 0.016296010422792606 0.013944725368054694 0.013375620084307994 0.016562070185158297 0.009214356456215251 0.022437046504583197 0.018295297099522895 0.023279271685409657 0.03041497497369548 0.019517538178452556 0.03901433850134988 0.04531682206046382 0.019905466812838148 0.023271174776337316 0.027202989304215396 0.01803312268427431 0.13279231919878043 0.06947900898459157 0.020449895817267912 0.04773069173273337 0.029009348773535257 0.016534131366384444 0.017510693061620033 0.022571412515189015 0.014167554885994752 0.031121564573307763 0.03238238463082841 0.0357935896522795 0.03913850317111943 0.03049713660263585 0.06968465612676489 0.07705739272036252 0.05250231813167481 0.035361987289644146 0.04161280681503957 0.032309010925483585 0.06947900898459157 0.29401151056041896 0.030432377210891298 0.0931883397659145 0.05158256719247313 0.024902758676110186 0.028750244403287613 0.030840782861172318 0.0315898977595021 0.02014972137405705 0.014583339503145139 0.017975195294675946 0.019807350849157714 0.013965603213361679 0.020564660411202005 0.02785530576924673 0.016264059254567913 0.016319552560780434 0.01761802214509021 0.014126572282556905 0.020449895817267912 0.030432377210891298 0.02186711936186108 0.02477835186436577 0.017204173676101633 0.013487061890850824 0.013294173072279897 0.016285987597671987 0.009224145577920985 0.03241396792252521 0.027782792063716557 0.03942532201802745 0.044333428438182616 0.03392745726308473 0.04391838454223453 0.06243910933412938 0.026826667619076355 0.028633624519339734 0.035637124370474296 0.02371198004027108 0.04773069173273337 0.0931883397659145 0.02477835186436577 0.11551312455151863 0.03255140938504359 0.02399876199245975 0.02068065927712369 0.025605068984379458 0.020851150065248056 0.02079315932751833 0.016713464235307462 0.021209973453588334 0.023465250862139717 0.016641500616100705 0.022738368113496225 0.03229192142345256 0.020964991158943954 0.01997441607572644 0.020285835550748678 0.016296010422792606 0.029009348773535257 0.05158256719247313 0.017204173676101633 0.03255140938504359 0.050421423681374526 0.016864111093478896 0.015204835869136991 0.01847173671569178 0.010402043967278458 0.024927854004288732 0.017796258078622344 0.025016518054020373 0.027524327210544368 0.02422498639647871 0.019796529648499962 0.033695061673749895 0.015578936943864922 0.022090970319827128 0.019071300050307882 0.013944725368054694 0.016534131366384444 0.024902758676110186 0.013487061890850824 0.02399876199245975 0.016864111093478896 0.024695716660106816 0.01521978322787175 0.019452391679403075 0.01071761421458703 0.018751295520966653 0.011804652050756679 0.018500147232217625 0.018010882985740766 0.0152281956638418 0.019318188309949625 0.02617043957917601 0.015830596436245955 0.018928129761107745 0.01720100975249153 0.013375620084307994 0.017510693061620033 0.028750244403287613 0.013294173072279897 0.02068065927712369 0.015204835869136991 0.01521978322787175 0.01931203418106597 0.017022633262181338 0.00948134108482751 0.025262612711423604 0.016098371263525268 0.022847270389948843 0.026134963257091443 0.020344188452962424 0.02425324727007459 0.032943424226975056 0.015647685114910603 0.027458957840935938 0.022283279935779637 0.016562070185158297 0.022571412515189015 0.030840782861172318 0.016285987597671987 0.025605068984379458 0.01847173671569178 0.019452391679403075 0.017022633262181338 0.025122040099215915 0.010951651986171332 0.014426759595958854 0.010406188430738846 0.015246051405915478 0.01636912812780202 0.015597624891021749 0.014754165842570409 0.01949257551110657 0.01184098370382105 0.012942719383273033 0.012602146173577373 0.009214356456215251 0.014167554885994752 0.0315898977595021 0.009224145577920985 0.020851150065248056 0.010402043967278458 0.01071761421458703 0.00948134108482751 0.010951651986171332 0.01946608891959149],
        20,
        :,
    )
    @test testcov ≈ cov_mtx

    corr = cov2cor(cov_mtx)
    testcorr = reshape(
        [1.0 0.7880370103378278 0.8118423738397118 0.7747755888771443 0.7222095128793865 0.5577148442008776 0.5684254724707756 0.4836178736651935 0.7823540050325126 0.7562287727997502 0.5889945020062183 0.3117756583012488 0.29063121009801907 0.6899796025512063 0.4829248204751438 0.46889534799901644 0.8032247282972168 0.683250978585417 0.8070748362260224 0.5235913198639335 0.7880370103378278 1.0 0.6725939497132537 0.6870817775935776 0.6419772970798221 0.5002179842733188 0.57062399192518 0.4071883792308268 0.6616724704905059 0.6475015639050216 0.559317322386344 0.3290854509219013 0.39145545914565044 0.6464231368641967 0.5358162944590256 0.48788180072620496 0.7422899354678594 0.5567944190945463 0.665748475282032 0.4888864809355612 0.8118423738397118 0.6725939497132537 1.0 0.7235308271375829 0.6833090034450882 0.530317933753682 0.5258581241056541 0.4701896404838719 0.6402616698999543 0.6915237605062178 0.5108135706585807 0.2855402307396717 0.2950580605439317 0.5433281730380624 0.5184942908702888 0.4221987742397929 0.7115418362708285 0.5950391891353299 0.6443046480828952 0.4884301040402025 0.7747755888771443 0.6870817775935776 0.7235308271375829 1.0 0.7576008218966399 0.5327716249403196 0.5994094529735697 0.41833749664270453 0.6604057387346127 0.6716337410455928 0.536041363792235 0.350771207897804 0.30335069785035823 0.562928918146957 0.548199461971616 0.4391780258991724 0.7360864919712798 0.5446831579286184 0.6929747243297233 0.4930706471445408 0.7222095128793865 0.6419772970798221 0.6833090034450882 0.7576008218966399 1.0 0.4586019013506314 0.5786499107807346 0.4550523152613802 0.6829598599794166 0.5541378413970237 0.4538066343257688 0.2710224365720845 0.28460569368296407 0.477892920371326 0.5051290344693149 0.37501757322082124 0.7800445569351906 0.5544994546859855 0.6495006703990495 0.5656995145637783 0.5577148442008776 0.5002179842733188 0.530317933753682 0.5327716249403196 0.4586019013506314 1.0 0.4673208569072034 0.4463146326825705 0.5904815466394996 0.5582289845856291 0.5661677030527795 0.4328853137283263 0.5196250469484923 0.5622906173252058 0.5224753114035746 0.40943675181474465 0.5093465044074202 0.5620661960809631 0.6186963081159329 0.42757311673914256 0.5684254724707756 0.57062399192518 0.5258581241056541 0.5994094529735697 0.5786499107807346 0.4673208569072034 1.0 0.39529375214746487 0.5750247978210401 0.5798152542190169 0.539424811844449 0.3466876755222492 0.39618458911698745 0.5251429952595528 0.5121609570322493 0.4009145053464104 0.5977517735470183 0.5250037933290096 0.5794376638957516 0.3894891001523857 0.4836178736651935 0.4071883792308268 0.4701896404838719 0.41833749664270453 0.4550523152613802 0.4463146326825705 0.39529375214746487 1.0 0.4765498512105587 0.5070410398551982 0.490096762633423 0.27210218430665745 0.4823279749355802 0.5478722443132951 0.3931852360313254 0.46508600438409436 0.49382507887417354 0.567452359469588 0.4917776473106598 0.42276066378519034 0.7823540050325126 0.6616724704905059 0.6402616698999543 0.6604057387346127 0.6829598599794166 0.5904815466394996 0.5750247978210401 0.4765498512105587 1.0 0.7125111639857031 0.6474510176448908 0.350074875463064 0.35750622645086655 0.6049807731583691 0.4618381161019484 0.48763587982473167 0.7706072459010869 0.7466598640213862 0.9496984103271222 0.5085284990098963 0.7562287727997502 0.6475015639050216 0.6915237605062178 0.6716337410455928 0.5541378413970237 0.5582289845856291 0.5798152542190169 0.5070410398551982 0.7125111639857031 1.0 0.6660769887573716 0.3981626946696996 0.40933158552360205 0.6354652082204137 0.5592646909728172 0.4818543262464657 0.6472914883513033 0.6601921339331994 0.7498632642238646 0.4817653659558023 0.5889945020062183 0.559317322386344 0.5108135706585807 0.536041363792235 0.4538066343257688 0.5661677030527795 0.539424811844449 0.490096762633423 0.6474510176448908 0.6660769887573716 1.0 0.32655875931912626 0.3932044049638235 0.630402441122833 0.46039334050493097 0.47890637662513413 0.585566235326388 0.6351507160237317 0.689547274888211 0.4358153628530099 0.3117756583012488 0.3290854509219013 0.2855402307396717 0.350771207897804 0.2710224365720845 0.4328853137283263 0.3466876755222492 0.27210218430665745 0.350074875463064 0.3981626946696996 0.32655875931912626 1.0 0.351629230794864 0.3794974255986497 0.3853856901845631 0.3545226194665939 0.2887247999104022 0.3457823701818523 0.3907912290635113 0.27865643358002923 0.29063121009801907 0.39145545914565044 0.2950580605439317 0.30335069785035823 0.28460569368296407 0.5196250469484923 0.39618458911698745 0.4823279749355802 0.35750622645086655 0.40933158552360205 0.3932044049638235 0.351629230794864 1.0 0.3795403239310118 0.5056659866951355 0.4236558755007261 0.29224997080049936 0.38154464583114583 0.3588523335344297 0.41756751227673716 0.6899796025512063 0.6464231368641967 0.5433281730380624 0.562928918146957 0.477892920371326 0.5622906173252058 0.5251429952595528 0.5478722443132951 0.6049807731583691 0.6354652082204137 0.630402441122833 0.3794974255986497 0.3795403239310118 1.0 0.4930159416195486 0.5181201448630268 0.5803777383806147 0.6469214181468704 0.6948496765777495 0.4470859368404759 0.4829248204751438 0.5358162944590256 0.5184942908702888 0.548199461971616 0.5051290344693149 0.5224753114035746 0.5121609570322493 0.3931852360313254 0.4618381161019484 0.5592646909728172 0.46039334050493097 0.3853856901845631 0.5056659866951355 0.4930159416195486 1.0 0.42652705032056765 0.44932683446647737 0.43785942567407055 0.4753164362695061 0.4397187622064721 0.46889534799901644 0.48788180072620496 0.4221987742397929 0.4391780258991724 0.37501757322082124 0.40943675181474465 0.4009145053464104 0.46508600438409436 0.48763587982473167 0.4818543262464657 0.47890637662513413 0.3545226194665939 0.4236558755007261 0.5181201448630268 0.42652705032056765 1.0 0.47790886390032605 0.48725934120100245 0.5190064146136529 0.33202576165886044 0.8032247282972168 0.7422899354678594 0.7115418362708285 0.7360864919712798 0.7800445569351906 0.5093465044074202 0.5977517735470183 0.49382507887417354 0.7706072459010869 0.6472914883513033 0.585566235326388 0.2887247999104022 0.29224997080049936 0.5803777383806147 0.44932683446647737 0.47790886390032605 1.0 0.6969211415673917 0.7809706926931986 0.4888188579782026 0.683250978585417 0.5567944190945463 0.5950391891353299 0.5446831579286184 0.5544994546859855 0.5620661960809631 0.5250037933290096 0.567452359469588 0.7466598640213862 0.6601921339331994 0.6351507160237317 0.3457823701818523 0.38154464583114583 0.6469214181468704 0.43785942567407055 0.48725934120100245 0.6969211415673917 1.0 0.7728323266301629 0.48900850001764096 0.8070748362260224 0.665748475282032 0.6443046480828952 0.6929747243297233 0.6495006703990495 0.6186963081159329 0.5794376638957516 0.4917776473106598 0.9496984103271222 0.7498632642238646 0.689547274888211 0.3907912290635113 0.3588523335344297 0.6948496765777495 0.4753164362695061 0.5190064146136529 0.7809706926931986 0.7728323266301629 1.0 0.49523671133983144 0.5235913198639335 0.4888864809355612 0.4884301040402025 0.4930706471445408 0.5656995145637783 0.42757311673914256 0.3894891001523857 0.42276066378519034 0.5085284990098963 0.4817653659558023 0.4358153628530099 0.27865643358002923 0.41756751227673716 0.4470859368404759 0.4397187622064721 0.33202576165886044 0.4888188579782026 0.48900850001764096 0.49523671133983144 1.0],
        20,
        :,
    )
    @test corr ≈ testcorr

    target = DiagonalUnequalVariance()
    shrinkage = :lw
    method = LinearShrinkage(target, shrinkage)

    S = cov(CustomCov(), Matrix(returns), estimator = method)
    @test S ≈ reshape(
        [
            0.052854785530986534,
            0.02391501734195402,
            0.03434025144816493,
            0.028840380594408306,
            0.038639107507737414,
            0.01513106078734621,
            0.02006309684489147,
            0.010191449456206862,
            0.022093960474287355,
            0.01747995096997415,
            0.009832454642770983,
            0.024955430148078286,
            0.008743765745953595,
            0.013006914766132718,
            0.0059744787311906125,
            0.01221767282657966,
            0.024034517252453067,
            0.014376535193874954,
            0.01925108196076226,
            0.02026761100228483,
            0.02391501734195402,
            0.053244351164166315,
            0.026626024131541477,
            0.0230765726635265,
            0.026169169876193124,
            0.014193733777697825,
            0.03176979062778831,
            0.011099027606048145,
            0.02300949076058403,
            0.01850996893662933,
            0.010194257896241779,
            0.022282295318154358,
            0.01742915135419489,
            0.014374423838463933,
            0.013206765208633158,
            0.018132358079579157,
            0.02258495142666813,
            0.012431587546818402,
            0.020904204284325476,
            0.017472873485799383,
            0.03434025144816493,
            0.026626024131541477,
            0.06475241356559708,
            0.029111518787630256,
            0.037406377262305494,
            0.01635630037556586,
            0.02856084720482313,
            0.009427107915433997,
            0.023044329463049417,
            0.01856976209195697,
            0.009513070170734512,
            0.03364604875383288,
            0.014234602998897962,
            0.01280101766266211,
            0.010584756668024118,
            0.013772018605448624,
            0.02480130176277533,
            0.013232873117698989,
            0.019841399199181667,
            0.02147379508609948,
            0.028840380594408306,
            0.0230765726635265,
            0.029111518787630256,
            0.1008453888415781,
            0.03234548175818992,
            0.015884255203726074,
            0.048951390620841334,
            0.008452825992620431,
            0.023874714824308228,
            0.019896777596272036,
            0.0069733177416528985,
            0.027059620610946366,
            0.024505308776869024,
            0.013739866151252186,
            0.023513232512656437,
            0.01900474138104422,
            0.024622263162570632,
            0.012741120219905124,
            0.02060744788532493,
            0.016869609735607246,
            0.038639107507737414,
            0.026169169876193124,
            0.037406377262305494,
            0.03234548175818992,
            0.08334509750146582,
            0.012598771211401379,
            0.029460221304338202,
            0.00897911895234796,
            0.02150281430349371,
            0.01609071378158566,
            0.009096263066910136,
            0.029073222889703973,
            0.004743669748990931,
            0.012492608395005166,
            0.018905097272100012,
            0.01393107098793524,
            0.02548914742226311,
            0.011331171550332133,
            0.0183536551278744,
            0.024362549795788526,
            0.01513106078734621,
            0.014193733777697825,
            0.01635630037556586,
            0.015884255203726074,
            0.012598771211401379,
            0.045079682063007546,
            0.02306839443087296,
            0.0093397957485193,
            0.0243019028892953,
            0.02117440438102843,
            0.012873504050272672,
            0.02603456464378015,
            0.02809461136554044,
            0.01694556550444848,
            0.024561201448570522,
            0.01163797440496076,
            0.01578558133829621,
            0.01370179188515413,
            0.02226904668543407,
            0.01498191720935,
            0.02006309684489147,
            0.03176979062778831,
            0.02856084720482313,
            0.048951390620841334,
            0.029460221304338202,
            0.02306839443087296,
            0.4148787069742023,
            0.011019558354534637,
            0.04091407056055665,
            0.033804955799192286,
            0.015727474991633045,
            0.025814401811831988,
            0.03415426819239726,
            0.021877553373789663,
            0.05874520308911351,
            0.02927537571553266,
            0.03185502624739813,
            0.018088351366942205,
            0.030741949740449265,
            0.01306401164962576,
            0.010191449456206862,
            0.011099027606048145,
            0.009427107915433997,
            0.008452825992620431,
            0.00897911895234796,
            0.0093397957485193,
            0.011019558354534637,
            0.041164878671046456,
            0.010100691166830775,
            0.012154296892078937,
            0.01034104895181351,
            0.015628029564459356,
            0.027248762635262453,
            0.0084179903983864,
            0.0050885256873564036,
            0.014089071697062566,
            0.01122467654929627,
            0.010855441752199133,
            0.011523480005567688,
            0.011896189771672033,
            0.022093960474287355,
            0.02300949076058403,
            0.023044329463049417,
            0.023874714824308228,
            0.02150281430349371,
            0.0243019028892953,
            0.04091407056055665,
            0.010100691166830775,
            0.0695245813383155,
            0.030697424761015363,
            0.011403322469906857,
            0.03457532233697861,
            0.03621296986431154,
            0.02229728711145045,
            0.03302008358971731,
            0.028893231383027653,
            0.026797517747707993,
            0.01892220545047497,
            0.04907554317923326,
            0.018998966172569215,
            0.01747995096997415,
            0.01850996893662933,
            0.01856976209195697,
            0.019896777596272036,
            0.01609071378158566,
            0.02117440438102843,
            0.033804955799192286,
            0.012154296892078937,
            0.030697424761015363,
            0.061248661593746624,
            0.011624528370699968,
            0.031268515332844665,
            0.03555277280859664,
            0.0160153401655869,
            0.02539167717104779,
            0.024408189200746104,
            0.018762352183604464,
            0.014689314383948604,
            0.026388556138748243,
            0.017052981204860478,
            0.009832454642770983,
            0.010194257896241779,
            0.009513070170734512,
            0.0069733177416528985,
            0.009096263066910136,
            0.012873504050272672,
            0.015727474991633045,
            0.01034104895181351,
            0.011403322469906857,
            0.011624528370699968,
            0.026518483965133656,
            0.011923023815443292,
            0.014366830541531624,
            0.011838836522027225,
            0.015260300217624822,
            0.009832862660430484,
            0.01040392364568105,
            0.00909254210395352,
            0.012540860664630988,
            0.008801983877416826,
            0.024955430148078286,
            0.022282295318154358,
            0.03364604875383288,
            0.027059620610946366,
            0.029073222889703973,
            0.02603456464378015,
            0.025814401811831988,
            0.015628029564459356,
            0.03457532233697861,
            0.031268515332844665,
            0.011923023815443292,
            0.1778864625507731,
            0.056153987355563234,
            0.018466558446191886,
            0.03184129149458873,
            0.03355142634375926,
            0.02268713067781592,
            0.016660318227764478,
            0.029718858681011266,
            0.026373720861679266,
            0.008743765745953595,
            0.01742915135419489,
            0.014234602998897962,
            0.024505308776869024,
            0.004743669748990931,
            0.02809461136554044,
            0.03415426819239726,
            0.027248762635262453,
            0.03621296986431154,
            0.03555277280859664,
            0.014366830541531624,
            0.056153987355563234,
            0.4893325238820329,
            0.019105849191455446,
            0.054070048805680074,
            0.057049111743511786,
            0.014549005519450982,
            0.013627851988451763,
            0.02445844226314088,
            0.023099801888110793,
            0.013006914766132718,
            0.014374423838463933,
            0.01280101766266211,
            0.013739866151252186,
            0.012492608395005166,
            0.01694556550444848,
            0.021877553373789663,
            0.0084179903983864,
            0.02229728711145045,
            0.0160153401655869,
            0.011838836522027225,
            0.018466558446191886,
            0.019105849191455446,
            0.036155632214238724,
            0.03769770154598096,
            0.011537668134719981,
            0.015719545155981736,
            0.01250137417865243,
            0.021403681826486283,
            0.009796755444509397,
            0.0059744787311906125,
            0.013206765208633158,
            0.010584756668024118,
            0.023513232512656437,
            0.018905097272100012,
            0.024561201448570522,
            0.05874520308911351,
            0.0050885256873564036,
            0.03302008358971731,
            0.02539167717104779,
            0.015260300217624822,
            0.03184129149458873,
            0.054070048805680074,
            0.03769770154598096,
            0.25013316653952516,
            0.027931117370640236,
            0.016352894085914064,
            0.009180753910249683,
            0.028385544191763493,
            0.008572365445231,
            0.01221767282657966,
            0.018132358079579157,
            0.013772018605448624,
            0.01900474138104422,
            0.01393107098793524,
            0.01163797440496076,
            0.02927537571553266,
            0.014089071697062566,
            0.028893231383027653,
            0.024408189200746104,
            0.009832862660430484,
            0.03355142634375926,
            0.057049111743511786,
            0.011537668134719981,
            0.027931117370640236,
            0.12723323782881177,
            0.01824491396149005,
            0.012028030373456374,
            0.022581441989188645,
            0.01863037547771242,
            0.024034517252453067,
            0.02258495142666813,
            0.02480130176277533,
            0.024622263162570632,
            0.02548914742226311,
            0.01578558133829621,
            0.03185502624739813,
            0.01122467654929627,
            0.026797517747707993,
            0.018762352183604464,
            0.01040392364568105,
            0.02268713067781592,
            0.014549005519450982,
            0.015719545155981736,
            0.016352894085914064,
            0.01824491396149005,
            0.04088882235804586,
            0.014948194074814073,
            0.023998927146315335,
            0.01887085293645612,
            0.014376535193874954,
            0.012431587546818402,
            0.013232873117698989,
            0.012741120219905124,
            0.011331171550332133,
            0.01370179188515413,
            0.018088351366942205,
            0.010855441752199133,
            0.01892220545047497,
            0.014689314383948604,
            0.00909254210395352,
            0.016660318227764478,
            0.013627851988451763,
            0.01250137417865243,
            0.009180753910249683,
            0.012028030373456374,
            0.014948194074814073,
            0.03071609759430371,
            0.01765047863750906,
            0.010874820333158697,
            0.01925108196076226,
            0.020904204284325476,
            0.019841399199181667,
            0.02060744788532493,
            0.0183536551278744,
            0.02226904668543407,
            0.030741949740449265,
            0.011523480005567688,
            0.04907554317923326,
            0.026388556138748243,
            0.012540860664630988,
            0.029718858681011266,
            0.02445844226314088,
            0.021403681826486283,
            0.028385544191763493,
            0.022581441989188645,
            0.023998927146315335,
            0.01765047863750906,
            0.04654302713498724,
            0.01729497397891588,
            0.02026761100228483,
            0.017472873485799383,
            0.02147379508609948,
            0.016869609735607246,
            0.024362549795788526,
            0.01498191720935,
            0.01306401164962576,
            0.011896189771672033,
            0.018998966172569215,
            0.017052981204860478,
            0.008801983877416826,
            0.026373720861679266,
            0.023099801888110793,
            0.009796755444509397,
            0.008572365445231,
            0.01863037547771242,
            0.01887085293645612,
            0.010874820333158697,
            0.01729497397891588,
            0.03974429113917746,
        ],
        20,
        :,
    )

    S = cov(CustomCov(), Matrix(returns))
    @test S ≈ cov(Matrix(returns)) * 252

    target = DiagonalCommonVariance()
    shrinkage = :oas
    method = LinearShrinkage(target, shrinkage)

    S = Matrix(cov(CustomSCov(), Matrix(returns), estimator = method))

    @test S ≈ reshape(
        [
            0.02271716984716669,
            0.014601812528298785,
            0.01892360621079808,
            0.018568905684131057,
            0.01828327282118336,
            0.012443259275424418,
            0.02576795880540097,
            0.00900031390175162,
            0.015893268158697627,
            0.014736025938486053,
            0.008232400623779742,
            0.016452279758318412,
            0.020224315296583317,
            0.010572608534426682,
            0.018078170210148372,
            0.013095985426557323,
            0.014254139473722375,
            0.010099062810240029,
            0.013548916800929347,
            0.01257695124648646,
            0.014601812528298785,
            0.02505337986566709,
            0.01675523998628458,
            0.017600879089546547,
            0.015703834143189856,
            0.011598513655970746,
            0.02715598052828703,
            0.008454767505034409,
            0.01560147682511858,
            0.014144043294031168,
            0.007918471865901805,
            0.017167732113786992,
            0.023200949627210973,
            0.010667688524721778,
            0.02058485006400967,
            0.014668518271324994,
            0.013617529720183829,
            0.008274565086510682,
            0.012917155280967868,
            0.011066451022212525,
            0.01892360621079808,
            0.01675523998628458,
            0.02964883971989361,
            0.021885452412281448,
            0.020359168957884574,
            0.013706833600316675,
            0.02954764222464972,
            0.008923640304245646,
            0.017283232122787345,
            0.016002674304914512,
            0.008490465088769217,
            0.019800003636630967,
            0.02404842915697565,
            0.009911962826077163,
            0.019713941776269426,
            0.015198341139248301,
            0.015857999531644126,
            0.010776427183814706,
            0.01409238357228278,
            0.013948036545726997,
            0.018568905684131057,
            0.017600879089546547,
            0.021885452412281448,
            0.044963167983437566,
            0.021435890027356207,
            0.015858709142495063,
            0.0400595129038098,
            0.010525256512618587,
            0.020575647629374118,
            0.019388505160116296,
            0.010285372991692222,
            0.022825413293547,
            0.03326542791590245,
            0.01316888012088453,
            0.03130349148208113,
            0.01771811042734408,
            0.016995820525508184,
            0.011392659196756087,
            0.016993449320512603,
            0.013942966486984268,
            0.01828327282118336,
            0.015703834143189856,
            0.020359168957884574,
            0.021435890027356207,
            0.030855935436500972,
            0.012387555357249901,
            0.030146288075334687,
            0.009287097202890246,
            0.017356934300683687,
            0.01519302383266893,
            0.008177696736716495,
            0.01900120300213763,
            0.023343237392924977,
            0.0102634412916041,
            0.02203038326492791,
            0.014187500900056927,
            0.015694207070686483,
            0.00968652005094913,
            0.014068655997775726,
            0.014462678925283799,
            0.012443259275424418,
            0.011598513655970746,
            0.013706833600316675,
            0.015858709142495063,
            0.012387555357249901,
            0.02458116151451457,
            0.02410423343333083,
            0.00886818129083319,
            0.016477182671764047,
            0.015141822339005281,
            0.009292931174089195,
            0.020695737252738076,
            0.031245965124569224,
            0.01107639946074987,
            0.0222795257225547,
            0.012682807388033172,
            0.011527944294509696,
            0.009246378021692541,
            0.013769414360373596,
            0.010201072924529176,
            0.02576795880540097,
            0.02715598052828703,
            0.02954764222464972,
            0.0400595129038098,
            0.030146288075334687,
            0.02410423343333083,
            0.15432827285619027,
            0.015666599827485726,
            0.03496236243614712,
            0.03221275292785334,
            0.0181666242589527,
            0.03583963574511477,
            0.06062652119349114,
            0.020818541053952658,
            0.05237861972341495,
            0.032287864112141865,
            0.026433303648930727,
            0.018450128909892637,
            0.027601001923592616,
            0.019904061705087087,
            0.00900031390175162,
            0.008454767505034409,
            0.008923640304245646,
            0.010525256512618587,
            0.009287097202890246,
            0.00886818129083319,
            0.015666599827485726,
            0.021241963104225565,
            0.01008339087786542,
            0.009875897581334954,
            0.007069404017721515,
            0.013610000339747462,
            0.0255365721205618,
            0.007910457176263604,
            0.01363059400210295,
            0.013459609613809721,
            0.007817974903564342,
            0.0075019372754583325,
            0.00946831180170538,
            0.00819389380739111,
            0.015893268158697627,
            0.01560147682511858,
            0.017283232122787345,
            0.020575647629374118,
            0.017356934300683687,
            0.016477182671764047,
            0.03496236243614712,
            0.01008339087786542,
            0.033818550930138094,
            0.01985994675243837,
            0.009535447291451372,
            0.02274799087291564,
            0.03189448588469585,
            0.014704311627382564,
            0.02818086236274446,
            0.01885272607278348,
            0.016738077414120547,
            0.011820121068245678,
            0.024382399625736562,
            0.012756325699927927,
            0.014736025938486053,
            0.014144043294031168,
            0.016002674304914512,
            0.019388505160116296,
            0.01519302383266893,
            0.015141822339005281,
            0.03221275292785334,
            0.009875897581334954,
            0.01985994675243837,
            0.030154512949101757,
            0.010077282206242611,
            0.022820453808619297,
            0.0345228390927546,
            0.01265953692732737,
            0.026510784547705276,
            0.01791305030504404,
            0.013202774720866924,
            0.010644443351295172,
            0.01632728092095267,
            0.012087020479404478,
            0.008232400623779742,
            0.007918471865901805,
            0.008490465088769217,
            0.010285372991692222,
            0.008177696736716495,
            0.009292931174089195,
            0.0181666242589527,
            0.007069404017721515,
            0.009535447291451372,
            0.010077282206242611,
            0.013577237734028729,
            0.011287314227793947,
            0.019101511538492696,
            0.007875852555550256,
            0.015357837180181163,
            0.008768256758026954,
            0.007371110617605646,
            0.006500739226309534,
            0.008339229013973456,
            0.006661113851775171,
            0.016452279758318412,
            0.017167732113786992,
            0.019800003636630967,
            0.022825413293547,
            0.01900120300213763,
            0.020695737252738076,
            0.03583963574511477,
            0.013610000339747462,
            0.02274799087291564,
            0.022820453808619297,
            0.011287314227793947,
            0.09799898490939578,
            0.04892967511087633,
            0.014665875733973564,
            0.036567875106128106,
            0.025373395559474286,
            0.016690764832438868,
            0.012955351103696198,
            0.018812512495138146,
            0.01683250331276216,
            0.020224315296583317,
            0.023200949627210973,
            0.02404842915697565,
            0.03326542791590245,
            0.023343237392924977,
            0.031245965124569224,
            0.06062652119349114,
            0.0255365721205618,
            0.03189448588469585,
            0.0345228390927546,
            0.019101511538492696,
            0.04892967511087633,
            0.2161153072342615,
            0.022734900801653333,
            0.07079439982679775,
            0.04183438767445804,
            0.020128356500216903,
            0.017592247686263517,
            0.023194212788029408,
            0.022674873194214497,
            0.010572608534426682,
            0.010667688524721778,
            0.009911962826077163,
            0.01316888012088453,
            0.0102634412916041,
            0.01107639946074987,
            0.020818541053952658,
            0.007910457176263604,
            0.014704311627382564,
            0.01265953692732737,
            0.007875852555550256,
            0.014665875733973564,
            0.022734900801653333,
            0.018489656062467403,
            0.025279509834834454,
            0.011463971141807961,
            0.010375762319826188,
            0.00824878298886377,
            0.012476676908911195,
            0.008361657093598762,
            0.018078170210148372,
            0.02058485006400967,
            0.019713941776269426,
            0.03130349148208113,
            0.02203038326492791,
            0.0222795257225547,
            0.05237861972341495,
            0.01363059400210295,
            0.02818086236274446,
            0.026510784547705276,
            0.015357837180181163,
            0.036567875106128106,
            0.07079439982679775,
            0.025279509834834454,
            0.12486408209500474,
            0.028423332532060662,
            0.018758973316267847,
            0.014093374875431715,
            0.02206685491673679,
            0.01618853055076379,
            0.013095985426557323,
            0.014668518271324994,
            0.015198341139248301,
            0.01771811042734408,
            0.014187500900056927,
            0.012682807388033172,
            0.032287864112141865,
            0.013459609613809721,
            0.01885272607278348,
            0.01791305030504404,
            0.008768256758026954,
            0.025373395559474286,
            0.04183438767445804,
            0.011463971141807961,
            0.028423332532060662,
            0.053668304183494685,
            0.012762526899448004,
            0.010214881260490055,
            0.014784475124978276,
            0.012308442739400158,
            0.014254139473722375,
            0.013617529720183829,
            0.015857999531644126,
            0.016995820525508184,
            0.015694207070686483,
            0.011527944294509696,
            0.026433303648930727,
            0.007817974903564342,
            0.016738077414120547,
            0.013202774720866924,
            0.007371110617605646,
            0.016690764832438868,
            0.020128356500216903,
            0.010375762319826188,
            0.018758973316267847,
            0.012762526899448004,
            0.019105503484514393,
            0.009151818921487287,
            0.013795766831851627,
            0.010955064616827914,
            0.010099062810240029,
            0.008274565086510682,
            0.010776427183814706,
            0.011392659196756087,
            0.00968652005094913,
            0.009246378021692541,
            0.018450128909892637,
            0.0075019372754583325,
            0.011820121068245678,
            0.010644443351295172,
            0.006500739226309534,
            0.012955351103696198,
            0.017592247686263517,
            0.00824878298886377,
            0.014093374875431715,
            0.010214881260490055,
            0.009151818921487287,
            0.013840744961784194,
            0.010062185993955747,
            0.008058753799006148,
            0.013548916800929347,
            0.012917155280967868,
            0.01409238357228278,
            0.016993449320512603,
            0.014068655997775726,
            0.013769414360373596,
            0.027601001923592616,
            0.00946831180170538,
            0.024382399625736562,
            0.01632728092095267,
            0.008339229013973456,
            0.018812512495138146,
            0.023194212788029408,
            0.012476676908911195,
            0.02206685491673679,
            0.014784475124978276,
            0.013795766831851627,
            0.010062185993955747,
            0.02176921286085362,
            0.01069933496382325,
            0.01257695124648646,
            0.011066451022212525,
            0.013948036545726997,
            0.013942966486984268,
            0.014462678925283799,
            0.010201072924529176,
            0.019904061705087087,
            0.00819389380739111,
            0.012756325699927927,
            0.012087020479404478,
            0.006661113851775171,
            0.01683250331276216,
            0.022674873194214497,
            0.008361657093598762,
            0.01618853055076379,
            0.012308442739400158,
            0.010955064616827914,
            0.008058753799006148,
            0.01069933496382325,
            0.02044515414107506,
        ],
        20,
        :,
    )
end