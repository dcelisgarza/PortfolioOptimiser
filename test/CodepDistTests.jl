using Test, PortfolioOptimiser, CSV, TimeSeries, DataFrames, Logging

Logging.disable_logging(Logging.Warn)

A = TimeArray(CSV.File("./assets/stock_prices.csv"), timestamp = :date)
Y = percentchange(A)
returns = dropmissing!(DataFrame(Y))

@testset "Codependence and distance functions" begin
    portfolio = HCPortfolio(returns = returns)

    portfolio.cor_method = :Pearson
    asset_statistics!(portfolio)
    pearson = portfolio.cor

    portfolio.cor_method = :Spearman
    asset_statistics!(portfolio)
    spearman = portfolio.cor

    portfolio.cor_method = :Kendall
    asset_statistics!(portfolio)
    kendall = portfolio.cor

    portfolio.cor_method = :Abs_Pearson
    asset_statistics!(portfolio)
    abs_pearson = portfolio.cor

    portfolio.cor_method = :Abs_Spearman
    asset_statistics!(portfolio)
    abs_spearman = portfolio.cor

    portfolio.cor_method = :Abs_Kendall
    asset_statistics!(portfolio)
    abs_kendall = portfolio.cor

    portfolio.cor_method = :Gerber1
    asset_statistics!(portfolio, std_kwargs = (; corrected = false))
    gerber1 = portfolio.cor

    portfolio.cor_method = :Gerber2
    asset_statistics!(portfolio, std_kwargs = (; corrected = false))
    gerber2 = portfolio.cor

    portfolio.cor_method = :Distance
    asset_statistics!(portfolio)
    distance = portfolio.cor

    try
        portfolio.cor_method = :Mutual_Info
        asset_statistics!(portfolio)
        mutual_info = portfolio.cor
        var_info = portfolio.dist
        mutual_infot = reshape(
            [
                1.0,
                0.24820017,
                0.25160328,
                0.20759514,
                0.25455096,
                0.18138002,
                0.17845359,
                0.15408406,
                0.25028217,
                0.24663562,
                0.19356328,
                0.14316573,
                0.15841591,
                0.21498347,
                0.18859915,
                0.14770436,
                0.24119855,
                0.20343753,
                0.2253823,
                0.20938851,
                0.24820017,
                1.0,
                0.17017134,
                0.16943677,
                0.19397435,
                0.1991394,
                0.23937428,
                0.21744589,
                0.17419342,
                0.158114,
                0.16385312,
                0.12150161,
                0.11143339,
                0.18257772,
                0.13017671,
                0.1171313,
                0.18434406,
                0.14939097,
                0.21364993,
                0.18392653,
                0.25160328,
                0.17017134,
                1.0,
                0.15251622,
                0.21284945,
                0.16650813,
                0.16749233,
                0.15014229,
                0.15061229,
                0.13499461,
                0.14025166,
                0.08327892,
                0.0585108,
                0.14755498,
                0.12312418,
                0.07953915,
                0.17185424,
                0.09110937,
                0.16767185,
                0.15501338,
                0.20759514,
                0.16943677,
                0.15251622,
                1.0,
                0.17679574,
                0.18093097,
                0.20881001,
                0.17401493,
                0.15988661,
                0.16589751,
                0.13845077,
                0.11726655,
                0.11407452,
                0.14383104,
                0.14073583,
                0.11005473,
                0.15890886,
                0.13491826,
                0.17567689,
                0.14229095,
                0.25455096,
                0.19397435,
                0.21284945,
                0.17679574,
                1.0,
                0.17795363,
                0.1861002,
                0.16624996,
                0.18504801,
                0.18327441,
                0.14183437,
                0.11569402,
                0.10966007,
                0.16438238,
                0.13947774,
                0.11527808,
                0.20562539,
                0.14640739,
                0.18214465,
                0.17103925,
                0.18138002,
                0.1991394,
                0.16650813,
                0.18093097,
                0.17795363,
                1.0,
                0.18170661,
                0.17067721,
                0.22230345,
                0.23596261,
                0.20027364,
                0.15357593,
                0.16253885,
                0.22250267,
                0.18079605,
                0.13928673,
                0.2126733,
                0.18975571,
                0.21285776,
                0.16895125,
                0.17845359,
                0.23937428,
                0.16749233,
                0.20881001,
                0.1861002,
                0.18170661,
                1.0,
                0.13849392,
                0.23685446,
                0.25239514,
                0.19823985,
                0.12666763,
                0.18865429,
                0.23268764,
                0.2235726,
                0.14964037,
                0.20280946,
                0.20044971,
                0.21100877,
                0.18616026,
                0.15408406,
                0.21744589,
                0.15014229,
                0.17401493,
                0.16624996,
                0.17067721,
                0.13849392,
                1.0,
                0.20750896,
                0.23642225,
                0.18542775,
                0.12680698,
                0.16464315,
                0.19755112,
                0.18451745,
                0.15103713,
                0.1917548,
                0.1876002,
                0.18320915,
                0.17514168,
                0.25028217,
                0.17419342,
                0.15061229,
                0.15988661,
                0.18504801,
                0.22230345,
                0.23685446,
                0.20750896,
                1.0,
                0.19428826,
                0.16578655,
                0.13883416,
                0.1282936,
                0.18506755,
                0.14939042,
                0.15255785,
                0.19397913,
                0.16209036,
                0.36683471,
                0.18201918,
                0.24663562,
                0.158114,
                0.13499461,
                0.16589751,
                0.18327441,
                0.23596261,
                0.25239514,
                0.23642225,
                0.19428826,
                1.0,
                0.18109497,
                0.13352022,
                0.11830888,
                0.19358862,
                0.14441645,
                0.13261937,
                0.15601745,
                0.14675327,
                0.23615231,
                0.18210644,
                0.19356328,
                0.16385312,
                0.14025166,
                0.13845077,
                0.14183437,
                0.20027364,
                0.19823985,
                0.18542775,
                0.16578655,
                0.18109497,
                1.0,
                0.12738494,
                0.12498709,
                0.17213639,
                0.13469801,
                0.12520556,
                0.14448454,
                0.15164822,
                0.17652189,
                0.14957055,
                0.14316573,
                0.12150161,
                0.08327892,
                0.11726655,
                0.11569402,
                0.15357593,
                0.12666763,
                0.12680698,
                0.13883416,
                0.13352022,
                0.12738494,
                1.0,
                0.0662416,
                0.13017944,
                0.10753001,
                0.07775909,
                0.1173758,
                0.07526807,
                0.16287375,
                0.13519801,
                0.15841591,
                0.11143339,
                0.0585108,
                0.11407452,
                0.10966007,
                0.16253885,
                0.18865429,
                0.16464315,
                0.1282936,
                0.11830888,
                0.12498709,
                0.0662416,
                1.0,
                0.12875302,
                0.11365198,
                0.08583222,
                0.0873079,
                0.06443257,
                0.15175975,
                0.11560973,
                0.21498347,
                0.18257772,
                0.14755498,
                0.14383104,
                0.16438238,
                0.22250267,
                0.23268764,
                0.19755112,
                0.18506755,
                0.19358862,
                0.17213639,
                0.13017944,
                0.12875302,
                1.0,
                0.17446711,
                0.13214989,
                0.17394148,
                0.16183806,
                0.20907906,
                0.15976744,
                0.18859915,
                0.13017671,
                0.12312418,
                0.14073583,
                0.13947774,
                0.18079605,
                0.2235726,
                0.18451745,
                0.14939042,
                0.14441645,
                0.13469801,
                0.10753001,
                0.11365198,
                0.17446711,
                1.0,
                0.11138581,
                0.12100853,
                0.10972986,
                0.16852108,
                0.15213361,
                0.14770436,
                0.1171313,
                0.07953915,
                0.11005473,
                0.11527808,
                0.13928673,
                0.14964037,
                0.15103713,
                0.15255785,
                0.13261937,
                0.12520556,
                0.07775909,
                0.08583222,
                0.13214989,
                0.11138581,
                1.0,
                0.11933432,
                0.08893961,
                0.16461752,
                0.12733787,
                0.24119855,
                0.18434406,
                0.17185424,
                0.15890886,
                0.20562539,
                0.2126733,
                0.20280946,
                0.1917548,
                0.19397913,
                0.15601745,
                0.14448454,
                0.1173758,
                0.0873079,
                0.17394148,
                0.12100853,
                0.11933432,
                1.0,
                0.14576355,
                0.21990239,
                0.18212249,
                0.20343753,
                0.14939097,
                0.09110937,
                0.13491826,
                0.14640739,
                0.18975571,
                0.20044971,
                0.1876002,
                0.16209036,
                0.14675327,
                0.15164822,
                0.07526807,
                0.06443257,
                0.16183806,
                0.10972986,
                0.08893961,
                0.14576355,
                1.0,
                0.19412053,
                0.16117754,
                0.2253823,
                0.21364993,
                0.16767185,
                0.17567689,
                0.18214465,
                0.21285776,
                0.21100877,
                0.18320915,
                0.36683471,
                0.23615231,
                0.17652189,
                0.16287375,
                0.15175975,
                0.20907906,
                0.16852108,
                0.16461752,
                0.21990239,
                0.19412053,
                1.0,
                0.16907954,
                0.20938851,
                0.18392653,
                0.15501338,
                0.14229095,
                0.17103925,
                0.16895125,
                0.18616026,
                0.17514168,
                0.18201918,
                0.18210644,
                0.14957055,
                0.13519801,
                0.11560973,
                0.15976744,
                0.15213361,
                0.12733787,
                0.18212249,
                0.16117754,
                0.16907954,
                1.0,
            ],
            20,
            20,
        )
        var_infot = reshape(
            [
                0.0,
                0.8722316,
                0.85882762,
                0.89199801,
                0.85783699,
                0.9025841,
                0.90702548,
                0.91903918,
                0.87194513,
                0.87677175,
                0.9002933,
                0.92690461,
                0.91876518,
                0.89047229,
                0.9053188,
                0.92207679,
                0.87130482,
                0.8934859,
                0.880544,
                0.88783813,
                0.8722316,
                0.0,
                0.9159221,
                0.91075638,
                0.90171202,
                0.89786834,
                0.88338959,
                0.89335868,
                0.90539598,
                0.91704192,
                0.91344378,
                0.94690097,
                0.9438118,
                0.90046409,
                0.93080654,
                0.94674453,
                0.90284108,
                0.92267007,
                0.88540839,
                0.90512104,
                0.85882762,
                0.9159221,
                0.0,
                0.92185358,
                0.88157133,
                0.90967008,
                0.91465665,
                0.92250097,
                0.92675103,
                0.93703109,
                0.92905555,
                0.96089251,
                0.97136977,
                0.92666919,
                0.94013683,
                0.96078028,
                0.91099662,
                0.95528147,
                0.91236375,
                0.91821961,
                0.89199801,
                0.91075638,
                0.92185358,
                0.0,
                0.90792195,
                0.90493754,
                0.89654588,
                0.91360324,
                0.91687643,
                0.91548845,
                0.92592066,
                0.94611729,
                0.94006968,
                0.92455661,
                0.92662217,
                0.94754901,
                0.91409095,
                0.92800976,
                0.90456769,
                0.92565113,
                0.85783699,
                0.90171202,
                0.88157133,
                0.90792195,
                0.0,
                0.90245647,
                0.90477693,
                0.91411556,
                0.90741184,
                0.91058556,
                0.92777756,
                0.94386238,
                0.94421514,
                0.91725954,
                0.93082724,
                0.94208429,
                0.89052065,
                0.9244417,
                0.90342131,
                0.90803448,
                0.9025841,
                0.89786834,
                0.90967008,
                0.90493754,
                0.90245647,
                0.0,
                0.90713308,
                0.91152424,
                0.88532976,
                0.88019502,
                0.89422355,
                0.92329454,
                0.91453598,
                0.88349403,
                0.90765948,
                0.92881653,
                0.88570002,
                0.89923754,
                0.88541749,
                0.90940434,
                0.90702548,
                0.88338959,
                0.91465665,
                0.89654588,
                0.90477693,
                0.90713308,
                0.0,
                0.9273206,
                0.88530457,
                0.87980336,
                0.90271195,
                0.93240492,
                0.90649568,
                0.88592393,
                0.89138457,
                0.92126248,
                0.89918791,
                0.90028366,
                0.89438751,
                0.90633035,
                0.91903918,
                0.89335868,
                0.92250097,
                0.91360324,
                0.91411556,
                0.91152424,
                0.9273206,
                0.0,
                0.89928928,
                0.88636915,
                0.90790797,
                0.93379537,
                0.91787178,
                0.90315425,
                0.91036128,
                0.91871724,
                0.90345882,
                0.90571564,
                0.9079994,
                0.91057331,
                0.87194513,
                0.90539598,
                0.92675103,
                0.91687643,
                0.90741184,
                0.88532976,
                0.88530457,
                0.89928928,
                0.0,
                0.89500989,
                0.91310209,
                0.93922602,
                0.93517864,
                0.89976894,
                0.92035173,
                0.92973649,
                0.89808768,
                0.91627394,
                0.78766904,
                0.90699173,
                0.87677175,
                0.91704192,
                0.93703109,
                0.91548845,
                0.91058556,
                0.88019502,
                0.87980336,
                0.88636915,
                0.89500989,
                0.0,
                0.90654106,
                0.94407938,
                0.94221108,
                0.89709588,
                0.92512948,
                0.94163587,
                0.92197008,
                0.92696247,
                0.87584134,
                0.90909282,
                0.9002933,
                0.91344378,
                0.92905555,
                0.92592066,
                0.92777756,
                0.89422355,
                0.90271195,
                0.90790797,
                0.91310209,
                0.90654106,
                0.0,
                0.94127061,
                0.93426872,
                0.90798816,
                0.92949826,
                0.94030995,
                0.92297209,
                0.91890041,
                0.9044995,
                0.92194312,
                0.92690461,
                0.94690097,
                0.96089251,
                0.94611729,
                0.94386238,
                0.92329454,
                0.93240492,
                0.93379537,
                0.93922602,
                0.94407938,
                0.94127061,
                0.0,
                0.97081086,
                0.94158414,
                0.95274941,
                0.9612523,
                0.94629236,
                0.96761273,
                0.9216855,
                0.93502909,
                0.91876518,
                0.9438118,
                0.97136977,
                0.94006968,
                0.94421514,
                0.91453598,
                0.90649568,
                0.91787178,
                0.93517864,
                0.94221108,
                0.93426872,
                0.97081086,
                0.0,
                0.9336312,
                0.94217736,
                0.95991338,
                0.95451323,
                0.96696092,
                0.91793572,
                0.93975883,
                0.89047229,
                0.90046409,
                0.92666919,
                0.92455661,
                0.91725954,
                0.88349403,
                0.88592393,
                0.90315425,
                0.89976894,
                0.89709588,
                0.90798816,
                0.94158414,
                0.9336312,
                0.0,
                0.90484584,
                0.93815901,
                0.90774504,
                0.91473056,
                0.88737167,
                0.91802788,
                0.9053188,
                0.93080654,
                0.94013683,
                0.92662217,
                0.93082724,
                0.90765948,
                0.89138457,
                0.91036128,
                0.92035173,
                0.92512948,
                0.92949826,
                0.95274941,
                0.94217736,
                0.90484584,
                0.0,
                0.94877591,
                0.93783837,
                0.94403429,
                0.91132833,
                0.92232832,
                0.92207679,
                0.94674453,
                0.96078028,
                0.94754901,
                0.94208429,
                0.92881653,
                0.92126248,
                0.91871724,
                0.92973649,
                0.94163587,
                0.94030995,
                0.9612523,
                0.95991338,
                0.93815901,
                0.94877591,
                0.0,
                0.94282291,
                0.9585596,
                0.91822738,
                0.93671365,
                0.87130482,
                0.90284108,
                0.91099662,
                0.91409095,
                0.89052065,
                0.88570002,
                0.89918791,
                0.90345882,
                0.89808768,
                0.92197008,
                0.92297209,
                0.94629236,
                0.95451323,
                0.90774504,
                0.93783837,
                0.94282291,
                0.0,
                0.92143427,
                0.87693609,
                0.90230835,
                0.8934859,
                0.92267007,
                0.95528147,
                0.92800976,
                0.9244417,
                0.89923754,
                0.90028366,
                0.90571564,
                0.91627394,
                0.92696247,
                0.91890041,
                0.96761273,
                0.96696092,
                0.91473056,
                0.94403429,
                0.9585596,
                0.92143427,
                0.0,
                0.89287955,
                0.9144941,
                0.880544,
                0.88540839,
                0.91236375,
                0.90456769,
                0.90342131,
                0.88541749,
                0.89438751,
                0.9079994,
                0.78766904,
                0.87584134,
                0.9044995,
                0.9216855,
                0.91793572,
                0.88737167,
                0.91132833,
                0.91822738,
                0.87693609,
                0.89287955,
                0.0,
                0.90929944,
                0.88783813,
                0.90512104,
                0.91821961,
                0.92565113,
                0.90803448,
                0.90940434,
                0.90633035,
                0.91057331,
                0.90699173,
                0.90909282,
                0.92194312,
                0.93502909,
                0.93975883,
                0.91802788,
                0.92232832,
                0.93671365,
                0.90230835,
                0.9144941,
                0.90929944,
                0.0,
            ],
            20,
            20,
        )
        @test isapprox(mutual_infot, mutual_info)
        @test isapprox(var_infot, var_info)
    catch
    end

    @test 7 == PortfolioOptimiser._calc_num_bins(100)
    @test 16 == PortfolioOptimiser._calc_num_bins(1277)
    @test 10 == PortfolioOptimiser._calc_num_bins(1277, 0.5)
    @test 15 == PortfolioOptimiser._calc_num_bins(1731, 0.9)
    @test 10 == PortfolioOptimiser._calc_num_bins(1731, 0.1)

    portfolio.cor_method = :Mutual_Info
    portfolio.bins_info = 10
    asset_statistics!(portfolio)
    codep1 = copy(portfolio.cor)
    dist1 = copy(portfolio.dist)

    codep1t = reshape(
        [
            1.0,
            0.14954668,
            0.19628934,
            0.12630472,
            0.25144935,
            0.08626668,
            0.06045724,
            0.05135756,
            0.1157532,
            0.10672097,
            0.08130912,
            0.06593682,
            0.02037716,
            0.09094406,
            0.03690584,
            0.04763025,
            0.19483616,
            0.1199761,
            0.12976945,
            0.12423495,
            0.14954668,
            1.0,
            0.13283174,
            0.07735887,
            0.13795992,
            0.06266416,
            0.08196108,
            0.05298399,
            0.07621829,
            0.07012777,
            0.05250512,
            0.07623142,
            0.02019571,
            0.06891812,
            0.03247005,
            0.05962861,
            0.13314839,
            0.07194563,
            0.1204382,
            0.09639038,
            0.19628934,
            0.13283174,
            1.0,
            0.10554154,
            0.17275034,
            0.06115449,
            0.04674294,
            0.04287769,
            0.08505874,
            0.08320552,
            0.04944217,
            0.06077713,
            0.01989119,
            0.05565959,
            0.03121082,
            0.03629714,
            0.15232113,
            0.06726296,
            0.08539572,
            0.10031407,
            0.12630472,
            0.07735887,
            0.10554154,
            1.0,
            0.11292334,
            0.05743032,
            0.061292,
            0.02864811,
            0.06028306,
            0.06336235,
            0.03789823,
            0.05775346,
            0.02353919,
            0.05268594,
            0.02858113,
            0.04383939,
            0.10370796,
            0.05158769,
            0.06936992,
            0.0602578,
            0.25144935,
            0.13795992,
            0.17275034,
            0.11292334,
            1.0,
            0.05900722,
            0.05497041,
            0.06247948,
            0.10872189,
            0.09878894,
            0.06479535,
            0.06232161,
            0.02779032,
            0.07058202,
            0.03414318,
            0.03414994,
            0.17682199,
            0.0823681,
            0.11639074,
            0.11897662,
            0.08626668,
            0.06266416,
            0.06115449,
            0.05743032,
            0.05900722,
            1.0,
            0.03285605,
            0.05564649,
            0.1225309,
            0.10867479,
            0.08835263,
            0.09347907,
            0.04378151,
            0.10750191,
            0.03810319,
            0.04271155,
            0.10494704,
            0.09079959,
            0.13930005,
            0.07195468,
            0.06045724,
            0.08196108,
            0.04674294,
            0.061292,
            0.05497041,
            0.03285605,
            1.0,
            0.01491202,
            0.0658372,
            0.06143498,
            0.03496733,
            0.02733693,
            0.01561255,
            0.03517281,
            0.04328615,
            0.03056663,
            0.07701575,
            0.03805211,
            0.06767384,
            0.04926303,
            0.05135756,
            0.05298399,
            0.04287769,
            0.02864811,
            0.06247948,
            0.05564649,
            0.01491202,
            1.0,
            0.06089104,
            0.06221526,
            0.07319412,
            0.03693267,
            0.03753826,
            0.06474031,
            0.02040756,
            0.05824885,
            0.07211797,
            0.07731602,
            0.06479336,
            0.08910749,
            0.1157532,
            0.07621829,
            0.08505874,
            0.06028306,
            0.10872189,
            0.1225309,
            0.0658372,
            0.06089104,
            1.0,
            0.10939116,
            0.06357057,
            0.08893416,
            0.03685144,
            0.09373707,
            0.03789987,
            0.07600859,
            0.14727892,
            0.08234769,
            0.44568216,
            0.07802007,
            0.10672097,
            0.07012777,
            0.08320552,
            0.06336235,
            0.09878894,
            0.10867479,
            0.06143498,
            0.06221526,
            0.10939116,
            1.0,
            0.06277849,
            0.09599735,
            0.04161192,
            0.07887733,
            0.04039215,
            0.07216489,
            0.08701201,
            0.08958647,
            0.12308321,
            0.0815,
            0.08130912,
            0.05250512,
            0.04944217,
            0.03789823,
            0.06479535,
            0.08835263,
            0.03496733,
            0.07319412,
            0.06357057,
            0.06277849,
            1.0,
            0.05521348,
            0.02443179,
            0.09332662,
            0.02815659,
            0.0404099,
            0.07679509,
            0.06433931,
            0.08604773,
            0.06249285,
            0.06593682,
            0.07623142,
            0.06077713,
            0.05775346,
            0.06232161,
            0.09347907,
            0.02733693,
            0.03693267,
            0.08893416,
            0.09599735,
            0.05521348,
            1.0,
            0.05769486,
            0.05505694,
            0.0398884,
            0.05475564,
            0.07581463,
            0.07100158,
            0.09136901,
            0.09564218,
            0.02037716,
            0.02019571,
            0.01989119,
            0.02353919,
            0.02779032,
            0.04378151,
            0.01561255,
            0.03753826,
            0.03685144,
            0.04161192,
            0.02443179,
            0.05769486,
            1.0,
            0.03164972,
            0.03138493,
            0.05787872,
            0.01832741,
            0.02338523,
            0.03538872,
            0.02675502,
            0.09094406,
            0.06891812,
            0.05565959,
            0.05268594,
            0.07058202,
            0.10750191,
            0.03517281,
            0.06474031,
            0.09373707,
            0.07887733,
            0.09332662,
            0.05505694,
            0.03164972,
            1.0,
            0.08461569,
            0.04160473,
            0.10142572,
            0.09363948,
            0.12987279,
            0.05366647,
            0.03690584,
            0.03247005,
            0.03121082,
            0.02858113,
            0.03414318,
            0.03810319,
            0.04328615,
            0.02040756,
            0.03789987,
            0.04039215,
            0.02815659,
            0.0398884,
            0.03138493,
            0.08461569,
            1.0,
            0.03619628,
            0.03019075,
            0.02623086,
            0.03850368,
            0.03471601,
            0.04763025,
            0.05962861,
            0.03629714,
            0.04383939,
            0.03414994,
            0.04271155,
            0.03056663,
            0.05824885,
            0.07600859,
            0.07216489,
            0.0404099,
            0.05475564,
            0.05787872,
            0.04160473,
            0.03619628,
            1.0,
            0.05515481,
            0.05100358,
            0.07908779,
            0.04633906,
            0.19483616,
            0.13314839,
            0.15232113,
            0.10370796,
            0.17682199,
            0.10494704,
            0.07701575,
            0.07211797,
            0.14727892,
            0.08701201,
            0.07679509,
            0.07581463,
            0.01832741,
            0.10142572,
            0.03019075,
            0.05515481,
            1.0,
            0.11352677,
            0.15942743,
            0.12108625,
            0.1199761,
            0.07194563,
            0.06726296,
            0.05158769,
            0.0823681,
            0.09079959,
            0.03805211,
            0.07731602,
            0.08234769,
            0.08958647,
            0.06433931,
            0.07100158,
            0.02338523,
            0.09363948,
            0.02623086,
            0.05100358,
            0.11352677,
            1.0,
            0.10446825,
            0.08625062,
            0.12976945,
            0.1204382,
            0.08539572,
            0.06936992,
            0.11639074,
            0.13930005,
            0.06767384,
            0.06479336,
            0.44568216,
            0.12308321,
            0.08604773,
            0.09136901,
            0.03538872,
            0.12987279,
            0.03850368,
            0.07908779,
            0.15942743,
            0.10446825,
            1.0,
            0.0811216,
            0.12423495,
            0.09639038,
            0.10031407,
            0.0602578,
            0.11897662,
            0.07195468,
            0.04926303,
            0.08910749,
            0.07802007,
            0.0815,
            0.06249285,
            0.09564218,
            0.02675502,
            0.05366647,
            0.03471601,
            0.04633906,
            0.12108625,
            0.08625062,
            0.0811216,
            1.0,
        ],
        20,
        20,
    )
    dist1t = reshape(
        [
            0.0,
            0.93690216,
            0.89871572,
            0.9432294,
            0.86558,
            0.95829304,
            0.97103471,
            0.97481642,
            0.95214917,
            0.95818344,
            0.96424113,
            0.97061874,
            0.99107777,
            0.96163915,
            0.98490213,
            0.97595638,
            0.90684053,
            0.94509109,
            0.9393794,
            0.94003129,
            0.93690216,
            0.0,
            0.93981008,
            0.96221504,
            0.93775322,
            0.97219137,
            0.96921177,
            0.97965633,
            0.96058558,
            0.96530882,
            0.97462152,
            0.97384544,
            0.99058451,
            0.96502882,
            0.98371097,
            0.97618182,
            0.93499492,
            0.96561796,
            0.94197678,
            0.95566843,
            0.89871572,
            0.93981008,
            0.0,
            0.9493957,
            0.90601893,
            0.96874781,
            0.97927208,
            0.98045933,
            0.96249659,
            0.96502854,
            0.97695267,
            0.97494015,
            0.99066112,
            0.97507385,
            0.98627947,
            0.9829628,
            0.92313441,
            0.96771193,
            0.95802913,
            0.94866211,
            0.9432294,
            0.96221504,
            0.9493957,
            0.0,
            0.94600106,
            0.97281685,
            0.97537865,
            0.98828303,
            0.97095704,
            0.97072497,
            0.98071395,
            0.9787075,
            0.98830301,
            0.9740354,
            0.98617796,
            0.98131286,
            0.94672693,
            0.97399524,
            0.96521301,
            0.97088358,
            0.86558,
            0.93775322,
            0.90601893,
            0.94600106,
            0.0,
            0.9700477,
            0.97538072,
            0.97109238,
            0.95187378,
            0.95848478,
            0.96976281,
            0.97411598,
            0.98698076,
            0.96837852,
            0.9850645,
            0.98389185,
            0.91022003,
            0.96041209,
            0.94226205,
            0.93888656,
            0.95829304,
            0.97219137,
            0.96874781,
            0.97281685,
            0.9700477,
            0.0,
            0.98566703,
            0.97474897,
            0.94447275,
            0.95331774,
            0.95762982,
            0.9613606,
            0.97900929,
            0.95019372,
            0.98302615,
            0.98008791,
            0.94776211,
            0.95547683,
            0.92896391,
            0.9633586,
            0.97103471,
            0.96921177,
            0.97927208,
            0.97537865,
            0.97538072,
            0.98566703,
            0.0,
            0.99268068,
            0.97557631,
            0.97838622,
            0.98612569,
            0.98706979,
            0.99370778,
            0.98668905,
            0.98370763,
            0.98534104,
            0.96789956,
            0.9845295,
            0.97168942,
            0.97879568,
            0.97481642,
            0.97965633,
            0.98045933,
            0.98828303,
            0.97109238,
            0.97474897,
            0.99268068,
            0.0,
            0.97669767,
            0.97735206,
            0.9695636,
            0.98293515,
            0.98426054,
            0.97440598,
            0.99213665,
            0.97090592,
            0.96905856,
            0.96704354,
            0.97208229,
            0.95977525,
            0.95214917,
            0.96058558,
            0.96249659,
            0.97095704,
            0.95187378,
            0.94447275,
            0.97557631,
            0.97669767,
            0.0,
            0.94451183,
            0.96927496,
            0.96956214,
            0.98277908,
            0.95208386,
            0.98103282,
            0.96962959,
            0.92801415,
            0.96066995,
            0.74711472,
            0.96462258,
            0.95818344,
            0.96530882,
            0.96502854,
            0.97072497,
            0.95848478,
            0.95331774,
            0.97838622,
            0.97735206,
            0.94451183,
            0.0,
            0.97095399,
            0.96880448,
            0.98134223,
            0.96163551,
            0.98057537,
            0.97260421,
            0.96049666,
            0.95893502,
            0.94360779,
            0.96465145,
            0.96424113,
            0.97462152,
            0.97695267,
            0.98071395,
            0.96976281,
            0.95762982,
            0.98612569,
            0.9695636,
            0.96927496,
            0.97095399,
            0.0,
            0.97970211,
            0.98787254,
            0.95299154,
            0.98636475,
            0.9828299,
            0.96115069,
            0.96740809,
            0.95655474,
            0.96981973,
            0.97061874,
            0.97384544,
            0.97494015,
            0.9787075,
            0.97411598,
            0.9613606,
            0.98706979,
            0.98293515,
            0.96956214,
            0.96880448,
            0.97970211,
            0.0,
            0.97823666,
            0.98074888,
            0.98624939,
            0.97532311,
            0.97094488,
            0.97309193,
            0.96449028,
            0.96129606,
            0.99107777,
            0.99058451,
            0.99066112,
            0.98830301,
            0.98698076,
            0.97900929,
            0.99370778,
            0.98426054,
            0.98277908,
            0.98134223,
            0.98787254,
            0.97823666,
            0.0,
            0.9848499,
            0.98508609,
            0.97465565,
            0.99081632,
            0.98817244,
            0.9822275,
            0.98703629,
            0.96163915,
            0.96502882,
            0.97507385,
            0.9740354,
            0.96837852,
            0.95019372,
            0.98668905,
            0.97440598,
            0.95208386,
            0.96163551,
            0.95299154,
            0.98074888,
            0.9848499,
            0.0,
            0.95613103,
            0.98310077,
            0.95015848,
            0.95379142,
            0.93572752,
            0.97525285,
            0.98490213,
            0.98371097,
            0.98627947,
            0.98617796,
            0.9850645,
            0.98302615,
            0.98370763,
            0.99213665,
            0.98103282,
            0.98057537,
            0.98636475,
            0.98624939,
            0.98508609,
            0.95613103,
            0.0,
            0.98544903,
            0.98576899,
            0.98756194,
            0.98190188,
            0.98424844,
            0.97595638,
            0.97618182,
            0.9829628,
            0.98131286,
            0.98389185,
            0.98008791,
            0.98534104,
            0.97090592,
            0.96962959,
            0.97260421,
            0.9828299,
            0.97532311,
            0.97465565,
            0.98310077,
            0.98544903,
            0.0,
            0.97568049,
            0.9777406,
            0.96449846,
            0.97878044,
            0.90684053,
            0.93499492,
            0.92313441,
            0.94672693,
            0.91022003,
            0.94776211,
            0.96789956,
            0.96905856,
            0.92801415,
            0.96049666,
            0.96115069,
            0.97094488,
            0.99081632,
            0.95015848,
            0.98576899,
            0.97568049,
            0.0,
            0.94028126,
            0.91396334,
            0.93804669,
            0.94509109,
            0.96561796,
            0.96771193,
            0.97399524,
            0.96041209,
            0.95547683,
            0.9845295,
            0.96704354,
            0.96066995,
            0.95893502,
            0.96740809,
            0.97309193,
            0.98817244,
            0.95379142,
            0.98756194,
            0.9777406,
            0.94028126,
            0.0,
            0.9456661,
            0.95698142,
            0.9393794,
            0.94197678,
            0.95802913,
            0.96521301,
            0.94226205,
            0.92896391,
            0.97168942,
            0.97208229,
            0.74711472,
            0.94360779,
            0.95655474,
            0.96449028,
            0.9822275,
            0.93572752,
            0.98190188,
            0.96449846,
            0.91396334,
            0.9456661,
            0.0,
            0.95905472,
            0.94003129,
            0.95566843,
            0.94866211,
            0.97088358,
            0.93888656,
            0.9633586,
            0.97879568,
            0.95977525,
            0.96462258,
            0.96465145,
            0.96981973,
            0.96129606,
            0.98703629,
            0.97525285,
            0.98424844,
            0.97878044,
            0.93804669,
            0.95698142,
            0.95905472,
            0.0,
        ],
        20,
        20,
    )

    @test isapprox(codep1, codep1t)
    @test isapprox(dist1, dist1t)

    portfolio.bins_info = :HGR
    asset_statistics!(portfolio)
    codep2 = copy(portfolio.cor)
    dist2 = copy(portfolio.dist)

    codep2t = reshape(
        [
            0.9999999999999998,
            0.1530754744141812,
            0.19628934319876548,
            0.10589303624550223,
            0.25144935188243756,
            0.07853648943882165,
            0.040641948686635766,
            0.08224322900487711,
            0.11076950023583379,
            0.08486688965333784,
            0.06722975340798382,
            0.06078214391785325,
            0.031495016463990395,
            0.06907819808224165,
            0.03690631504957675,
            0.061947497308108494,
            0.17269034538199476,
            0.09488406320336573,
            0.11910318956770194,
            0.1088008061112871,
            0.1530754744141812,
            1.0000000000000002,
            0.12272122979458597,
            0.08112944971482144,
            0.12096741621834586,
            0.07970248674738098,
            0.061560478116053884,
            0.0653606801741681,
            0.08597081671249988,
            0.06609119157004369,
            0.05407427376684516,
            0.05704562065407237,
            0.017908828368974578,
            0.07358887654892776,
            0.037599878117194466,
            0.066351721325714,
            0.1211264989886337,
            0.07515557773514905,
            0.10397647404701832,
            0.09332212469895618,
            0.19628934319876548,
            0.12272122979458597,
            1.0,
            0.08454310323419544,
            0.18136865234937488,
            0.05744947131725143,
            0.03656932882826914,
            0.030556030796119106,
            0.08064260491522009,
            0.07504346703757103,
            0.05230056134855728,
            0.04956031250360011,
            0.014806066469779664,
            0.04537983927035697,
            0.01960056695477899,
            0.04597020090999914,
            0.15486687382680547,
            0.06405473339323266,
            0.08625929090739971,
            0.09360271988336134,
            0.10589303624550223,
            0.08112944971482144,
            0.08454310323419544,
            0.9999999999999998,
            0.10384802498840355,
            0.07034621691330716,
            0.054352305463214054,
            0.038541021237988575,
            0.0671474424602008,
            0.06969279380063714,
            0.035220863667615114,
            0.04405270803123097,
            0.022336155556543447,
            0.04096428726967342,
            0.028029708064984393,
            0.03931338281853347,
            0.09523258956679923,
            0.05047624997083074,
            0.0649788719299809,
            0.054343881874859445,
            0.25144935188243756,
            0.12096741621834586,
            0.18136865234937488,
            0.10384802498840355,
            1.0,
            0.06493272444232116,
            0.031204738012092673,
            0.05458982385326778,
            0.10303266562186682,
            0.08189842221943532,
            0.050217169449139815,
            0.05411156487369912,
            0.01773385494597808,
            0.05409085052222735,
            0.04474396007279351,
            0.04784025796024376,
            0.16683823194866979,
            0.07771686179638165,
            0.10638592293296975,
            0.11088809824216905,
            0.07853648943882165,
            0.07970248674738098,
            0.05744947131725143,
            0.07034621691330716,
            0.06493272444232116,
            1.0000000000000002,
            0.03554001342654513,
            0.05288983555905038,
            0.1113764584332062,
            0.12103218361511972,
            0.0953977152456606,
            0.0648047272574917,
            0.03177880922687268,
            0.10758541387052269,
            0.03880894324716876,
            0.04001737815936199,
            0.12013137070280126,
            0.08369425334100185,
            0.14084991202957467,
            0.08168701908796804,
            0.040641948686635766,
            0.061560478116053884,
            0.03656932882826914,
            0.054352305463214054,
            0.031204738012092673,
            0.03554001342654513,
            1.0,
            0.014272489647485362,
            0.05313326756455857,
            0.05628720480769363,
            0.026005804532202748,
            0.017307372603625915,
            0.015913012569573066,
            0.03814251350902736,
            0.036590529784330895,
            0.02306024981899034,
            0.045924506024204136,
            0.026414059729802195,
            0.04465285794634932,
            0.03295602826908841,
            0.08224322900487711,
            0.0653606801741681,
            0.030556030796119106,
            0.038541021237988575,
            0.05458982385326778,
            0.05288983555905038,
            0.014272489647485362,
            1.0,
            0.05767408663228033,
            0.07152788439982746,
            0.0791806140750865,
            0.030197971256699895,
            0.04360856904108478,
            0.05782925959064346,
            0.029043127940275148,
            0.05341769594063686,
            0.05569188406022925,
            0.0855454985507324,
            0.06450283451588722,
            0.061863439764229894,
            0.11076950023583379,
            0.08597081671249988,
            0.08064260491522009,
            0.0671474424602008,
            0.10303266562186682,
            0.1113764584332062,
            0.05313326756455857,
            0.05767408663228033,
            1.0000000000000002,
            0.10851978194139426,
            0.04993313925227879,
            0.08673115837009603,
            0.03948549174567447,
            0.10280521332250792,
            0.04804168884544268,
            0.09178806472131047,
            0.1476095501317935,
            0.09469122032669054,
            0.417148373242872,
            0.09434883995729795,
            0.08486688965333784,
            0.06609119157004369,
            0.07504346703757103,
            0.06969279380063714,
            0.08189842221943532,
            0.12103218361511972,
            0.05628720480769363,
            0.07152788439982746,
            0.10851978194139426,
            1.0000000000000002,
            0.059387934248279636,
            0.09031680558198374,
            0.030611704948931204,
            0.07811444122317794,
            0.040974509844390196,
            0.08332822686449388,
            0.08579919008139354,
            0.07662470438531381,
            0.12851998194699743,
            0.07871844287603194,
            0.06722975340798382,
            0.05407427376684516,
            0.05230056134855728,
            0.035220863667615114,
            0.050217169449139815,
            0.0953977152456606,
            0.026005804532202748,
            0.0791806140750865,
            0.04993313925227879,
            0.059387934248279636,
            1.0000000000000002,
            0.051073089087156034,
            0.0241442486209061,
            0.07693380542910025,
            0.029155761082441084,
            0.05251264922501626,
            0.06565585898967097,
            0.06098585410885371,
            0.07160433297445808,
            0.06214140403849886,
            0.06078214391785325,
            0.05704562065407237,
            0.04956031250360011,
            0.04405270803123097,
            0.05411156487369912,
            0.0648047272574917,
            0.017307372603625915,
            0.030197971256699895,
            0.08673115837009603,
            0.09031680558198374,
            0.051073089087156034,
            1.0,
            0.03812834008773618,
            0.06357880565074006,
            0.03562713271790638,
            0.04700917503600213,
            0.06419277691804326,
            0.05755557762283553,
            0.08258139485186058,
            0.09596459767677774,
            0.031495016463990395,
            0.017908828368974578,
            0.014806066469779664,
            0.022336155556543447,
            0.01773385494597808,
            0.03177880922687268,
            0.015913012569573066,
            0.04360856904108478,
            0.03948549174567447,
            0.030611704948931204,
            0.0241442486209061,
            0.03812834008773618,
            0.9999999999999999,
            0.023266351205083968,
            0.027170948374730084,
            0.04783470131421554,
            0.022168919251818797,
            0.022056505402465797,
            0.02899517732785649,
            0.031481925964309154,
            0.06907819808224165,
            0.07358887654892776,
            0.04537983927035697,
            0.04096428726967342,
            0.05409085052222735,
            0.10758541387052269,
            0.03814251350902736,
            0.05782925959064346,
            0.10280521332250792,
            0.07811444122317794,
            0.07693380542910025,
            0.06357880565074006,
            0.023266351205083968,
            1.0,
            0.08030748884175747,
            0.05748261105587506,
            0.09912416440680558,
            0.08804136462310465,
            0.13041702439189978,
            0.06702953932778251,
            0.03690631504957675,
            0.037599878117194466,
            0.01960056695477899,
            0.028029708064984393,
            0.04474396007279351,
            0.03880894324716876,
            0.036590529784330895,
            0.029043127940275148,
            0.04804168884544268,
            0.040974509844390196,
            0.029155761082441084,
            0.03562713271790638,
            0.027170948374730084,
            0.08030748884175747,
            1.0,
            0.030520160111151894,
            0.027059748029242485,
            0.020921388732785755,
            0.04792613205440085,
            0.0408607438677054,
            0.061947497308108494,
            0.066351721325714,
            0.04597020090999914,
            0.03931338281853347,
            0.04784025796024376,
            0.04001737815936199,
            0.02306024981899034,
            0.05341769594063686,
            0.09178806472131047,
            0.08332822686449388,
            0.05251264922501626,
            0.04700917503600213,
            0.04783470131421554,
            0.05748261105587506,
            0.030520160111151894,
            1.0,
            0.07422693272344734,
            0.05876332501514898,
            0.09984634348753525,
            0.08090685997054564,
            0.17269034538199476,
            0.1211264989886337,
            0.15486687382680547,
            0.09523258956679923,
            0.16683823194866979,
            0.12013137070280126,
            0.045924506024204136,
            0.05569188406022925,
            0.1476095501317935,
            0.08579919008139354,
            0.06565585898967097,
            0.06419277691804326,
            0.022168919251818797,
            0.09912416440680558,
            0.027059748029242485,
            0.07422693272344734,
            0.9999999999999999,
            0.10146685153782961,
            0.16200339878251627,
            0.11582535981213872,
            0.09488406320336573,
            0.07515557773514905,
            0.06405473339323266,
            0.05047624997083074,
            0.07771686179638165,
            0.08369425334100185,
            0.026414059729802195,
            0.0855454985507324,
            0.09469122032669054,
            0.07662470438531381,
            0.06098585410885371,
            0.05755557762283553,
            0.022056505402465797,
            0.08804136462310465,
            0.020921388732785755,
            0.05876332501514898,
            0.10146685153782961,
            1.0,
            0.1037986116747915,
            0.08576777434209726,
            0.11910318956770194,
            0.10397647404701832,
            0.08625929090739971,
            0.0649788719299809,
            0.10638592293296975,
            0.14084991202957467,
            0.04465285794634932,
            0.06450283451588722,
            0.417148373242872,
            0.12851998194699743,
            0.07160433297445808,
            0.08258139485186058,
            0.02899517732785649,
            0.13041702439189978,
            0.04792613205440085,
            0.09984634348753525,
            0.16200339878251627,
            0.1037986116747915,
            1.0,
            0.10612228593073185,
            0.1088008061112871,
            0.09332212469895618,
            0.09360271988336134,
            0.054343881874859445,
            0.11088809824216905,
            0.08168701908796804,
            0.03295602826908841,
            0.061863439764229894,
            0.09434883995729795,
            0.07871844287603194,
            0.06214140403849886,
            0.09596459767677774,
            0.031481925964309154,
            0.06702953932778251,
            0.0408607438677054,
            0.08090685997054564,
            0.11582535981213872,
            0.08576777434209726,
            0.10612228593073185,
            1.0000000000000002,
        ],
        20,
        20,
    )
    dist2t = reshape(
        [
            3.513426793965042e-16,
            0.9359282023295074,
            0.8987157191361307,
            0.952394869320836,
            0.8655800015634705,
            0.9614999783820821,
            0.9805495168647972,
            0.9609570666913485,
            0.9554639068188902,
            0.9679493615107618,
            0.9711554584769578,
            0.9716995268419243,
            0.9861218732899503,
            0.9716302062038094,
            0.9852335108808902,
            0.9696606591872479,
            0.9202017324807799,
            0.9577856565355365,
            0.9473109604274276,
            0.948580792317271,
            0.9359282023295074,
            0.0,
            0.9459570777619772,
            0.9609609279252914,
            0.946641480506614,
            0.9653343384633991,
            0.9770412968537149,
            0.9763861037693903,
            0.955916516610335,
            0.9678775617222652,
            0.9736104556863159,
            0.9796754978784614,
            0.9917378796986006,
            0.9622971205367951,
            0.9808776822599038,
            0.9748274807805499,
            0.9404064491220272,
            0.963755066364079,
            0.9483702483833918,
            0.9569123228756559,
            0.8987157191361307,
            0.9459570777619772,
            0.0,
            0.9600743454437781,
            0.9004885464840378,
            0.970586650102403,
            0.9834838095223759,
            0.9866274832632764,
            0.9658766733968731,
            0.969870349334965,
            0.9763444848792109,
            0.9783380348913879,
            0.9931475047563859,
            0.9803859012864606,
            0.9917246270043409,
            0.9788696462629797,
            0.9245672174285665,
            0.9701943525948417,
            0.9600714958278559,
            0.9535029184075106,
            0.952394869320836,
            0.9609609279252914,
            0.9600743454437781,
            5.438299591664849e-16,
            0.9503942554081419,
            0.9668032772759412,
            0.9778070812542531,
            0.9848431746319128,
            0.9685352643547439,
            0.9687874995095221,
            0.982526438256096,
            0.9828163745847202,
            0.988833403775728,
            0.980396200436247,
            0.9868205682870147,
            0.9838151669767605,
            0.9501305640091122,
            0.9742302486428448,
            0.9670505865054918,
            0.9732536992241855,
            0.8655800015634705,
            0.946641480506614,
            0.9004885464840378,
            0.9503942554081419,
            0.0,
            0.9665589624734087,
            0.9859720382890556,
            0.9759108932847904,
            0.9558781503011723,
            0.9669451887648178,
            0.9772569863344579,
            0.9763564514436722,
            0.9917636432624302,
            0.9764777700314266,
            0.9808616697011687,
            0.9780400113409443,
            0.9180683376009593,
            0.9635240672024679,
            0.9501775455598228,
            0.944317578797494,
            0.9614999783820821,
            0.9653343384633991,
            0.970586650102403,
            0.9668032772759412,
            0.9665589624734087,
            0.0,
            0.9840518328772244,
            0.9767683937588914,
            0.9519380756072852,
            0.9501562802858908,
            0.9557225764970106,
            0.9716621757623741,
            0.985089821884182,
            0.9519093692335804,
            0.983377601131981,
            0.981764576687041,
            0.9421075846838738,
            0.9604597577943534,
            0.932692898632839,
            0.9594276651069048,
            0.9805495168647972,
            0.9770412968537149,
            0.9834838095223759,
            0.9778070812542531,
            0.9859720382890556,
            0.9840518328772244,
            0.0,
            0.992995291655069,
            0.9806984331710514,
            0.980603996329879,
            0.989817357741955,
            0.9915657789310143,
            0.9935162556498306,
            0.9856693422072846,
            0.9864458759068943,
            0.9884747248322115,
            0.981368115933431,
            0.9893956828582454,
            0.9822418397954588,
            0.9859833389172236,
            0.9609570666913485,
            0.9763861037693903,
            0.9866274832632764,
            0.9848431746319128,
            0.9759108932847904,
            0.9767683937588914,
            0.992995291655069,
            0.0,
            0.9797054743044533,
            0.9760636663898231,
            0.9693412928344498,
            0.9847980870675127,
            0.9825760700996399,
            0.9788172133063741,
            0.9896167681427471,
            0.9736020150564106,
            0.978016663329539,
            0.965923373395546,
            0.9749548038953046,
            0.9741593552207081,
            0.9554639068188902,
            0.955916516610335,
            0.9658766733968731,
            0.9685352643547439,
            0.9558781503011723,
            0.9519380756072852,
            0.9806984331710514,
            0.9797054743044533,
            0.0,
            0.9450767997969861,
            0.9761439617992929,
            0.9695084973993622,
            0.9819607446307803,
            0.9475394014227112,
            0.9758843067746281,
            0.9656479659058222,
            0.9279168989840758,
            0.9548129813668539,
            0.7603530973581111,
            0.9573152140963332,
            0.9679493615107618,
            0.9678775617222652,
            0.969870349334965,
            0.9687874995095221,
            0.9669451887648178,
            0.9501562802858908,
            0.980603996329879,
            0.9760636663898231,
            0.9450767997969861,
            0.0,
            0.9727588405370213,
            0.969932240905609,
            0.9866984819840857,
            0.9623361921266932,
            0.9803663775610003,
            0.9705475402462646,
            0.9611843628646519,
            0.9653911666653411,
            0.9395903987022349,
            0.9663029819968985,
            0.9711554584769578,
            0.9736104556863159,
            0.9763444848792109,
            0.982526438256096,
            0.9772569863344579,
            0.9557225764970106,
            0.989817357741955,
            0.9693412928344498,
            0.9761439617992929,
            0.9727588405370213,
            0.0,
            0.9806426563997902,
            0.9882251563897844,
            0.9615118241838279,
            0.9859132656528304,
            0.9789152063470926,
            0.9668427683064378,
            0.9692037902639319,
            0.9631234292093326,
            0.9701143000787945,
            0.9716995268419243,
            0.9796754978784614,
            0.9783380348913879,
            0.9828163745847202,
            0.9763564514436722,
            0.9716621757623741,
            0.9915657789310143,
            0.9847980870675127,
            0.9695084973993622,
            0.969932240905609,
            0.9806426563997902,
            0.0,
            0.9849535108391516,
            0.9769143636270985,
            0.9873705283898638,
            0.9770451715738011,
            0.9748395398358594,
            0.9775608204419094,
            0.9680498489015361,
            0.9597495241819008,
            0.9861218732899503,
            0.9917378796986006,
            0.9931475047563859,
            0.988833403775728,
            0.9917636432624302,
            0.985089821884182,
            0.9935162556498306,
            0.9825760700996399,
            0.9819607446307803,
            0.9866984819840857,
            0.9882251563897844,
            0.9849535108391516,
            2.7784930593378698e-16,
            0.9890914785029669,
            0.9873842705163143,
            0.9799691512247647,
            0.9889454631496751,
            0.9890264495781593,
            0.9857272258026344,
            0.984496881069065,
            0.9716302062038094,
            0.9622971205367951,
            0.9803859012864606,
            0.980396200436247,
            0.9764777700314266,
            0.9519093692335804,
            0.9856693422072846,
            0.9788172133063741,
            0.9475394014227112,
            0.9623361921266932,
            0.9615118241838279,
            0.9769143636270985,
            0.9890914785029669,
            0.0,
            0.958628407079126,
            0.9779132516984583,
            0.9510732170863756,
            0.9566769847927099,
            0.9334524337535889,
            0.9689817060879898,
            0.9852335108808902,
            0.9808776822599038,
            0.9917246270043409,
            0.9868205682870147,
            0.9808616697011687,
            0.983377601131981,
            0.9864458759068943,
            0.9896167681427471,
            0.9758843067746281,
            0.9803663775610003,
            0.9859132656528304,
            0.9873705283898638,
            0.9873842705163143,
            0.958628407079126,
            0.0,
            0.988548331182423,
            0.9872488926555977,
            0.9901469384889365,
            0.9767981177795066,
            0.981539855701286,
            0.9696606591872479,
            0.9748274807805499,
            0.9788696462629797,
            0.9838151669767605,
            0.9780400113409443,
            0.981764576687041,
            0.9884747248322115,
            0.9736020150564106,
            0.9656479659058222,
            0.9705475402462646,
            0.9789152063470926,
            0.9770451715738011,
            0.9799691512247647,
            0.9779132516984583,
            0.988548331182423,
            0.0,
            0.9690884026256196,
            0.9757487922109113,
            0.9587906975384519,
            0.9643729867976915,
            0.9202017324807799,
            0.9404064491220272,
            0.9245672174285665,
            0.9501305640091122,
            0.9180683376009593,
            0.9421075846838738,
            0.981368115933431,
            0.978016663329539,
            0.9279168989840758,
            0.9611843628646519,
            0.9668427683064378,
            0.9748395398358594,
            0.9889454631496751,
            0.9510732170863756,
            0.9872488926555977,
            0.9690884026256196,
            2.7529741230132787e-16,
            0.9466765932143095,
            0.9133684747106859,
            0.9413731634486829,
            0.9577856565355365,
            0.963755066364079,
            0.9701943525948417,
            0.9742302486428448,
            0.9635240672024679,
            0.9604597577943534,
            0.9893956828582454,
            0.965923373395546,
            0.9548129813668539,
            0.9653911666653411,
            0.9692037902639319,
            0.9775608204419094,
            0.9890264495781593,
            0.9566769847927099,
            0.9901469384889365,
            0.9757487922109113,
            0.9466765932143095,
            0.0,
            0.9460447072594984,
            0.9573382696746403,
            0.9473109604274276,
            0.9483702483833918,
            0.9600714958278559,
            0.9670505865054918,
            0.9501775455598228,
            0.932692898632839,
            0.9822418397954588,
            0.9749548038953046,
            0.7603530973581111,
            0.9395903987022349,
            0.9631234292093326,
            0.9680498489015361,
            0.9857272258026344,
            0.9334524337535889,
            0.9767981177795066,
            0.9587906975384519,
            0.9133684747106859,
            0.9460447072594984,
            0.0,
            0.947472058170158,
            0.948580792317271,
            0.9569123228756559,
            0.9535029184075106,
            0.9732536992241855,
            0.944317578797494,
            0.9594276651069048,
            0.9859833389172236,
            0.9741593552207081,
            0.9573152140963332,
            0.9663029819968985,
            0.9701143000787945,
            0.9597495241819008,
            0.984496881069065,
            0.9689817060879898,
            0.981539855701286,
            0.9643729867976915,
            0.9413731634486829,
            0.9573382696746403,
            0.947472058170158,
            0.0,
        ],
        20,
        20,
    )

    @test isapprox(codep2, codep2t)
    @test isapprox(dist2, dist2t)

    portfolio.cor_method = :Tail
    asset_statistics!(portfolio)
    tail = portfolio.cor

    pearsont = reshape(
        [
            1.0,
            0.4651842333328937,
            0.6057125142402463,
            0.40762801198941984,
            0.6007283292568202,
            0.3198674217714188,
            0.13980685060136308,
            0.22545693109273,
            0.37609316223969863,
            0.31701730135611267,
            0.2710058473717296,
            0.2655734568571606,
            0.05610318650837941,
            0.30702756646908064,
            0.05361736103783228,
            0.15373730281804923,
            0.5334873896372292,
            0.36818175916637885,
            0.4005150923184833,
            0.45630606211976094,
            0.4651842333328937,
            1.0,
            0.4679234223759625,
            0.3249673502808304,
            0.40536510518834645,
            0.2989528354747097,
            0.22057192005350237,
            0.24463464167865565,
            0.390242225643119,
            0.3344674294181327,
            0.2799482223134466,
            0.23625712805062382,
            0.11142192157859834,
            0.33806398778842883,
            0.11808840599758612,
            0.22732669672564298,
            0.49947448009023054,
            0.31720499483187437,
            0.4333140506300871,
            0.3919434386695615,
            0.6057125142402463,
            0.4679234223759625,
            1.0,
            0.37174237939134214,
            0.5254251455186676,
            0.31239198910026345,
            0.17981078868703523,
            0.18841708989484043,
            0.35440522621916376,
            0.3042728983335884,
            0.2368926505098415,
            0.3234952093176083,
            0.08251797295992715,
            0.27299943603765836,
            0.08582236358846955,
            0.15656783425378626,
            0.4973675057064263,
            0.30617967799104223,
            0.37294965947864245,
            0.4367939957300974,
            0.40762801198941984,
            0.3249673502808304,
            0.37174237939134214,
            1.0,
            0.36406487945095894,
            0.24309813377816114,
            0.24695035335897475,
            0.13537663037557346,
            0.29422135595764504,
            0.2612399759136344,
            0.13914586320858327,
            0.20847570199698828,
            0.11383172809294834,
            0.2348008761076984,
            0.15276782269490824,
            0.17312782198030055,
            0.39566793689867685,
            0.2362271362987392,
            0.31038597430688003,
            0.27496210817361394,
            0.6007283292568202,
            0.40536510518834645,
            0.5254251455186676,
            0.36406487945095894,
            1.0,
            0.2120952543113977,
            0.16348150078944515,
            0.15818434083186686,
            0.29148707164871324,
            0.23239147490904064,
            0.19965576261418652,
            0.2463853676693437,
            0.024238491565442805,
            0.23483256964507096,
            0.13510967823989825,
            0.13959742249101284,
            0.4505533175081079,
            0.23109203619782018,
            0.30408040693066246,
            0.4367958927859396,
            0.3198674217714188,
            0.2989528354747097,
            0.31239198910026345,
            0.24309813377816114,
            0.2120952543113977,
            1.0,
            0.17406024353790345,
            0.22372615054486208,
            0.4479338481714031,
            0.41582030499268774,
            0.3842069521965308,
            0.30000028103018744,
            0.19519279322053606,
            0.43312263234089793,
            0.23867490474241268,
            0.15856958857720854,
            0.3794032705848954,
            0.37995935227758887,
            0.5016688137311583,
            0.3652353511852042,
            0.13980685060136308,
            0.22057192005350237,
            0.17981078868703523,
            0.24695035335897475,
            0.16348150078944515,
            0.17406024353790345,
            1.0,
            0.08701084969575291,
            0.24858569835966748,
            0.21882891723891004,
            0.1547238621961266,
            0.09805353533905745,
            0.07821959872479427,
            0.18432464773238932,
            0.1881739102118061,
            0.13148458148596273,
            0.25237614743765824,
            0.16534406352832703,
            0.22828466335505312,
            0.10498126987336069,
            0.22545693109273,
            0.24463464167865565,
            0.18841708989484043,
            0.13537663037557346,
            0.15818434083186686,
            0.22372615054486208,
            0.08701084969575291,
            1.0,
            0.19482814476602453,
            0.24977636025157618,
            0.32296840702609114,
            0.18845278864241077,
            0.19811371330165756,
            0.2251594813907211,
            0.05174592137652584,
            0.20088702313922055,
            0.2823197933938334,
            0.31501720621986595,
            0.2716602732179378,
            0.30348714452042586,
            0.37609316223969863,
            0.390242225643119,
            0.35440522621916376,
            0.29422135595764504,
            0.29148707164871324,
            0.4479338481714031,
            0.24858569835966748,
            0.19482814476602453,
            1.0,
            0.4854199983366868,
            0.2740444946923863,
            0.32081806164025833,
            0.2025937878007308,
            0.45891057801057933,
            0.25837860559141584,
            0.3170004277249205,
            0.5186283919577853,
            0.42252533669172726,
            0.8902291777036442,
            0.3729551547265569,
            0.31701730135611267,
            0.3344674294181327,
            0.3042728983335884,
            0.2612399759136344,
            0.23239147490904064,
            0.41582030499268774,
            0.21882891723891004,
            0.24977636025157618,
            0.4854199983366868,
            1.0,
            0.297636307243898,
            0.30911545802351886,
            0.21191238940613044,
            0.35118268869830227,
            0.21168527993409647,
            0.28531209548790504,
            0.38687431236934383,
            0.34946478440574774,
            0.5100035829557179,
            0.3566546146821851,
            0.2710058473717296,
            0.2799482223134466,
            0.2368926505098415,
            0.13914586320858327,
            0.19965576261418652,
            0.3842069521965308,
            0.1547238621961266,
            0.32296840702609114,
            0.2740444946923863,
            0.297636307243898,
            1.0,
            0.17913226997959855,
            0.1301420955130662,
            0.39452988958803653,
            0.1933464953915291,
            0.17467813682930874,
            0.32602711601449896,
            0.3287465233944562,
            0.36834849257726127,
            0.2797705897370372,
            0.2655734568571606,
            0.23625712805062382,
            0.3234952093176083,
            0.20847570199698828,
            0.2463853676693437,
            0.30000028103018744,
            0.09805353533905745,
            0.18845278864241077,
            0.32081806164025833,
            0.30911545802351886,
            0.17913226997959855,
            1.0,
            0.19639947507631111,
            0.23760728339164755,
            0.15576389484625175,
            0.23012958915724335,
            0.2744979057203696,
            0.23257446855218897,
            0.3370284614401489,
            0.3236650393250739,
            0.05610318650837941,
            0.11142192157859834,
            0.08251797295992715,
            0.11383172809294834,
            0.024238491565442805,
            0.19519279322053606,
            0.07821959872479427,
            0.19811371330165756,
            0.2025937878007308,
            0.21191238940613044,
            0.1301420955130662,
            0.19639947507631111,
            1.0,
            0.148220931287248,
            0.15947855549214807,
            0.23592815391170488,
            0.10613586887539042,
            0.11470320709193528,
            0.16723710959249433,
            0.17092360722783093,
            0.30702756646908064,
            0.33806398778842883,
            0.27299943603765836,
            0.2348008761076984,
            0.23483256964507096,
            0.43312263234089793,
            0.18432464773238932,
            0.2251594813907211,
            0.45891057801057933,
            0.35118268869830227,
            0.39452988958803653,
            0.23760728339164755,
            0.148220931287248,
            1.0,
            0.4090481800686874,
            0.17553470218807768,
            0.42187414285181146,
            0.38709714508134124,
            0.5384016805448939,
            0.26667980117289164,
            0.05361736103783228,
            0.11808840599758612,
            0.08582236358846955,
            0.15276782269490824,
            0.13510967823989825,
            0.23867490474241268,
            0.1881739102118061,
            0.05174592137652584,
            0.25837860559141584,
            0.21168527993409647,
            0.1933464953915291,
            0.15576389484625175,
            0.15947855549214807,
            0.4090481800686874,
            1.0,
            0.1615606504947503,
            0.16685525751304114,
            0.1080793937275288,
            0.2714672756651635,
            0.0887178221509978,
            0.15373730281804923,
            0.22732669672564298,
            0.15656783425378626,
            0.17312782198030055,
            0.13959742249101284,
            0.15856958857720854,
            0.13148458148596273,
            0.20088702313922055,
            0.3170004277249205,
            0.28531209548790504,
            0.17467813682930874,
            0.23012958915724335,
            0.23592815391170488,
            0.17553470218807768,
            0.1615606504947503,
            1.0,
            0.26101919277235813,
            0.1985383556313028,
            0.3028009839746978,
            0.2703442605531704,
            0.5334873896372292,
            0.49947448009023054,
            0.4973675057064263,
            0.39566793689867685,
            0.4505533175081079,
            0.3794032705848954,
            0.25237614743765824,
            0.2823197933938334,
            0.5186283919577853,
            0.38687431236934383,
            0.32602711601449896,
            0.2744979057203696,
            0.10613586887539042,
            0.42187414285181146,
            0.16685525751304114,
            0.26101919277235813,
            1.0,
            0.4352478359688786,
            0.56766932426283,
            0.48304218985008474,
            0.36818175916637885,
            0.31720499483187437,
            0.30617967799104223,
            0.2362271362987392,
            0.23109203619782018,
            0.37995935227758887,
            0.16534406352832703,
            0.31501720621986595,
            0.42252533669172726,
            0.34946478440574774,
            0.3287465233944562,
            0.23257446855218897,
            0.11470320709193528,
            0.38709714508134124,
            0.1080793937275288,
            0.1985383556313028,
            0.4352478359688786,
            1.0,
            0.48170301863322207,
            0.32116995203853244,
            0.4005150923184833,
            0.4333140506300871,
            0.37294965947864245,
            0.31038597430688003,
            0.30408040693066246,
            0.5016688137311583,
            0.22828466335505312,
            0.2716602732179378,
            0.8902291777036442,
            0.5100035829557179,
            0.36834849257726127,
            0.3370284614401489,
            0.16723710959249433,
            0.5384016805448939,
            0.2714672756651635,
            0.3028009839746978,
            0.56766932426283,
            0.48170301863322207,
            1.0,
            0.41494299334691986,
            0.45630606211976094,
            0.3919434386695615,
            0.4367939957300974,
            0.27496210817361394,
            0.4367958927859396,
            0.3652353511852042,
            0.10498126987336069,
            0.30348714452042586,
            0.3729551547265569,
            0.3566546146821851,
            0.2797705897370372,
            0.3236650393250739,
            0.17092360722783093,
            0.26667980117289164,
            0.0887178221509978,
            0.2703442605531704,
            0.48304218985008474,
            0.32116995203853244,
            0.41494299334691986,
            1.0,
        ],
        20,
        20,
    )
    spearmant = reshape(
        [
            1.0,
            0.4788395514998828,
            0.6194175358237134,
            0.4459162681697528,
            0.6674964146451202,
            0.3337094081734166,
            0.27347009181744314,
            0.30334196378081013,
            0.37852172949294954,
            0.32630125334354554,
            0.2979125269128625,
            0.31522428373157074,
            0.0546980651744615,
            0.29428598664262806,
            0.061500193798754384,
            0.24027070007963416,
            0.5669374421433647,
            0.3907557356672236,
            0.4100442526928417,
            0.46133468883857304,
            0.4788395514998828,
            1.0,
            0.46252144057354433,
            0.36079246589368286,
            0.45055878392794857,
            0.33201501394734084,
            0.3183824463020067,
            0.2683360661831083,
            0.37524743367235663,
            0.327560285652259,
            0.27724710968799315,
            0.30994093582448645,
            0.1205762856801738,
            0.3270787854530462,
            0.15204495757896505,
            0.26559193912836626,
            0.4761795635821235,
            0.32949299854393155,
            0.4169305356624902,
            0.38066921983731633,
            0.6194175358237134,
            0.46252144057354433,
            1.0,
            0.4246082196221759,
            0.5848605391500088,
            0.2863966527551661,
            0.25291124643523405,
            0.21321769475611083,
            0.33353782849681585,
            0.2877878387947832,
            0.22110464096774476,
            0.3075478028922607,
            0.08847692268860427,
            0.22647415261836268,
            0.06626301818696304,
            0.17537740560747345,
            0.5241532869139222,
            0.30986205479616397,
            0.34694305762530264,
            0.4297702646473715,
            0.4459162681697528,
            0.36079246589368286,
            0.4246082196221759,
            1.0,
            0.41602240890357123,
            0.2586273750457479,
            0.3061105258443722,
            0.18594887760040496,
            0.30271312647162185,
            0.2693426050524056,
            0.17182808021869556,
            0.28257942363389316,
            0.1294407037556759,
            0.25528718544826556,
            0.1587309174027054,
            0.2168120884017062,
            0.4265847559795607,
            0.25523961205493834,
            0.3191647126032973,
            0.30453402843247707,
            0.6674964146451202,
            0.45055878392794857,
            0.5848605391500088,
            0.41602240890357123,
            1.0,
            0.2896668813056614,
            0.26023910151271085,
            0.2788292087196651,
            0.31501367120602036,
            0.2606283616457919,
            0.2536671832138812,
            0.2991825284309526,
            0.051952413377779776,
            0.25822159855119603,
            0.11651792442319496,
            0.20891167217379442,
            0.5398072858345281,
            0.3030065768796285,
            0.35569692639130146,
            0.45252022234607814,
            0.3337094081734166,
            0.33201501394734084,
            0.2863966527551661,
            0.2586273750457479,
            0.2896668813056614,
            1.0,
            0.21358336660547012,
            0.30437739641383543,
            0.47039951982718725,
            0.4483197781132795,
            0.40288969305534716,
            0.37581972248869483,
            0.23922809574523632,
            0.45204738240431497,
            0.21424585634243234,
            0.25150319166879803,
            0.4002696283133453,
            0.3815191136490659,
            0.5006092808351847,
            0.38223456263980166,
            0.27347009181744314,
            0.3183824463020067,
            0.25291124643523405,
            0.3061105258443722,
            0.26023910151271085,
            0.21358336660547012,
            1.0,
            0.1458529955616399,
            0.27544550680279223,
            0.2566153767556413,
            0.16765436834335523,
            0.16802283609251237,
            0.12701837380257658,
            0.22437100511128225,
            0.18327809626852945,
            0.1811295324471806,
            0.302986502584987,
            0.19578502952436938,
            0.27366200982564837,
            0.1872277074615232,
            0.30334196378081013,
            0.2683360661831083,
            0.21321769475611083,
            0.18594887760040496,
            0.2788292087196651,
            0.30437739641383543,
            0.1458529955616399,
            1.0,
            0.21712801529884068,
            0.2723829511100927,
            0.36396368683105496,
            0.23314913972678505,
            0.20036258217412903,
            0.2467424790468992,
            0.04386551797146058,
            0.33405048686129885,
            0.3228308978271473,
            0.33774818937515083,
            0.28269022826566564,
            0.3539817033405921,
            0.37852172949294954,
            0.37524743367235663,
            0.33353782849681585,
            0.30271312647162185,
            0.31501367120602036,
            0.47039951982718725,
            0.27544550680279223,
            0.21712801529884068,
            1.0,
            0.47438427430890895,
            0.2806198027054533,
            0.37842471995250904,
            0.22570033175412801,
            0.4443557678078669,
            0.24494659979222538,
            0.3553016274645664,
            0.48803519640416104,
            0.3748131602560074,
            0.8556416921159496,
            0.3431898537149008,
            0.32630125334354554,
            0.327560285652259,
            0.2877878387947832,
            0.2693426050524056,
            0.2606283616457919,
            0.4483197781132795,
            0.2566153767556413,
            0.2723829511100927,
            0.47438427430890895,
            1.0,
            0.3056711644075248,
            0.3988167106753168,
            0.2357590468329957,
            0.37822373843262724,
            0.20148569053789872,
            0.3735550543435771,
            0.3711002774421193,
            0.35278680900667936,
            0.48454330422007036,
            0.3403661710586148,
            0.2979125269128625,
            0.27724710968799315,
            0.22110464096774476,
            0.17182808021869556,
            0.2536671832138812,
            0.40288969305534716,
            0.16765436834335523,
            0.36396368683105496,
            0.2806198027054533,
            0.3056711644075248,
            1.0,
            0.2599672709748971,
            0.13469562730833873,
            0.38998715577662807,
            0.1801404569549611,
            0.2510357167224946,
            0.335412029818409,
            0.3346102703771208,
            0.38070625369452066,
            0.2766213541946717,
            0.31522428373157074,
            0.30994093582448645,
            0.3075478028922607,
            0.28257942363389316,
            0.2991825284309526,
            0.37581972248869483,
            0.16802283609251237,
            0.23314913972678505,
            0.37842471995250904,
            0.3988167106753168,
            0.2599672709748971,
            1.0,
            0.25145649398502223,
            0.27372953852522086,
            0.1891084693630395,
            0.3522508465729644,
            0.34316158939407815,
            0.31137134021637186,
            0.39640866478340486,
            0.39882752501493673,
            0.0546980651744615,
            0.1205762856801738,
            0.08847692268860427,
            0.1294407037556759,
            0.051952413377779776,
            0.23922809574523632,
            0.12701837380257658,
            0.20036258217412903,
            0.22570033175412801,
            0.2357590468329957,
            0.13469562730833873,
            0.25145649398502223,
            1.0,
            0.16622698617566903,
            0.18421169767082066,
            0.2945527096836912,
            0.1374669138063422,
            0.11742719364380937,
            0.1767304788845675,
            0.1770652359831856,
            0.29428598664262806,
            0.3270787854530462,
            0.22647415261836268,
            0.25528718544826556,
            0.25822159855119603,
            0.45204738240431497,
            0.22437100511128225,
            0.2467424790468992,
            0.4443557678078669,
            0.37822373843262724,
            0.38998715577662807,
            0.27372953852522086,
            0.16622698617566903,
            1.0,
            0.4216590551436964,
            0.2419638972349222,
            0.3967408786374932,
            0.356119430451608,
            0.5167068286765399,
            0.23583448930147013,
            0.061500193798754384,
            0.15204495757896505,
            0.06626301818696304,
            0.1587309174027054,
            0.11651792442319496,
            0.21424585634243234,
            0.18327809626852945,
            0.04386551797146058,
            0.24494659979222538,
            0.20148569053789872,
            0.1801404569549611,
            0.1891084693630395,
            0.18421169767082066,
            0.4216590551436964,
            1.0,
            0.20172336813242941,
            0.13159844589906539,
            0.09434186108494302,
            0.25023911474448385,
            0.07669916666511178,
            0.24027070007963416,
            0.26559193912836626,
            0.17537740560747345,
            0.2168120884017062,
            0.20891167217379442,
            0.25150319166879803,
            0.1811295324471806,
            0.33405048686129885,
            0.3553016274645664,
            0.3735550543435771,
            0.2510357167224946,
            0.3522508465729644,
            0.2945527096836912,
            0.2419638972349222,
            0.20172336813242941,
            1.0,
            0.2904625165533111,
            0.24198239941659205,
            0.3579740207264487,
            0.3060805035936038,
            0.5669374421433647,
            0.4761795635821235,
            0.5241532869139222,
            0.4265847559795607,
            0.5398072858345281,
            0.4002696283133453,
            0.302986502584987,
            0.3228308978271473,
            0.48803519640416104,
            0.3711002774421193,
            0.335412029818409,
            0.34316158939407815,
            0.1374669138063422,
            0.3967408786374932,
            0.13159844589906539,
            0.2904625165533111,
            1.0,
            0.44776188605039563,
            0.5431269426481525,
            0.4900153740511026,
            0.3907557356672236,
            0.32949299854393155,
            0.30986205479616397,
            0.25523961205493834,
            0.3030065768796285,
            0.3815191136490659,
            0.19578502952436938,
            0.33774818937515083,
            0.3748131602560074,
            0.35278680900667936,
            0.3346102703771208,
            0.31137134021637186,
            0.11742719364380937,
            0.356119430451608,
            0.09434186108494302,
            0.24198239941659205,
            0.44776188605039563,
            1.0,
            0.4455245380810767,
            0.35049257068344586,
            0.4100442526928417,
            0.4169305356624902,
            0.34694305762530264,
            0.3191647126032973,
            0.35569692639130146,
            0.5006092808351847,
            0.27366200982564837,
            0.28269022826566564,
            0.8556416921159496,
            0.48454330422007036,
            0.38070625369452066,
            0.39640866478340486,
            0.1767304788845675,
            0.5167068286765399,
            0.25023911474448385,
            0.3579740207264487,
            0.5431269426481525,
            0.4455245380810767,
            1.0,
            0.38014747771008955,
            0.46133468883857304,
            0.38066921983731633,
            0.4297702646473715,
            0.30453402843247707,
            0.45252022234607814,
            0.38223456263980166,
            0.1872277074615232,
            0.3539817033405921,
            0.3431898537149008,
            0.3403661710586148,
            0.2766213541946717,
            0.39882752501493673,
            0.1770652359831856,
            0.23583448930147013,
            0.07669916666511178,
            0.3060805035936038,
            0.4900153740511026,
            0.35049257068344586,
            0.38014747771008955,
            1.0,
        ],
        20,
        20,
    )
    kendallt = reshape(
        [
            1.0,
            0.33916115816852516,
            0.461341761998526,
            0.312785345328628,
            0.4965568095184533,
            0.23395865186681586,
            0.1876715103865729,
            0.20886132111213385,
            0.26750709439869036,
            0.2288291944431166,
            0.20563609502386213,
            0.21551340577170083,
            0.0360384457198995,
            0.20329700546506044,
            0.040039244365659574,
            0.1662013094348324,
            0.41081676931819266,
            0.27342951390605624,
            0.2921358706968446,
            0.3254199666925766,
            0.33916115816852516,
            1.0,
            0.3307712304592788,
            0.2521284200948853,
            0.32071408664100043,
            0.23200220033595437,
            0.2181222503466092,
            0.18398852180839007,
            0.26266508871332733,
            0.22625274892940092,
            0.1908510294315319,
            0.2123121340922712,
            0.08065622872138153,
            0.22771669644186138,
            0.10409292700192857,
            0.18287236963353998,
            0.3372423058899681,
            0.22754004653098447,
            0.293604262447345,
            0.26596260561248214,
            0.461341761998526,
            0.3307712304592788,
            1.0,
            0.2979663152211407,
            0.4320664094605356,
            0.19910507875915517,
            0.1727762434545448,
            0.1462844601979759,
            0.23166683284861045,
            0.1968749888925167,
            0.1528203078533668,
            0.21116728435347654,
            0.058918592666055994,
            0.15652210864760124,
            0.04518117464063249,
            0.12004514447198014,
            0.3773460396815945,
            0.21498559571052078,
            0.24091657285732018,
            0.30121731740615376,
            0.312785345328628,
            0.2521284200948853,
            0.2979663152211407,
            1.0,
            0.2924835682355988,
            0.17929181237483063,
            0.20974967893832935,
            0.1257626923763437,
            0.21112467522766243,
            0.18623080047888044,
            0.11745928593640063,
            0.1934146143864036,
            0.08711052682336526,
            0.17615423744951542,
            0.1078573999761356,
            0.14871159701247383,
            0.2994532104361033,
            0.17620229224005615,
            0.22219417058816343,
            0.2090861370820509,
            0.4965568095184533,
            0.32071408664100043,
            0.4320664094605356,
            0.2924835682355988,
            1.0,
            0.20391139360287097,
            0.1790637585468666,
            0.19319884668612278,
            0.22005228794879558,
            0.17972812236179941,
            0.17602953675459948,
            0.20429492026300308,
            0.034828581828075175,
            0.1783457481517084,
            0.0786936877962102,
            0.14484903183714948,
            0.3904150335958445,
            0.2104475051350241,
            0.25010685982248954,
            0.3184460389337026,
            0.23395865186681586,
            0.23200220033595437,
            0.19910507875915517,
            0.17929181237483063,
            0.20391139360287097,
            1.0,
            0.1443052274165371,
            0.20953364248548756,
            0.329069270547258,
            0.31477724571901927,
            0.28330975114972856,
            0.2616633192138041,
            0.16249829698193707,
            0.31677005490480903,
            0.14421204482547798,
            0.17312026209899598,
            0.2877594620277412,
            0.2645962844149878,
            0.35554466790930833,
            0.26363075097790567,
            0.1876715103865729,
            0.2181222503466092,
            0.1727762434545448,
            0.20974967893832935,
            0.1790637585468666,
            0.1443052274165371,
            1.0,
            0.09877908032137943,
            0.18892992754220092,
            0.17602552969353352,
            0.11409802422941599,
            0.11350283472920308,
            0.0847180255902212,
            0.1525467831078268,
            0.12406405148802917,
            0.12404354625692315,
            0.20652400404367488,
            0.13257212027127624,
            0.18538315333164151,
            0.12658510455706803,
            0.20886132111213385,
            0.18398852180839007,
            0.1462844601979759,
            0.1257626923763437,
            0.19319884668612278,
            0.20953364248548756,
            0.09877908032137943,
            1.0,
            0.14844022023732814,
            0.1848704420628564,
            0.25131859861559,
            0.15906872461287985,
            0.13548492746279606,
            0.16976974676091094,
            0.02941330860802663,
            0.2325756374582133,
            0.22330954960917396,
            0.2306218352320667,
            0.19505244887587803,
            0.2429204546374989,
            0.26750709439869036,
            0.26266508871332733,
            0.23166683284861045,
            0.21112467522766243,
            0.22005228794879558,
            0.329069270547258,
            0.18892992754220092,
            0.14844022023732814,
            1.0,
            0.333296248661349,
            0.19573137500815543,
            0.25952342088389974,
            0.1526430907550641,
            0.3099252637821265,
            0.16703754951975858,
            0.24605853191354915,
            0.35232656590587985,
            0.26116397960054416,
            0.6863932455742044,
            0.23854874811896262,
            0.2288291944431166,
            0.22625274892940092,
            0.1968749888925167,
            0.18623080047888044,
            0.17972812236179941,
            0.31477724571901927,
            0.17602552969353352,
            0.1848704420628564,
            0.333296248661349,
            1.0,
            0.2114228646172259,
            0.27464808139111035,
            0.1606476806544199,
            0.260614909132097,
            0.13703160709250106,
            0.26282067336617976,
            0.2574075517383806,
            0.24652112836969145,
            0.34204697784934945,
            0.23467328016694397,
            0.20563609502386213,
            0.1908510294315319,
            0.1528203078533668,
            0.11745928593640063,
            0.17602953675459948,
            0.28330975114972856,
            0.11409802422941599,
            0.25131859861559,
            0.19573137500815543,
            0.2114228646172259,
            1.0,
            0.17827917775430965,
            0.09071399019878713,
            0.2708169029005467,
            0.12163064105848391,
            0.17060613826206153,
            0.233568431814388,
            0.22837471507131915,
            0.26540945443144404,
            0.19140692389025032,
            0.21551340577170083,
            0.2123121340922712,
            0.21116728435347654,
            0.1934146143864036,
            0.20429492026300308,
            0.2616633192138041,
            0.11350283472920308,
            0.15906872461287985,
            0.25952342088389974,
            0.27464808139111035,
            0.17827917775430965,
            1.0,
            0.16941809950442244,
            0.18633967341096777,
            0.12822009441893167,
            0.2444180582010535,
            0.23653115969524657,
            0.21209825884674544,
            0.2728961169542246,
            0.27601015376659827,
            0.0360384457198995,
            0.08065622872138153,
            0.058918592666055994,
            0.08711052682336526,
            0.034828581828075175,
            0.16249829698193707,
            0.0847180255902212,
            0.13548492746279606,
            0.1526430907550641,
            0.1606476806544199,
            0.09071399019878713,
            0.16941809950442244,
            1.0,
            0.11116138393975857,
            0.12365840708471025,
            0.20007699405546764,
            0.09250732429867549,
            0.07820769568445339,
            0.11968642905916593,
            0.11861269403389699,
            0.20329700546506044,
            0.22771669644186138,
            0.15652210864760124,
            0.17615423744951542,
            0.1783457481517084,
            0.31677005490480903,
            0.1525467831078268,
            0.16976974676091094,
            0.3099252637821265,
            0.260614909132097,
            0.2708169029005467,
            0.18633967341096777,
            0.11116138393975857,
            1.0,
            0.29504127583830797,
            0.1647785505083963,
            0.27836644096387403,
            0.24831381032101654,
            0.36395018648599153,
            0.1633969201861724,
            0.040039244365659574,
            0.10409292700192857,
            0.04518117464063249,
            0.1078573999761356,
            0.0786936877962102,
            0.14421204482547798,
            0.12406405148802917,
            0.02941330860802663,
            0.16703754951975858,
            0.13703160709250106,
            0.12163064105848391,
            0.12822009441893167,
            0.12365840708471025,
            0.29504127583830797,
            1.0,
            0.1383349560917876,
            0.0895523507422797,
            0.0642281537380783,
            0.1702339335508561,
            0.051550540679585435,
            0.1662013094348324,
            0.18287236963353998,
            0.12004514447198014,
            0.14871159701247383,
            0.14484903183714948,
            0.17312026209899598,
            0.12404354625692315,
            0.2325756374582133,
            0.24605853191354915,
            0.26282067336617976,
            0.17060613826206153,
            0.2444180582010535,
            0.20007699405546764,
            0.1647785505083963,
            0.1383349560917876,
            1.0,
            0.20245719295778963,
            0.16492543895976783,
            0.2505855620802642,
            0.21186984052942426,
            0.41081676931819266,
            0.3372423058899681,
            0.3773460396815945,
            0.2994532104361033,
            0.3904150335958445,
            0.2877594620277412,
            0.20652400404367488,
            0.22330954960917396,
            0.35232656590587985,
            0.2574075517383806,
            0.233568431814388,
            0.23653115969524657,
            0.09250732429867549,
            0.27836644096387403,
            0.0895523507422797,
            0.20245719295778963,
            1.0,
            0.3150533245940003,
            0.39686693868934525,
            0.34634761493000543,
            0.27342951390605624,
            0.22754004653098447,
            0.21498559571052078,
            0.17620229224005615,
            0.2104475051350241,
            0.2645962844149878,
            0.13257212027127624,
            0.2306218352320667,
            0.26116397960054416,
            0.24652112836969145,
            0.22837471507131915,
            0.21209825884674544,
            0.07820769568445339,
            0.24831381032101654,
            0.0642281537380783,
            0.16492543895976783,
            0.3150533245940003,
            1.0,
            0.3142188603992126,
            0.2461354636400494,
            0.2921358706968446,
            0.293604262447345,
            0.24091657285732018,
            0.22219417058816343,
            0.25010685982248954,
            0.35554466790930833,
            0.18538315333164151,
            0.19505244887587803,
            0.6863932455742044,
            0.34204697784934945,
            0.26540945443144404,
            0.2728961169542246,
            0.11968642905916593,
            0.36395018648599153,
            0.1702339335508561,
            0.2505855620802642,
            0.39686693868934525,
            0.3142188603992126,
            1.0,
            0.26466960045768523,
            0.3254199666925766,
            0.26596260561248214,
            0.30121731740615376,
            0.2090861370820509,
            0.3184460389337026,
            0.26363075097790567,
            0.12658510455706803,
            0.2429204546374989,
            0.23854874811896262,
            0.23467328016694397,
            0.19140692389025032,
            0.27601015376659827,
            0.11861269403389699,
            0.1633969201861724,
            0.051550540679585435,
            0.21186984052942426,
            0.34634761493000543,
            0.2461354636400494,
            0.26466960045768523,
            1.0,
        ],
        20,
        20,
    )
    abs_pearsont = reshape(
        [
            1.0,
            0.4651842333328937,
            0.6057125142402463,
            0.40762801198941984,
            0.6007283292568202,
            0.3198674217714188,
            0.13980685060136308,
            0.22545693109273,
            0.37609316223969863,
            0.31701730135611267,
            0.2710058473717296,
            0.2655734568571606,
            0.05610318650837941,
            0.30702756646908064,
            0.05361736103783228,
            0.15373730281804923,
            0.5334873896372292,
            0.36818175916637885,
            0.4005150923184833,
            0.45630606211976094,
            0.4651842333328937,
            1.0,
            0.4679234223759625,
            0.3249673502808304,
            0.40536510518834645,
            0.2989528354747097,
            0.22057192005350237,
            0.24463464167865565,
            0.390242225643119,
            0.3344674294181327,
            0.2799482223134466,
            0.23625712805062382,
            0.11142192157859834,
            0.33806398778842883,
            0.11808840599758612,
            0.22732669672564298,
            0.49947448009023054,
            0.31720499483187437,
            0.4333140506300871,
            0.3919434386695615,
            0.6057125142402463,
            0.4679234223759625,
            1.0,
            0.37174237939134214,
            0.5254251455186676,
            0.31239198910026345,
            0.17981078868703523,
            0.18841708989484043,
            0.35440522621916376,
            0.3042728983335884,
            0.2368926505098415,
            0.3234952093176083,
            0.08251797295992715,
            0.27299943603765836,
            0.08582236358846955,
            0.15656783425378626,
            0.4973675057064263,
            0.30617967799104223,
            0.37294965947864245,
            0.4367939957300974,
            0.40762801198941984,
            0.3249673502808304,
            0.37174237939134214,
            1.0,
            0.36406487945095894,
            0.24309813377816114,
            0.24695035335897475,
            0.13537663037557346,
            0.29422135595764504,
            0.2612399759136344,
            0.13914586320858327,
            0.20847570199698828,
            0.11383172809294834,
            0.2348008761076984,
            0.15276782269490824,
            0.17312782198030055,
            0.39566793689867685,
            0.2362271362987392,
            0.31038597430688003,
            0.27496210817361394,
            0.6007283292568202,
            0.40536510518834645,
            0.5254251455186676,
            0.36406487945095894,
            1.0,
            0.2120952543113977,
            0.16348150078944515,
            0.15818434083186686,
            0.29148707164871324,
            0.23239147490904064,
            0.19965576261418652,
            0.2463853676693437,
            0.024238491565442805,
            0.23483256964507096,
            0.13510967823989825,
            0.13959742249101284,
            0.4505533175081079,
            0.23109203619782018,
            0.30408040693066246,
            0.4367958927859396,
            0.3198674217714188,
            0.2989528354747097,
            0.31239198910026345,
            0.24309813377816114,
            0.2120952543113977,
            1.0,
            0.17406024353790345,
            0.22372615054486208,
            0.4479338481714031,
            0.41582030499268774,
            0.3842069521965308,
            0.30000028103018744,
            0.19519279322053606,
            0.43312263234089793,
            0.23867490474241268,
            0.15856958857720854,
            0.3794032705848954,
            0.37995935227758887,
            0.5016688137311583,
            0.3652353511852042,
            0.13980685060136308,
            0.22057192005350237,
            0.17981078868703523,
            0.24695035335897475,
            0.16348150078944515,
            0.17406024353790345,
            1.0,
            0.08701084969575291,
            0.24858569835966748,
            0.21882891723891004,
            0.1547238621961266,
            0.09805353533905745,
            0.07821959872479427,
            0.18432464773238932,
            0.1881739102118061,
            0.13148458148596273,
            0.25237614743765824,
            0.16534406352832703,
            0.22828466335505312,
            0.10498126987336069,
            0.22545693109273,
            0.24463464167865565,
            0.18841708989484043,
            0.13537663037557346,
            0.15818434083186686,
            0.22372615054486208,
            0.08701084969575291,
            1.0,
            0.19482814476602453,
            0.24977636025157618,
            0.32296840702609114,
            0.18845278864241077,
            0.19811371330165756,
            0.2251594813907211,
            0.05174592137652584,
            0.20088702313922055,
            0.2823197933938334,
            0.31501720621986595,
            0.2716602732179378,
            0.30348714452042586,
            0.37609316223969863,
            0.390242225643119,
            0.35440522621916376,
            0.29422135595764504,
            0.29148707164871324,
            0.4479338481714031,
            0.24858569835966748,
            0.19482814476602453,
            1.0,
            0.4854199983366868,
            0.2740444946923863,
            0.32081806164025833,
            0.2025937878007308,
            0.45891057801057933,
            0.25837860559141584,
            0.3170004277249205,
            0.5186283919577853,
            0.42252533669172726,
            0.8902291777036442,
            0.3729551547265569,
            0.31701730135611267,
            0.3344674294181327,
            0.3042728983335884,
            0.2612399759136344,
            0.23239147490904064,
            0.41582030499268774,
            0.21882891723891004,
            0.24977636025157618,
            0.4854199983366868,
            1.0,
            0.297636307243898,
            0.30911545802351886,
            0.21191238940613044,
            0.35118268869830227,
            0.21168527993409647,
            0.28531209548790504,
            0.38687431236934383,
            0.34946478440574774,
            0.5100035829557179,
            0.3566546146821851,
            0.2710058473717296,
            0.2799482223134466,
            0.2368926505098415,
            0.13914586320858327,
            0.19965576261418652,
            0.3842069521965308,
            0.1547238621961266,
            0.32296840702609114,
            0.2740444946923863,
            0.297636307243898,
            1.0,
            0.17913226997959855,
            0.1301420955130662,
            0.39452988958803653,
            0.1933464953915291,
            0.17467813682930874,
            0.32602711601449896,
            0.3287465233944562,
            0.36834849257726127,
            0.2797705897370372,
            0.2655734568571606,
            0.23625712805062382,
            0.3234952093176083,
            0.20847570199698828,
            0.2463853676693437,
            0.30000028103018744,
            0.09805353533905745,
            0.18845278864241077,
            0.32081806164025833,
            0.30911545802351886,
            0.17913226997959855,
            1.0,
            0.19639947507631111,
            0.23760728339164755,
            0.15576389484625175,
            0.23012958915724335,
            0.2744979057203696,
            0.23257446855218897,
            0.3370284614401489,
            0.3236650393250739,
            0.05610318650837941,
            0.11142192157859834,
            0.08251797295992715,
            0.11383172809294834,
            0.024238491565442805,
            0.19519279322053606,
            0.07821959872479427,
            0.19811371330165756,
            0.2025937878007308,
            0.21191238940613044,
            0.1301420955130662,
            0.19639947507631111,
            1.0,
            0.148220931287248,
            0.15947855549214807,
            0.23592815391170488,
            0.10613586887539042,
            0.11470320709193528,
            0.16723710959249433,
            0.17092360722783093,
            0.30702756646908064,
            0.33806398778842883,
            0.27299943603765836,
            0.2348008761076984,
            0.23483256964507096,
            0.43312263234089793,
            0.18432464773238932,
            0.2251594813907211,
            0.45891057801057933,
            0.35118268869830227,
            0.39452988958803653,
            0.23760728339164755,
            0.148220931287248,
            1.0,
            0.4090481800686874,
            0.17553470218807768,
            0.42187414285181146,
            0.38709714508134124,
            0.5384016805448939,
            0.26667980117289164,
            0.05361736103783228,
            0.11808840599758612,
            0.08582236358846955,
            0.15276782269490824,
            0.13510967823989825,
            0.23867490474241268,
            0.1881739102118061,
            0.05174592137652584,
            0.25837860559141584,
            0.21168527993409647,
            0.1933464953915291,
            0.15576389484625175,
            0.15947855549214807,
            0.4090481800686874,
            1.0,
            0.1615606504947503,
            0.16685525751304114,
            0.1080793937275288,
            0.2714672756651635,
            0.0887178221509978,
            0.15373730281804923,
            0.22732669672564298,
            0.15656783425378626,
            0.17312782198030055,
            0.13959742249101284,
            0.15856958857720854,
            0.13148458148596273,
            0.20088702313922055,
            0.3170004277249205,
            0.28531209548790504,
            0.17467813682930874,
            0.23012958915724335,
            0.23592815391170488,
            0.17553470218807768,
            0.1615606504947503,
            1.0,
            0.26101919277235813,
            0.1985383556313028,
            0.3028009839746978,
            0.2703442605531704,
            0.5334873896372292,
            0.49947448009023054,
            0.4973675057064263,
            0.39566793689867685,
            0.4505533175081079,
            0.3794032705848954,
            0.25237614743765824,
            0.2823197933938334,
            0.5186283919577853,
            0.38687431236934383,
            0.32602711601449896,
            0.2744979057203696,
            0.10613586887539042,
            0.42187414285181146,
            0.16685525751304114,
            0.26101919277235813,
            1.0,
            0.4352478359688786,
            0.56766932426283,
            0.48304218985008474,
            0.36818175916637885,
            0.31720499483187437,
            0.30617967799104223,
            0.2362271362987392,
            0.23109203619782018,
            0.37995935227758887,
            0.16534406352832703,
            0.31501720621986595,
            0.42252533669172726,
            0.34946478440574774,
            0.3287465233944562,
            0.23257446855218897,
            0.11470320709193528,
            0.38709714508134124,
            0.1080793937275288,
            0.1985383556313028,
            0.4352478359688786,
            1.0,
            0.48170301863322207,
            0.32116995203853244,
            0.4005150923184833,
            0.4333140506300871,
            0.37294965947864245,
            0.31038597430688003,
            0.30408040693066246,
            0.5016688137311583,
            0.22828466335505312,
            0.2716602732179378,
            0.8902291777036442,
            0.5100035829557179,
            0.36834849257726127,
            0.3370284614401489,
            0.16723710959249433,
            0.5384016805448939,
            0.2714672756651635,
            0.3028009839746978,
            0.56766932426283,
            0.48170301863322207,
            1.0,
            0.41494299334691986,
            0.45630606211976094,
            0.3919434386695615,
            0.4367939957300974,
            0.27496210817361394,
            0.4367958927859396,
            0.3652353511852042,
            0.10498126987336069,
            0.30348714452042586,
            0.3729551547265569,
            0.3566546146821851,
            0.2797705897370372,
            0.3236650393250739,
            0.17092360722783093,
            0.26667980117289164,
            0.0887178221509978,
            0.2703442605531704,
            0.48304218985008474,
            0.32116995203853244,
            0.41494299334691986,
            1.0,
        ],
        20,
        20,
    )
    abs_spearmant = reshape(
        [
            1.0,
            0.4788395514998828,
            0.6194175358237134,
            0.4459162681697528,
            0.6674964146451202,
            0.3337094081734166,
            0.27347009181744314,
            0.30334196378081013,
            0.37852172949294954,
            0.32630125334354554,
            0.2979125269128625,
            0.31522428373157074,
            0.0546980651744615,
            0.29428598664262806,
            0.061500193798754384,
            0.24027070007963416,
            0.5669374421433647,
            0.3907557356672236,
            0.4100442526928417,
            0.46133468883857304,
            0.4788395514998828,
            1.0,
            0.46252144057354433,
            0.36079246589368286,
            0.45055878392794857,
            0.33201501394734084,
            0.3183824463020067,
            0.2683360661831083,
            0.37524743367235663,
            0.327560285652259,
            0.27724710968799315,
            0.30994093582448645,
            0.1205762856801738,
            0.3270787854530462,
            0.15204495757896505,
            0.26559193912836626,
            0.4761795635821235,
            0.32949299854393155,
            0.4169305356624902,
            0.38066921983731633,
            0.6194175358237134,
            0.46252144057354433,
            1.0,
            0.4246082196221759,
            0.5848605391500088,
            0.2863966527551661,
            0.25291124643523405,
            0.21321769475611083,
            0.33353782849681585,
            0.2877878387947832,
            0.22110464096774476,
            0.3075478028922607,
            0.08847692268860427,
            0.22647415261836268,
            0.06626301818696304,
            0.17537740560747345,
            0.5241532869139222,
            0.30986205479616397,
            0.34694305762530264,
            0.4297702646473715,
            0.4459162681697528,
            0.36079246589368286,
            0.4246082196221759,
            1.0,
            0.41602240890357123,
            0.2586273750457479,
            0.3061105258443722,
            0.18594887760040496,
            0.30271312647162185,
            0.2693426050524056,
            0.17182808021869556,
            0.28257942363389316,
            0.1294407037556759,
            0.25528718544826556,
            0.1587309174027054,
            0.2168120884017062,
            0.4265847559795607,
            0.25523961205493834,
            0.3191647126032973,
            0.30453402843247707,
            0.6674964146451202,
            0.45055878392794857,
            0.5848605391500088,
            0.41602240890357123,
            1.0,
            0.2896668813056614,
            0.26023910151271085,
            0.2788292087196651,
            0.31501367120602036,
            0.2606283616457919,
            0.2536671832138812,
            0.2991825284309526,
            0.051952413377779776,
            0.25822159855119603,
            0.11651792442319496,
            0.20891167217379442,
            0.5398072858345281,
            0.3030065768796285,
            0.35569692639130146,
            0.45252022234607814,
            0.3337094081734166,
            0.33201501394734084,
            0.2863966527551661,
            0.2586273750457479,
            0.2896668813056614,
            1.0,
            0.21358336660547012,
            0.30437739641383543,
            0.47039951982718725,
            0.4483197781132795,
            0.40288969305534716,
            0.37581972248869483,
            0.23922809574523632,
            0.45204738240431497,
            0.21424585634243234,
            0.25150319166879803,
            0.4002696283133453,
            0.3815191136490659,
            0.5006092808351847,
            0.38223456263980166,
            0.27347009181744314,
            0.3183824463020067,
            0.25291124643523405,
            0.3061105258443722,
            0.26023910151271085,
            0.21358336660547012,
            1.0,
            0.1458529955616399,
            0.27544550680279223,
            0.2566153767556413,
            0.16765436834335523,
            0.16802283609251237,
            0.12701837380257658,
            0.22437100511128225,
            0.18327809626852945,
            0.1811295324471806,
            0.302986502584987,
            0.19578502952436938,
            0.27366200982564837,
            0.1872277074615232,
            0.30334196378081013,
            0.2683360661831083,
            0.21321769475611083,
            0.18594887760040496,
            0.2788292087196651,
            0.30437739641383543,
            0.1458529955616399,
            1.0,
            0.21712801529884068,
            0.2723829511100927,
            0.36396368683105496,
            0.23314913972678505,
            0.20036258217412903,
            0.2467424790468992,
            0.04386551797146058,
            0.33405048686129885,
            0.3228308978271473,
            0.33774818937515083,
            0.28269022826566564,
            0.3539817033405921,
            0.37852172949294954,
            0.37524743367235663,
            0.33353782849681585,
            0.30271312647162185,
            0.31501367120602036,
            0.47039951982718725,
            0.27544550680279223,
            0.21712801529884068,
            1.0,
            0.47438427430890895,
            0.2806198027054533,
            0.37842471995250904,
            0.22570033175412801,
            0.4443557678078669,
            0.24494659979222538,
            0.3553016274645664,
            0.48803519640416104,
            0.3748131602560074,
            0.8556416921159496,
            0.3431898537149008,
            0.32630125334354554,
            0.327560285652259,
            0.2877878387947832,
            0.2693426050524056,
            0.2606283616457919,
            0.4483197781132795,
            0.2566153767556413,
            0.2723829511100927,
            0.47438427430890895,
            1.0,
            0.3056711644075248,
            0.3988167106753168,
            0.2357590468329957,
            0.37822373843262724,
            0.20148569053789872,
            0.3735550543435771,
            0.3711002774421193,
            0.35278680900667936,
            0.48454330422007036,
            0.3403661710586148,
            0.2979125269128625,
            0.27724710968799315,
            0.22110464096774476,
            0.17182808021869556,
            0.2536671832138812,
            0.40288969305534716,
            0.16765436834335523,
            0.36396368683105496,
            0.2806198027054533,
            0.3056711644075248,
            1.0,
            0.2599672709748971,
            0.13469562730833873,
            0.38998715577662807,
            0.1801404569549611,
            0.2510357167224946,
            0.335412029818409,
            0.3346102703771208,
            0.38070625369452066,
            0.2766213541946717,
            0.31522428373157074,
            0.30994093582448645,
            0.3075478028922607,
            0.28257942363389316,
            0.2991825284309526,
            0.37581972248869483,
            0.16802283609251237,
            0.23314913972678505,
            0.37842471995250904,
            0.3988167106753168,
            0.2599672709748971,
            1.0,
            0.25145649398502223,
            0.27372953852522086,
            0.1891084693630395,
            0.3522508465729644,
            0.34316158939407815,
            0.31137134021637186,
            0.39640866478340486,
            0.39882752501493673,
            0.0546980651744615,
            0.1205762856801738,
            0.08847692268860427,
            0.1294407037556759,
            0.051952413377779776,
            0.23922809574523632,
            0.12701837380257658,
            0.20036258217412903,
            0.22570033175412801,
            0.2357590468329957,
            0.13469562730833873,
            0.25145649398502223,
            1.0,
            0.16622698617566903,
            0.18421169767082066,
            0.2945527096836912,
            0.1374669138063422,
            0.11742719364380937,
            0.1767304788845675,
            0.1770652359831856,
            0.29428598664262806,
            0.3270787854530462,
            0.22647415261836268,
            0.25528718544826556,
            0.25822159855119603,
            0.45204738240431497,
            0.22437100511128225,
            0.2467424790468992,
            0.4443557678078669,
            0.37822373843262724,
            0.38998715577662807,
            0.27372953852522086,
            0.16622698617566903,
            1.0,
            0.4216590551436964,
            0.2419638972349222,
            0.3967408786374932,
            0.356119430451608,
            0.5167068286765399,
            0.23583448930147013,
            0.061500193798754384,
            0.15204495757896505,
            0.06626301818696304,
            0.1587309174027054,
            0.11651792442319496,
            0.21424585634243234,
            0.18327809626852945,
            0.04386551797146058,
            0.24494659979222538,
            0.20148569053789872,
            0.1801404569549611,
            0.1891084693630395,
            0.18421169767082066,
            0.4216590551436964,
            1.0,
            0.20172336813242941,
            0.13159844589906539,
            0.09434186108494302,
            0.25023911474448385,
            0.07669916666511178,
            0.24027070007963416,
            0.26559193912836626,
            0.17537740560747345,
            0.2168120884017062,
            0.20891167217379442,
            0.25150319166879803,
            0.1811295324471806,
            0.33405048686129885,
            0.3553016274645664,
            0.3735550543435771,
            0.2510357167224946,
            0.3522508465729644,
            0.2945527096836912,
            0.2419638972349222,
            0.20172336813242941,
            1.0,
            0.2904625165533111,
            0.24198239941659205,
            0.3579740207264487,
            0.3060805035936038,
            0.5669374421433647,
            0.4761795635821235,
            0.5241532869139222,
            0.4265847559795607,
            0.5398072858345281,
            0.4002696283133453,
            0.302986502584987,
            0.3228308978271473,
            0.48803519640416104,
            0.3711002774421193,
            0.335412029818409,
            0.34316158939407815,
            0.1374669138063422,
            0.3967408786374932,
            0.13159844589906539,
            0.2904625165533111,
            1.0,
            0.44776188605039563,
            0.5431269426481525,
            0.4900153740511026,
            0.3907557356672236,
            0.32949299854393155,
            0.30986205479616397,
            0.25523961205493834,
            0.3030065768796285,
            0.3815191136490659,
            0.19578502952436938,
            0.33774818937515083,
            0.3748131602560074,
            0.35278680900667936,
            0.3346102703771208,
            0.31137134021637186,
            0.11742719364380937,
            0.356119430451608,
            0.09434186108494302,
            0.24198239941659205,
            0.44776188605039563,
            1.0,
            0.4455245380810767,
            0.35049257068344586,
            0.4100442526928417,
            0.4169305356624902,
            0.34694305762530264,
            0.3191647126032973,
            0.35569692639130146,
            0.5006092808351847,
            0.27366200982564837,
            0.28269022826566564,
            0.8556416921159496,
            0.48454330422007036,
            0.38070625369452066,
            0.39640866478340486,
            0.1767304788845675,
            0.5167068286765399,
            0.25023911474448385,
            0.3579740207264487,
            0.5431269426481525,
            0.4455245380810767,
            1.0,
            0.38014747771008955,
            0.46133468883857304,
            0.38066921983731633,
            0.4297702646473715,
            0.30453402843247707,
            0.45252022234607814,
            0.38223456263980166,
            0.1872277074615232,
            0.3539817033405921,
            0.3431898537149008,
            0.3403661710586148,
            0.2766213541946717,
            0.39882752501493673,
            0.1770652359831856,
            0.23583448930147013,
            0.07669916666511178,
            0.3060805035936038,
            0.4900153740511026,
            0.35049257068344586,
            0.38014747771008955,
            1.0,
        ],
        20,
        20,
    )
    abs_kendallt = reshape(
        [
            1.0,
            0.33916115816852516,
            0.461341761998526,
            0.312785345328628,
            0.4965568095184533,
            0.23395865186681586,
            0.1876715103865729,
            0.20886132111213385,
            0.26750709439869036,
            0.2288291944431166,
            0.20563609502386213,
            0.21551340577170083,
            0.0360384457198995,
            0.20329700546506044,
            0.040039244365659574,
            0.1662013094348324,
            0.41081676931819266,
            0.27342951390605624,
            0.2921358706968446,
            0.3254199666925766,
            0.33916115816852516,
            1.0,
            0.3307712304592788,
            0.2521284200948853,
            0.32071408664100043,
            0.23200220033595437,
            0.2181222503466092,
            0.18398852180839007,
            0.26266508871332733,
            0.22625274892940092,
            0.1908510294315319,
            0.2123121340922712,
            0.08065622872138153,
            0.22771669644186138,
            0.10409292700192857,
            0.18287236963353998,
            0.3372423058899681,
            0.22754004653098447,
            0.293604262447345,
            0.26596260561248214,
            0.461341761998526,
            0.3307712304592788,
            1.0,
            0.2979663152211407,
            0.4320664094605356,
            0.19910507875915517,
            0.1727762434545448,
            0.1462844601979759,
            0.23166683284861045,
            0.1968749888925167,
            0.1528203078533668,
            0.21116728435347654,
            0.058918592666055994,
            0.15652210864760124,
            0.04518117464063249,
            0.12004514447198014,
            0.3773460396815945,
            0.21498559571052078,
            0.24091657285732018,
            0.30121731740615376,
            0.312785345328628,
            0.2521284200948853,
            0.2979663152211407,
            1.0,
            0.2924835682355988,
            0.17929181237483063,
            0.20974967893832935,
            0.1257626923763437,
            0.21112467522766243,
            0.18623080047888044,
            0.11745928593640063,
            0.1934146143864036,
            0.08711052682336526,
            0.17615423744951542,
            0.1078573999761356,
            0.14871159701247383,
            0.2994532104361033,
            0.17620229224005615,
            0.22219417058816343,
            0.2090861370820509,
            0.4965568095184533,
            0.32071408664100043,
            0.4320664094605356,
            0.2924835682355988,
            1.0,
            0.20391139360287097,
            0.1790637585468666,
            0.19319884668612278,
            0.22005228794879558,
            0.17972812236179941,
            0.17602953675459948,
            0.20429492026300308,
            0.034828581828075175,
            0.1783457481517084,
            0.0786936877962102,
            0.14484903183714948,
            0.3904150335958445,
            0.2104475051350241,
            0.25010685982248954,
            0.3184460389337026,
            0.23395865186681586,
            0.23200220033595437,
            0.19910507875915517,
            0.17929181237483063,
            0.20391139360287097,
            1.0,
            0.1443052274165371,
            0.20953364248548756,
            0.329069270547258,
            0.31477724571901927,
            0.28330975114972856,
            0.2616633192138041,
            0.16249829698193707,
            0.31677005490480903,
            0.14421204482547798,
            0.17312026209899598,
            0.2877594620277412,
            0.2645962844149878,
            0.35554466790930833,
            0.26363075097790567,
            0.1876715103865729,
            0.2181222503466092,
            0.1727762434545448,
            0.20974967893832935,
            0.1790637585468666,
            0.1443052274165371,
            1.0,
            0.09877908032137943,
            0.18892992754220092,
            0.17602552969353352,
            0.11409802422941599,
            0.11350283472920308,
            0.0847180255902212,
            0.1525467831078268,
            0.12406405148802917,
            0.12404354625692315,
            0.20652400404367488,
            0.13257212027127624,
            0.18538315333164151,
            0.12658510455706803,
            0.20886132111213385,
            0.18398852180839007,
            0.1462844601979759,
            0.1257626923763437,
            0.19319884668612278,
            0.20953364248548756,
            0.09877908032137943,
            1.0,
            0.14844022023732814,
            0.1848704420628564,
            0.25131859861559,
            0.15906872461287985,
            0.13548492746279606,
            0.16976974676091094,
            0.02941330860802663,
            0.2325756374582133,
            0.22330954960917396,
            0.2306218352320667,
            0.19505244887587803,
            0.2429204546374989,
            0.26750709439869036,
            0.26266508871332733,
            0.23166683284861045,
            0.21112467522766243,
            0.22005228794879558,
            0.329069270547258,
            0.18892992754220092,
            0.14844022023732814,
            1.0,
            0.333296248661349,
            0.19573137500815543,
            0.25952342088389974,
            0.1526430907550641,
            0.3099252637821265,
            0.16703754951975858,
            0.24605853191354915,
            0.35232656590587985,
            0.26116397960054416,
            0.6863932455742044,
            0.23854874811896262,
            0.2288291944431166,
            0.22625274892940092,
            0.1968749888925167,
            0.18623080047888044,
            0.17972812236179941,
            0.31477724571901927,
            0.17602552969353352,
            0.1848704420628564,
            0.333296248661349,
            1.0,
            0.2114228646172259,
            0.27464808139111035,
            0.1606476806544199,
            0.260614909132097,
            0.13703160709250106,
            0.26282067336617976,
            0.2574075517383806,
            0.24652112836969145,
            0.34204697784934945,
            0.23467328016694397,
            0.20563609502386213,
            0.1908510294315319,
            0.1528203078533668,
            0.11745928593640063,
            0.17602953675459948,
            0.28330975114972856,
            0.11409802422941599,
            0.25131859861559,
            0.19573137500815543,
            0.2114228646172259,
            1.0,
            0.17827917775430965,
            0.09071399019878713,
            0.2708169029005467,
            0.12163064105848391,
            0.17060613826206153,
            0.233568431814388,
            0.22837471507131915,
            0.26540945443144404,
            0.19140692389025032,
            0.21551340577170083,
            0.2123121340922712,
            0.21116728435347654,
            0.1934146143864036,
            0.20429492026300308,
            0.2616633192138041,
            0.11350283472920308,
            0.15906872461287985,
            0.25952342088389974,
            0.27464808139111035,
            0.17827917775430965,
            1.0,
            0.16941809950442244,
            0.18633967341096777,
            0.12822009441893167,
            0.2444180582010535,
            0.23653115969524657,
            0.21209825884674544,
            0.2728961169542246,
            0.27601015376659827,
            0.0360384457198995,
            0.08065622872138153,
            0.058918592666055994,
            0.08711052682336526,
            0.034828581828075175,
            0.16249829698193707,
            0.0847180255902212,
            0.13548492746279606,
            0.1526430907550641,
            0.1606476806544199,
            0.09071399019878713,
            0.16941809950442244,
            1.0,
            0.11116138393975857,
            0.12365840708471025,
            0.20007699405546764,
            0.09250732429867549,
            0.07820769568445339,
            0.11968642905916593,
            0.11861269403389699,
            0.20329700546506044,
            0.22771669644186138,
            0.15652210864760124,
            0.17615423744951542,
            0.1783457481517084,
            0.31677005490480903,
            0.1525467831078268,
            0.16976974676091094,
            0.3099252637821265,
            0.260614909132097,
            0.2708169029005467,
            0.18633967341096777,
            0.11116138393975857,
            1.0,
            0.29504127583830797,
            0.1647785505083963,
            0.27836644096387403,
            0.24831381032101654,
            0.36395018648599153,
            0.1633969201861724,
            0.040039244365659574,
            0.10409292700192857,
            0.04518117464063249,
            0.1078573999761356,
            0.0786936877962102,
            0.14421204482547798,
            0.12406405148802917,
            0.02941330860802663,
            0.16703754951975858,
            0.13703160709250106,
            0.12163064105848391,
            0.12822009441893167,
            0.12365840708471025,
            0.29504127583830797,
            1.0,
            0.1383349560917876,
            0.0895523507422797,
            0.0642281537380783,
            0.1702339335508561,
            0.051550540679585435,
            0.1662013094348324,
            0.18287236963353998,
            0.12004514447198014,
            0.14871159701247383,
            0.14484903183714948,
            0.17312026209899598,
            0.12404354625692315,
            0.2325756374582133,
            0.24605853191354915,
            0.26282067336617976,
            0.17060613826206153,
            0.2444180582010535,
            0.20007699405546764,
            0.1647785505083963,
            0.1383349560917876,
            1.0,
            0.20245719295778963,
            0.16492543895976783,
            0.2505855620802642,
            0.21186984052942426,
            0.41081676931819266,
            0.3372423058899681,
            0.3773460396815945,
            0.2994532104361033,
            0.3904150335958445,
            0.2877594620277412,
            0.20652400404367488,
            0.22330954960917396,
            0.35232656590587985,
            0.2574075517383806,
            0.233568431814388,
            0.23653115969524657,
            0.09250732429867549,
            0.27836644096387403,
            0.0895523507422797,
            0.20245719295778963,
            1.0,
            0.3150533245940003,
            0.39686693868934525,
            0.34634761493000543,
            0.27342951390605624,
            0.22754004653098447,
            0.21498559571052078,
            0.17620229224005615,
            0.2104475051350241,
            0.2645962844149878,
            0.13257212027127624,
            0.2306218352320667,
            0.26116397960054416,
            0.24652112836969145,
            0.22837471507131915,
            0.21209825884674544,
            0.07820769568445339,
            0.24831381032101654,
            0.0642281537380783,
            0.16492543895976783,
            0.3150533245940003,
            1.0,
            0.3142188603992126,
            0.2461354636400494,
            0.2921358706968446,
            0.293604262447345,
            0.24091657285732018,
            0.22219417058816343,
            0.25010685982248954,
            0.35554466790930833,
            0.18538315333164151,
            0.19505244887587803,
            0.6863932455742044,
            0.34204697784934945,
            0.26540945443144404,
            0.2728961169542246,
            0.11968642905916593,
            0.36395018648599153,
            0.1702339335508561,
            0.2505855620802642,
            0.39686693868934525,
            0.3142188603992126,
            1.0,
            0.26466960045768523,
            0.3254199666925766,
            0.26596260561248214,
            0.30121731740615376,
            0.2090861370820509,
            0.3184460389337026,
            0.26363075097790567,
            0.12658510455706803,
            0.2429204546374989,
            0.23854874811896262,
            0.23467328016694397,
            0.19140692389025032,
            0.27601015376659827,
            0.11861269403389699,
            0.1633969201861724,
            0.051550540679585435,
            0.21186984052942426,
            0.34634761493000543,
            0.2461354636400494,
            0.26466960045768523,
            1.0,
        ],
        20,
        20,
    )
    gerber1t = reshape(
        [
            1.0,
            0.2969004893964111,
            0.4440619621342513,
            0.28773584905660377,
            0.43936731107205623,
            0.19805194805194806,
            0.16427432216905902,
            0.1722488038277512,
            0.2384737678855326,
            0.2125,
            0.16840536512667661,
            0.18387096774193548,
            0.030075187969924807,
            0.15930599369085174,
            0.05457227138643068,
            0.1408,
            0.38752052545155996,
            0.23747980613893377,
            0.2754098360655738,
            0.2986003110419907,
            0.2969004893964111,
            1.0,
            0.296,
            0.21712538226299694,
            0.29411764705882354,
            0.19968553459119498,
            0.18524332810047095,
            0.17187500000000003,
            0.23404255319148937,
            0.19311377245508982,
            0.17134416543574593,
            0.1700787401574803,
            0.043859649122807015,
            0.1832298136645963,
            0.07826086956521738,
            0.1856474258970359,
            0.3157894736842105,
            0.20985691573926868,
            0.26604068857589985,
            0.2361963190184049,
            0.4440619621342513,
            0.296,
            1.0,
            0.25617283950617287,
            0.4068965517241379,
            0.17862838915470494,
            0.15070643642072212,
            0.09937888198757763,
            0.2147239263803681,
            0.18209408194233687,
            0.13922155688622753,
            0.17674418604651163,
            0.04499274310595065,
            0.104199066874028,
            0.03941605839416058,
            0.10248447204968944,
            0.3522906793048973,
            0.19334389857369255,
            0.23547880690737832,
            0.2633181126331811,
            0.28773584905660377,
            0.21712538226299694,
            0.25617283950617287,
            1.0,
            0.27503974562798095,
            0.16925465838509315,
            0.16978193146417445,
            0.12195121951219513,
            0.1701492537313433,
            0.16666666666666666,
            0.10901162790697674,
            0.16539050535987748,
            0.09143686502177069,
            0.13161875945537066,
            0.08489208633093526,
            0.12254160363086233,
            0.28484848484848485,
            0.1545595054095827,
            0.2076923076923077,
            0.1834319526627219,
            0.43936731107205623,
            0.29411764705882354,
            0.4068965517241379,
            0.27503974562798095,
            1.0,
            0.18298555377207062,
            0.15245901639344261,
            0.15993537964458804,
            0.20126782884310618,
            0.17061611374407584,
            0.14396284829721362,
            0.15645161290322582,
            0.02857142857142857,
            0.13237639553429026,
            0.08035714285714286,
            0.13043478260869565,
            0.34521880064829824,
            0.17488076311605724,
            0.22966507177033493,
            0.2716049382716049,
            0.19805194805194806,
            0.19968553459119498,
            0.17862838915470494,
            0.16925465838509315,
            0.18298555377207062,
            1.0,
            0.1192368839427663,
            0.1774960380348653,
            0.2812982998454404,
            0.2806201550387597,
            0.22256097560975613,
            0.22112211221122116,
            0.1409295352323838,
            0.25117739403453687,
            0.12536873156342182,
            0.1485623003194888,
            0.23861852433281006,
            0.2310177705977383,
            0.2929936305732484,
            0.22488755622188905,
            0.16427432216905902,
            0.18524332810047095,
            0.15070643642072212,
            0.16978193146417445,
            0.15245901639344261,
            0.1192368839427663,
            1.0,
            0.11624203821656051,
            0.1685214626391097,
            0.1598173515981735,
            0.10416666666666667,
            0.08571428571428572,
            0.0687593423019432,
            0.12267080745341614,
            0.11323529411764706,
            0.11556982343499198,
            0.20588235294117646,
            0.12050078247261346,
            0.16640746500777606,
            0.11666666666666667,
            0.1722488038277512,
            0.17187500000000003,
            0.09937888198757763,
            0.12195121951219513,
            0.15993537964458804,
            0.1774960380348653,
            0.11624203821656051,
            1.0,
            0.11926605504587155,
            0.1765601217656012,
            0.22290076335877862,
            0.14123376623376624,
            0.10510510510510511,
            0.1192368839427663,
            0.04046242774566475,
            0.20454545454545456,
            0.20367534456355282,
            0.2015748031496063,
            0.1596244131455399,
            0.20182094081942337,
            0.2384737678855326,
            0.23404255319148937,
            0.2147239263803681,
            0.1701492537313433,
            0.20126782884310618,
            0.2812982998454404,
            0.1685214626391097,
            0.11926605504587155,
            1.0,
            0.30721966205837176,
            0.16371681415929204,
            0.2220496894409938,
            0.13828238719068414,
            0.2607361963190184,
            0.14814814814814814,
            0.221875,
            0.3145539906103287,
            0.22727272727272727,
            0.6153846153846154,
            0.21375186846038863,
            0.2125,
            0.19311377245508982,
            0.18209408194233687,
            0.16666666666666666,
            0.17061611374407584,
            0.2806201550387597,
            0.1598173515981735,
            0.1765601217656012,
            0.30721966205837176,
            1.0,
            0.187039764359352,
            0.2445141065830721,
            0.14641288433382138,
            0.2147147147147147,
            0.11412268188302425,
            0.2405660377358491,
            0.24336283185840707,
            0.20249221183800623,
            0.3125972006220839,
            0.22882615156017827,
            0.16840536512667661,
            0.17134416543574593,
            0.13922155688622753,
            0.10901162790697674,
            0.14396284829721362,
            0.22256097560975613,
            0.10416666666666667,
            0.22290076335877862,
            0.16371681415929204,
            0.187039764359352,
            1.0,
            0.14069591527987896,
            0.07334273624823695,
            0.22072072072072071,
            0.10183875530410183,
            0.14221556886227546,
            0.2038404726735598,
            0.20239880059970014,
            0.24137931034482757,
            0.17551622418879056,
            0.18387096774193548,
            0.1700787401574803,
            0.17674418604651163,
            0.16539050535987748,
            0.15645161290322582,
            0.22112211221122116,
            0.08571428571428572,
            0.14123376623376624,
            0.2220496894409938,
            0.2445141065830721,
            0.14069591527987896,
            1.0,
            0.1534954407294833,
            0.14705882352941177,
            0.12816691505216096,
            0.20161290322580644,
            0.20280811232449295,
            0.17295597484276728,
            0.22762951334379905,
            0.22900763358778625,
            0.030075187969924807,
            0.043859649122807015,
            0.04499274310595065,
            0.09143686502177069,
            0.02857142857142857,
            0.1409295352323838,
            0.0687593423019432,
            0.10510510510510511,
            0.13828238719068414,
            0.14641288433382138,
            0.07334273624823695,
            0.1534954407294833,
            1.0,
            0.0955223880597015,
            0.10256410256410256,
            0.13595166163141995,
            0.07982583454281568,
            0.06774668630338733,
            0.11826347305389222,
            0.10595065312046444,
            0.15930599369085174,
            0.1832298136645963,
            0.104199066874028,
            0.13161875945537066,
            0.13237639553429026,
            0.25117739403453687,
            0.12267080745341614,
            0.1192368839427663,
            0.2607361963190184,
            0.2147147147147147,
            0.22072072072072071,
            0.14705882352941177,
            0.0955223880597015,
            1.0,
            0.2514792899408284,
            0.15756630265210608,
            0.2496124031007752,
            0.1971608832807571,
            0.3033175355450237,
            0.12481203007518796,
            0.05457227138643068,
            0.07826086956521738,
            0.03941605839416058,
            0.08489208633093526,
            0.08035714285714286,
            0.12536873156342182,
            0.11323529411764706,
            0.04046242774566475,
            0.14814814814814814,
            0.11412268188302425,
            0.10183875530410183,
            0.12816691505216096,
            0.10256410256410256,
            0.2514792899408284,
            1.0,
            0.11242603550295857,
            0.08513708513708514,
            0.04934687953555879,
            0.1369472182596291,
            0.05397727272727273,
            0.1408,
            0.1856474258970359,
            0.10248447204968944,
            0.12254160363086233,
            0.13043478260869565,
            0.1485623003194888,
            0.11556982343499198,
            0.20454545454545456,
            0.221875,
            0.2405660377358491,
            0.14221556886227546,
            0.20161290322580644,
            0.13595166163141995,
            0.15756630265210608,
            0.11242603550295857,
            1.0,
            0.19508448540706605,
            0.13174603174603175,
            0.2124600638977636,
            0.17378048780487804,
            0.38752052545155996,
            0.3157894736842105,
            0.3522906793048973,
            0.28484848484848485,
            0.34521880064829824,
            0.23861852433281006,
            0.20588235294117646,
            0.20367534456355282,
            0.3145539906103287,
            0.24336283185840707,
            0.2038404726735598,
            0.20280811232449295,
            0.07982583454281568,
            0.2496124031007752,
            0.08513708513708514,
            0.19508448540706605,
            1.0,
            0.28217054263565894,
            0.3527559055118111,
            0.3094170403587444,
            0.23747980613893377,
            0.20985691573926868,
            0.19334389857369255,
            0.1545595054095827,
            0.17488076311605724,
            0.2310177705977383,
            0.12050078247261346,
            0.2015748031496063,
            0.22727272727272727,
            0.20249221183800623,
            0.20239880059970014,
            0.17295597484276728,
            0.06774668630338733,
            0.1971608832807571,
            0.04934687953555879,
            0.13174603174603175,
            0.28217054263565894,
            1.0,
            0.27479674796747966,
            0.2287066246056782,
            0.2754098360655738,
            0.26604068857589985,
            0.23547880690737832,
            0.2076923076923077,
            0.22966507177033493,
            0.2929936305732484,
            0.16640746500777606,
            0.1596244131455399,
            0.6153846153846154,
            0.3125972006220839,
            0.24137931034482757,
            0.22762951334379905,
            0.11826347305389222,
            0.3033175355450237,
            0.1369472182596291,
            0.2124600638977636,
            0.3527559055118111,
            0.27479674796747966,
            1.0,
            0.2450229709035222,
            0.2986003110419907,
            0.2361963190184049,
            0.2633181126331811,
            0.1834319526627219,
            0.2716049382716049,
            0.22488755622188905,
            0.11666666666666667,
            0.20182094081942337,
            0.21375186846038863,
            0.22882615156017827,
            0.17551622418879056,
            0.22900763358778625,
            0.10595065312046444,
            0.12481203007518796,
            0.05397727272727273,
            0.17378048780487804,
            0.3094170403587444,
            0.2287066246056782,
            0.2450229709035222,
            1.0,
        ],
        20,
        20,
    )
    gerber2t = reshape(
        [
            1.0,
            0.41330772678231814,
            0.5885075690602108,
            0.4084129620499064,
            0.5903685607569671,
            0.2824142172459059,
            0.24649685013065284,
            0.2520421785871207,
            0.335482333082084,
            0.30191152503976626,
            0.2452150932316846,
            0.27149091068252545,
            0.04435189482632632,
            0.23142018830539302,
            0.07894744829362502,
            0.20633414264933234,
            0.5222517218565728,
            0.3402859830749849,
            0.38364264281101457,
            0.42577819033273273,
            0.41330772678231814,
            1.0,
            0.4111151715279185,
            0.30874234641895,
            0.4141094553121866,
            0.28641111966543714,
            0.27511583325286976,
            0.2500930271051154,
            0.33555100591751874,
            0.2789908258943761,
            0.2452371002978022,
            0.25057262757494747,
            0.06481311078880647,
            0.26340335652927005,
            0.11225083025886852,
            0.27182839176591744,
            0.4398022771468619,
            0.29768714799872215,
            0.378203847291269,
            0.3327073020492066,
            0.5885075690602108,
            0.4111151715279185,
            0.9999999999999998,
            0.36253183936633004,
            0.5453619766518201,
            0.2537081317024624,
            0.22482004035239062,
            0.14615681904837394,
            0.30640515689471315,
            0.260682374765614,
            0.19748828668207985,
            0.26567147894282983,
            0.06727187244444766,
            0.15022572569809292,
            0.05637541821590202,
            0.15143351400671015,
            0.4829057534205558,
            0.2763606434616109,
            0.33519573995558477,
            0.37542044944804664,
            0.4084129620499064,
            0.30874234641895,
            0.36253183936633004,
            0.9999999999999999,
            0.391142525635984,
            0.24157886857020436,
            0.24975050025037462,
            0.17874964005723953,
            0.24411190869825736,
            0.2359225653095683,
            0.15582449833474285,
            0.24625208595496223,
            0.13376067511931114,
            0.1908555708535879,
            0.12052970805367559,
            0.1818357047236233,
            0.39831938834172176,
            0.22163198951394897,
            0.2951597136845471,
            0.26327497959991397,
            0.5903685607569671,
            0.4141094553121866,
            0.5453619766518201,
            0.391142525635984,
            1.0,
            0.267345009738306,
            0.2254745885310357,
            0.23405890514403804,
            0.2877548297843024,
            0.2428874325795077,
            0.20445239775827606,
            0.2340252309166104,
            0.04268509862706721,
            0.19266306562467794,
            0.11672681577740016,
            0.19240393491742092,
            0.47751606403521574,
            0.2579644830808216,
            0.33313525043689357,
            0.3953988083349384,
            0.2824142172459059,
            0.28641111966543714,
            0.2537081317024624,
            0.24157886857020436,
            0.267345009738306,
            1.0,
            0.1782458512721164,
            0.2595682144743648,
            0.4042348954787393,
            0.3990280042262553,
            0.3146339827998148,
            0.31691241937806564,
            0.20701130076860322,
            0.3640691410197947,
            0.18011061814927778,
            0.21654860570712992,
            0.33403769876739514,
            0.32873563218390806,
            0.4172721820994954,
            0.33033718207755836,
            0.24649685013065284,
            0.27511583325286976,
            0.22482004035239062,
            0.24975050025037462,
            0.2254745885310357,
            0.1782458512721164,
            1.0,
            0.1749056227045292,
            0.24339726973828335,
            0.23931037322367965,
            0.15595461680777742,
            0.13203091841521394,
            0.10473008505308375,
            0.18583965973648822,
            0.1686780377091381,
            0.17332146989661837,
            0.30216973241689865,
            0.18299907397270618,
            0.25086080496573443,
            0.1753090554149446,
            0.2520421785871207,
            0.2500930271051154,
            0.14615681904837394,
            0.17874964005723953,
            0.23405890514403804,
            0.2595682144743648,
            0.1749056227045292,
            1.0,
            0.17465449197982197,
            0.2578134285192268,
            0.31719648920368815,
            0.20743233551722887,
            0.15541287145403648,
            0.17204731281813557,
            0.05981376861465806,
            0.29577790759700967,
            0.2946634572713878,
            0.2966493879707026,
            0.2331978412058572,
            0.2952844557626694,
            0.335482333082084,
            0.33555100591751874,
            0.30640515689471315,
            0.24411190869825736,
            0.2877548297843024,
            0.4042348954787393,
            0.24339726973828335,
            0.17465449197982197,
            0.9999999999999998,
            0.42599692767863667,
            0.23111462092702548,
            0.3267549445578594,
            0.20213498012278722,
            0.3737356083039938,
            0.21291457917613596,
            0.3194570359178093,
            0.42677564041728,
            0.3220552738704241,
            0.7537229212221113,
            0.30426633850061663,
            0.30191152503976626,
            0.2789908258943761,
            0.260682374765614,
            0.2359225653095683,
            0.2428874325795077,
            0.3990280042262553,
            0.23931037322367965,
            0.2578134285192268,
            0.42599692767863667,
            0.9999999999999999,
            0.26246448822045493,
            0.3538124550448383,
            0.21119335956341784,
            0.31204266766003946,
            0.16256402219058877,
            0.34164725221775694,
            0.3477361948485358,
            0.28659469916802865,
            0.43713111983870306,
            0.3252377737276635,
            0.2452150932316846,
            0.2452371002978022,
            0.19748828668207985,
            0.15582449833474285,
            0.20445239775827606,
            0.3146339827998148,
            0.15595461680777742,
            0.31719648920368815,
            0.23111462092702548,
            0.26246448822045493,
            1.0,
            0.20618612568533115,
            0.10735235433014119,
            0.3135618731941885,
            0.14301938838683886,
            0.20736625169102368,
            0.28429748028367313,
            0.29092868272585615,
            0.3422705360291528,
            0.24567173394782313,
            0.27149091068252545,
            0.25057262757494747,
            0.26567147894282983,
            0.24625208595496223,
            0.2340252309166104,
            0.31691241937806564,
            0.13203091841521394,
            0.20743233551722887,
            0.3267549445578594,
            0.3538124550448383,
            0.20618612568533115,
            0.9999999999999999,
            0.22882912082225432,
            0.2223879283982532,
            0.18747465359907314,
            0.29943749005178844,
            0.29391311459524233,
            0.26015198605662104,
            0.338293247958368,
            0.33984522894394215,
            0.04435189482632632,
            0.06481311078880647,
            0.06727187244444766,
            0.13376067511931114,
            0.04268509862706721,
            0.20701130076860322,
            0.10473008505308375,
            0.15541287145403648,
            0.20213498012278722,
            0.21119335956341784,
            0.10735235433014119,
            0.22882912082225432,
            0.9999999999999999,
            0.13950806598601637,
            0.14615320555386696,
            0.2007568673778783,
            0.11578973028223505,
            0.10130340250378456,
            0.17162642607352477,
            0.15400843881856538,
            0.23142018830539302,
            0.26340335652927005,
            0.15022572569809292,
            0.1908555708535879,
            0.19266306562467794,
            0.3640691410197947,
            0.18583965973648822,
            0.17204731281813557,
            0.3737356083039938,
            0.31204266766003946,
            0.3135618731941885,
            0.2223879283982532,
            0.13950806598601637,
            1.0,
            0.35655165433245045,
            0.23278069496048398,
            0.35021191252982153,
            0.2844290164217146,
            0.4309788739249702,
            0.180924523075615,
            0.07894744829362502,
            0.11225083025886852,
            0.05637541821590202,
            0.12052970805367559,
            0.11672681577740016,
            0.18011061814927778,
            0.1686780377091381,
            0.05981376861465806,
            0.21291457917613596,
            0.16256402219058877,
            0.14301938838683886,
            0.18747465359907314,
            0.14615320555386696,
            0.35655165433245045,
            1.0,
            0.16311566968906824,
            0.11951256152993033,
            0.0720442472597111,
            0.20067001862719538,
            0.0771364140423187,
            0.20633414264933234,
            0.27182839176591744,
            0.15143351400671015,
            0.1818357047236233,
            0.19240393491742092,
            0.21654860570712992,
            0.17332146989661837,
            0.29577790759700967,
            0.3194570359178093,
            0.34164725221775694,
            0.20736625169102368,
            0.29943749005178844,
            0.2007568673778783,
            0.23278069496048398,
            0.16311566968906824,
            0.9999999999999998,
            0.28269447214093013,
            0.1932638093945353,
            0.30550262843233245,
            0.25429203201197925,
            0.5222517218565728,
            0.4398022771468619,
            0.4829057534205558,
            0.39831938834172176,
            0.47751606403521574,
            0.33403769876739514,
            0.30216973241689865,
            0.2946634572713878,
            0.42677564041728,
            0.3477361948485358,
            0.28429748028367313,
            0.29391311459524233,
            0.11578973028223505,
            0.35021191252982153,
            0.11951256152993033,
            0.28269447214093013,
            1.0,
            0.39996619194517047,
            0.4856135322432061,
            0.4357904394258666,
            0.3402859830749849,
            0.29768714799872215,
            0.2763606434616109,
            0.22163198951394897,
            0.2579644830808216,
            0.32873563218390806,
            0.18299907397270618,
            0.2966493879707026,
            0.3220552738704241,
            0.28659469916802865,
            0.29092868272585615,
            0.26015198605662104,
            0.10130340250378456,
            0.2844290164217146,
            0.0720442472597111,
            0.1932638093945353,
            0.39996619194517047,
            1.0,
            0.38325542812399305,
            0.3193259426749731,
            0.38364264281101457,
            0.378203847291269,
            0.33519573995558477,
            0.2951597136845471,
            0.33313525043689357,
            0.4172721820994954,
            0.25086080496573443,
            0.2331978412058572,
            0.7537229212221113,
            0.43713111983870306,
            0.3422705360291528,
            0.338293247958368,
            0.17162642607352477,
            0.4309788739249702,
            0.20067001862719538,
            0.30550262843233245,
            0.4856135322432061,
            0.38325542812399305,
            1.0,
            0.34759782495903757,
            0.42577819033273273,
            0.3327073020492066,
            0.37542044944804664,
            0.26327497959991397,
            0.3953988083349384,
            0.33033718207755836,
            0.1753090554149446,
            0.2952844557626694,
            0.30426633850061663,
            0.3252377737276635,
            0.24567173394782313,
            0.33984522894394215,
            0.15400843881856538,
            0.180924523075615,
            0.0771364140423187,
            0.25429203201197925,
            0.4357904394258666,
            0.3193259426749731,
            0.34759782495903757,
            1.0,
        ],
        20,
        20,
    )
    distancet = reshape(
        [
            1.0,
            0.4735415515503706,
            0.6180261702120821,
            0.4349571867799903,
            0.6451127592889278,
            0.34282976570248597,
            0.27110205892730144,
            0.295857361552747,
            0.38128257048444114,
            0.3368271924671332,
            0.29433290854723165,
            0.303412633220519,
            0.07520891727222292,
            0.2978932127501304,
            0.11134976262546502,
            0.24125815899661868,
            0.5616869767266353,
            0.3842173916679061,
            0.41895598774283493,
            0.4545497997786218,
            0.4735415515503706,
            1.0,
            0.46731870338146625,
            0.35421401719103135,
            0.44363882275740263,
            0.3222392722071289,
            0.30226463455483354,
            0.2631855608835759,
            0.3702951623496788,
            0.3215067375332637,
            0.27472597501498575,
            0.29309227522447107,
            0.1219101961054762,
            0.32158425378718886,
            0.15647018252448094,
            0.26179276852030414,
            0.47947916945242336,
            0.32135903408489563,
            0.41380260534746593,
            0.3782227803700362,
            0.6180261702120821,
            0.46731870338146625,
            1.0,
            0.41869005232063594,
            0.5735165067761976,
            0.30772113934041245,
            0.25418264533066937,
            0.2099602470878245,
            0.34162072254492304,
            0.3032472676990569,
            0.23324203094994628,
            0.2991208523058176,
            0.09870214128506787,
            0.2359179997715874,
            0.09367471448610777,
            0.19222961884589174,
            0.5249704548591424,
            0.31168588724077156,
            0.3581793305593742,
            0.42348351765043984,
            0.4349571867799903,
            0.35421401719103135,
            0.41869005232063594,
            1.0,
            0.40889305335436354,
            0.26773740720369826,
            0.30050304363810454,
            0.18467492948581052,
            0.3055686333587629,
            0.2882282029796724,
            0.1829508406692718,
            0.27272982556860015,
            0.1388361218939062,
            0.2511576486514421,
            0.16252698550515376,
            0.20935014632379517,
            0.42364294127472657,
            0.2509785942471918,
            0.3245794517214052,
            0.2969665100109493,
            0.6451127592889278,
            0.44363882275740263,
            0.5735165067761976,
            0.40889305335436354,
            1.0,
            0.29056923887159924,
            0.2624283535473848,
            0.2650534611434284,
            0.32986940740467324,
            0.2753384234927583,
            0.24711667252365652,
            0.2836612764650945,
            0.07759730061061518,
            0.25860823208052314,
            0.14128273629534385,
            0.21040981337738154,
            0.5298349539671918,
            0.2934669878785397,
            0.3584296216296586,
            0.43908634674690084,
            0.34282976570248597,
            0.3222392722071289,
            0.30772113934041245,
            0.26773740720369826,
            0.29056923887159924,
            1.0,
            0.2176565502965672,
            0.2878548621726707,
            0.4482919091245592,
            0.4305848116841078,
            0.38877729512445874,
            0.35982379275412896,
            0.22715926345561654,
            0.43044670190289197,
            0.21804838134216495,
            0.24143411159025494,
            0.3993730272764375,
            0.3717651035312175,
            0.4890155470014654,
            0.362915322904639,
            0.27110205892730144,
            0.30226463455483354,
            0.25418264533066937,
            0.30050304363810454,
            0.2624283535473848,
            0.2176565502965672,
            1.0,
            0.1457116486543671,
            0.27700302897114515,
            0.25827042053703453,
            0.16910226129848094,
            0.16597357930723722,
            0.12883899436746135,
            0.2143150570907888,
            0.17740123898243157,
            0.18597860289698923,
            0.3128525144256436,
            0.197594872606199,
            0.2751017129777743,
            0.19025346708120558,
            0.295857361552747,
            0.2631855608835759,
            0.2099602470878245,
            0.18467492948581052,
            0.2650534611434284,
            0.2878548621726707,
            0.1457116486543671,
            1.0,
            0.2202860258111427,
            0.266122862930929,
            0.34732429248990754,
            0.23005867709142408,
            0.19914683794873403,
            0.2458821168485456,
            0.07476780279698289,
            0.32348419062782924,
            0.30945439077038783,
            0.32176373618169973,
            0.28186719909363805,
            0.3351690114562945,
            0.38128257048444114,
            0.3702951623496788,
            0.34162072254492304,
            0.3055686333587629,
            0.32986940740467324,
            0.4482919091245592,
            0.27700302897114515,
            0.2202860258111427,
            1.0,
            0.45631171309875435,
            0.27297123945421065,
            0.35670109413804735,
            0.22076762365451666,
            0.4285299399236818,
            0.24254507966642225,
            0.3466355482096192,
            0.4912839877340086,
            0.3704875858164392,
            0.846759847892209,
            0.34293863982319445,
            0.3368271924671332,
            0.3215067375332637,
            0.3032472676990569,
            0.2882282029796724,
            0.2753384234927583,
            0.4305848116841078,
            0.25827042053703453,
            0.266122862930929,
            0.45631171309875435,
            1.0,
            0.3002801921539444,
            0.3745166471925393,
            0.2251692742882865,
            0.3606525844240634,
            0.19977618213579235,
            0.3539309766884413,
            0.36882229924675713,
            0.34052446096167205,
            0.47162404938395674,
            0.3333888881313578,
            0.29433290854723165,
            0.27472597501498575,
            0.23324203094994628,
            0.1829508406692718,
            0.24711667252365652,
            0.38877729512445874,
            0.16910226129848094,
            0.34732429248990754,
            0.27297123945421065,
            0.3002801921539444,
            1.0,
            0.24856973965968587,
            0.13611934924365363,
            0.3728099233122351,
            0.17804127559436017,
            0.23562016633798633,
            0.32622553322473924,
            0.31773970691440273,
            0.3684735685684333,
            0.27438870088536393,
            0.303412633220519,
            0.29309227522447107,
            0.2991208523058176,
            0.27272982556860015,
            0.2836612764650945,
            0.35982379275412896,
            0.16597357930723722,
            0.23005867709142408,
            0.35670109413804735,
            0.3745166471925393,
            0.24856973965968587,
            1.0,
            0.23772704323506122,
            0.26446588416221617,
            0.1859045036133696,
            0.33291027412195695,
            0.3279358527215129,
            0.2952016760505166,
            0.37612471298236466,
            0.3750572778181069,
            0.07520891727222292,
            0.1219101961054762,
            0.09870214128506787,
            0.1388361218939062,
            0.07759730061061518,
            0.22715926345561654,
            0.12883899436746135,
            0.19914683794873403,
            0.22076762365451666,
            0.2251692742882865,
            0.13611934924365363,
            0.23772704323506122,
            1.0,
            0.1636347707342861,
            0.17832098388227097,
            0.2755422375912737,
            0.1365462944377177,
            0.13062932115544806,
            0.19152393018321406,
            0.17440229068823013,
            0.2978932127501304,
            0.32158425378718886,
            0.2359179997715874,
            0.2511576486514421,
            0.25860823208052314,
            0.43044670190289197,
            0.2143150570907888,
            0.2458821168485456,
            0.4285299399236818,
            0.3606525844240634,
            0.3728099233122351,
            0.26446588416221617,
            0.1636347707342861,
            1.0,
            0.40335803013521704,
            0.23143215264374356,
            0.3933965872436211,
            0.34704115290992726,
            0.49778722483548493,
            0.240938283241034,
            0.11134976262546502,
            0.15647018252448094,
            0.09367471448610777,
            0.16252698550515376,
            0.14128273629534385,
            0.21804838134216495,
            0.17740123898243157,
            0.07476780279698289,
            0.24254507966642225,
            0.19977618213579235,
            0.17804127559436017,
            0.1859045036133696,
            0.17832098388227097,
            0.40335803013521704,
            1.0,
            0.19881065478272986,
            0.14927639592955766,
            0.11047799348973307,
            0.2471902105762841,
            0.09948856530786665,
            0.24125815899661868,
            0.26179276852030414,
            0.19222961884589174,
            0.20935014632379517,
            0.21040981337738154,
            0.24143411159025494,
            0.18597860289698923,
            0.32348419062782924,
            0.3466355482096192,
            0.3539309766884413,
            0.23562016633798633,
            0.33291027412195695,
            0.2755422375912737,
            0.23143215264374356,
            0.19881065478272986,
            1.0,
            0.29085331636569045,
            0.2356921472430179,
            0.35107654630363216,
            0.29921654181301405,
            0.5616869767266353,
            0.47947916945242336,
            0.5249704548591424,
            0.42364294127472657,
            0.5298349539671918,
            0.3993730272764375,
            0.3128525144256436,
            0.30945439077038783,
            0.4912839877340086,
            0.36882229924675713,
            0.32622553322473924,
            0.3279358527215129,
            0.1365462944377177,
            0.3933965872436211,
            0.14927639592955766,
            0.29085331636569045,
            1.0,
            0.4307463642455148,
            0.5405459762790095,
            0.4748030241048145,
            0.3842173916679061,
            0.32135903408489563,
            0.31168588724077156,
            0.2509785942471918,
            0.2934669878785397,
            0.3717651035312175,
            0.197594872606199,
            0.32176373618169973,
            0.3704875858164392,
            0.34052446096167205,
            0.31773970691440273,
            0.2952016760505166,
            0.13062932115544806,
            0.34704115290992726,
            0.11047799348973307,
            0.2356921472430179,
            0.4307463642455148,
            1.0,
            0.43792271729204957,
            0.347829179961522,
            0.41895598774283493,
            0.41380260534746593,
            0.3581793305593742,
            0.3245794517214052,
            0.3584296216296586,
            0.4890155470014654,
            0.2751017129777743,
            0.28186719909363805,
            0.846759847892209,
            0.47162404938395674,
            0.3684735685684333,
            0.37612471298236466,
            0.19152393018321406,
            0.49778722483548493,
            0.2471902105762841,
            0.35107654630363216,
            0.5405459762790095,
            0.43792271729204957,
            1.0,
            0.38228448619015676,
            0.4545497997786218,
            0.3782227803700362,
            0.42348351765043984,
            0.2969665100109493,
            0.43908634674690084,
            0.362915322904639,
            0.19025346708120558,
            0.3351690114562945,
            0.34293863982319445,
            0.3333888881313578,
            0.27438870088536393,
            0.3750572778181069,
            0.17440229068823013,
            0.240938283241034,
            0.09948856530786665,
            0.29921654181301405,
            0.4748030241048145,
            0.347829179961522,
            0.38228448619015676,
            1.0,
        ],
        20,
        20,
    )
    tailt = reshape(
        [
            1.0,
            0.37777778,
            0.48888889,
            0.35555556,
            0.48888889,
            0.33333333,
            0.22222222,
            0.2,
            0.33333333,
            0.31111111,
            0.26666667,
            0.08888889,
            0.04444444,
            0.17777778,
            0.13333333,
            0.13333333,
            0.46666667,
            0.26666667,
            0.35555556,
            0.35555556,
            0.37777778,
            1.0,
            0.44444444,
            0.35555556,
            0.44444444,
            0.26666667,
            0.26666667,
            0.15555556,
            0.35555556,
            0.26666667,
            0.2,
            0.17777778,
            0.02222222,
            0.2,
            0.15555556,
            0.17777778,
            0.42222222,
            0.15555556,
            0.35555556,
            0.28888889,
            0.48888889,
            0.44444444,
            1.0,
            0.53333333,
            0.51111111,
            0.26666667,
            0.22222222,
            0.24444444,
            0.4,
            0.31111111,
            0.17777778,
            0.22222222,
            0.04444444,
            0.15555556,
            0.13333333,
            0.17777778,
            0.51111111,
            0.31111111,
            0.35555556,
            0.35555556,
            0.35555556,
            0.35555556,
            0.53333333,
            1.0,
            0.44444444,
            0.22222222,
            0.22222222,
            0.13333333,
            0.31111111,
            0.24444444,
            0.13333333,
            0.15555556,
            0.02222222,
            0.17777778,
            0.17777778,
            0.11111111,
            0.37777778,
            0.22222222,
            0.31111111,
            0.28888889,
            0.48888889,
            0.44444444,
            0.51111111,
            0.44444444,
            1.0,
            0.26666667,
            0.26666667,
            0.2,
            0.35555556,
            0.26666667,
            0.22222222,
            0.17777778,
            0.02222222,
            0.22222222,
            0.13333333,
            0.17777778,
            0.55555556,
            0.24444444,
            0.35555556,
            0.4,
            0.33333333,
            0.26666667,
            0.26666667,
            0.22222222,
            0.26666667,
            1.0,
            0.13333333,
            0.15555556,
            0.31111111,
            0.28888889,
            0.26666667,
            0.13333333,
            0.13333333,
            0.24444444,
            0.11111111,
            0.08888889,
            0.24444444,
            0.26666667,
            0.35555556,
            0.2,
            0.22222222,
            0.26666667,
            0.22222222,
            0.22222222,
            0.26666667,
            0.13333333,
            1.0,
            0.13333333,
            0.31111111,
            0.26666667,
            0.22222222,
            0.11111111,
            0.04444444,
            0.24444444,
            0.06666667,
            0.13333333,
            0.22222222,
            0.17777778,
            0.28888889,
            0.17777778,
            0.2,
            0.15555556,
            0.24444444,
            0.13333333,
            0.2,
            0.15555556,
            0.13333333,
            1.0,
            0.22222222,
            0.15555556,
            0.17777778,
            0.15555556,
            0.08888889,
            0.2,
            0.13333333,
            0.22222222,
            0.22222222,
            0.22222222,
            0.28888889,
            0.22222222,
            0.33333333,
            0.35555556,
            0.4,
            0.31111111,
            0.35555556,
            0.31111111,
            0.31111111,
            0.22222222,
            1.0,
            0.42222222,
            0.22222222,
            0.15555556,
            0.08888889,
            0.33333333,
            0.22222222,
            0.17777778,
            0.48888889,
            0.28888889,
            0.73333333,
            0.33333333,
            0.31111111,
            0.26666667,
            0.31111111,
            0.24444444,
            0.26666667,
            0.28888889,
            0.26666667,
            0.15555556,
            0.42222222,
            1.0,
            0.24444444,
            0.17777778,
            0.13333333,
            0.24444444,
            0.17777778,
            0.15555556,
            0.28888889,
            0.24444444,
            0.35555556,
            0.2,
            0.26666667,
            0.2,
            0.17777778,
            0.13333333,
            0.22222222,
            0.26666667,
            0.22222222,
            0.17777778,
            0.22222222,
            0.24444444,
            1.0,
            0.08888889,
            0.06666667,
            0.22222222,
            0.02222222,
            0.11111111,
            0.2,
            0.22222222,
            0.26666667,
            0.15555556,
            0.08888889,
            0.17777778,
            0.22222222,
            0.15555556,
            0.17777778,
            0.13333333,
            0.11111111,
            0.15555556,
            0.15555556,
            0.17777778,
            0.08888889,
            1.0,
            0.08888889,
            0.13333333,
            0.04444444,
            0.17777778,
            0.17777778,
            0.11111111,
            0.17777778,
            0.17777778,
            0.04444444,
            0.02222222,
            0.04444444,
            0.02222222,
            0.02222222,
            0.13333333,
            0.04444444,
            0.08888889,
            0.08888889,
            0.13333333,
            0.06666667,
            0.08888889,
            1.0,
            0.04444444,
            0.08888889,
            0.11111111,
            0.06666667,
            0.04444444,
            0.06666667,
            0.06666667,
            0.17777778,
            0.2,
            0.15555556,
            0.17777778,
            0.22222222,
            0.24444444,
            0.24444444,
            0.2,
            0.33333333,
            0.24444444,
            0.22222222,
            0.13333333,
            0.04444444,
            1.0,
            0.22222222,
            0.11111111,
            0.31111111,
            0.28888889,
            0.35555556,
            0.2,
            0.13333333,
            0.15555556,
            0.13333333,
            0.17777778,
            0.13333333,
            0.11111111,
            0.06666667,
            0.13333333,
            0.22222222,
            0.17777778,
            0.02222222,
            0.04444444,
            0.08888889,
            0.22222222,
            1.0,
            0.06666667,
            0.17777778,
            0.06666667,
            0.17777778,
            0.13333333,
            0.13333333,
            0.17777778,
            0.17777778,
            0.11111111,
            0.17777778,
            0.08888889,
            0.13333333,
            0.22222222,
            0.17777778,
            0.15555556,
            0.11111111,
            0.17777778,
            0.11111111,
            0.11111111,
            0.06666667,
            1.0,
            0.17777778,
            0.15555556,
            0.22222222,
            0.22222222,
            0.46666667,
            0.42222222,
            0.51111111,
            0.37777778,
            0.55555556,
            0.24444444,
            0.22222222,
            0.22222222,
            0.48888889,
            0.28888889,
            0.2,
            0.17777778,
            0.06666667,
            0.31111111,
            0.17777778,
            0.17777778,
            1.0,
            0.26666667,
            0.46666667,
            0.37777778,
            0.26666667,
            0.15555556,
            0.31111111,
            0.22222222,
            0.24444444,
            0.26666667,
            0.17777778,
            0.22222222,
            0.28888889,
            0.24444444,
            0.22222222,
            0.11111111,
            0.04444444,
            0.28888889,
            0.06666667,
            0.15555556,
            0.26666667,
            1.0,
            0.31111111,
            0.31111111,
            0.35555556,
            0.35555556,
            0.35555556,
            0.31111111,
            0.35555556,
            0.35555556,
            0.28888889,
            0.28888889,
            0.73333333,
            0.35555556,
            0.26666667,
            0.17777778,
            0.06666667,
            0.35555556,
            0.17777778,
            0.22222222,
            0.46666667,
            0.31111111,
            1.0,
            0.37777778,
            0.35555556,
            0.28888889,
            0.35555556,
            0.28888889,
            0.4,
            0.2,
            0.17777778,
            0.22222222,
            0.33333333,
            0.2,
            0.15555556,
            0.17777778,
            0.06666667,
            0.2,
            0.13333333,
            0.22222222,
            0.37777778,
            0.31111111,
            0.37777778,
            1.0,
        ],
        20,
        20,
    )

    @test isapprox(pearsont, pearson)
    @test isapprox(spearmant, spearman)
    @test isapprox(kendallt, kendall)
    @test isapprox(abs_pearsont, abs_pearson)
    @test isapprox(abs_spearmant, abs_spearman)
    @test isapprox(abs_kendallt, abs_kendall)
    @test isapprox(gerber1t, gerber1)
    @test isapprox(gerber2t, gerber2)
    @test isapprox(distancet, distance)
    @test isapprox(tailt, tail)
end
